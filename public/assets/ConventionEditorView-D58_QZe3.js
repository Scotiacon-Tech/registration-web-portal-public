import{s as M}from"./index-DFZh32pl.js";import{i as $,K as q,L as w,r as b,k as H,n as c,q as C,v as l,f as e,x as E,C as T,A as x,c as le,B as _,D as A,F,O as h,y as P,N as B,z as se,m as _e,w as W,S as Ee,U as ge,V as Ae,W as ye,M as xe,R as Ce,s as ue,Q as Ye,X as He}from"./index-CtJiBEcj.js";import{m as Ne,a as Se,s as Pe,p as je,F as Oe,b as Y,_ as $e,c as ze}from"./FormRenderer.vue_vue_type_style_index_0_lang-ifWVhcNy.js";import{_ as Q,I as Je,a as Me}from"./EditOrderedItems.vue_vue_type_script_setup_true_lang-2R9MqRr2.js";import{_ as Z}from"./SaveButton.vue_vue_type_script_setup_true_lang-0n2-dBd2.js";import{V as ne,a as ie}from"./VToolbar-Bt-HGb-Z.js";import{V as R,d as X,e as z}from"./VContainer-CksERWUh.js";import{V as ae}from"./scopeId-MRHufIiF.js";import{V as Ue}from"./VToolbarItems-HcrrVrAv.js";import{c as Te,e as re}from"./VCard-Bk2P6cT7.js";import{V as S}from"./VTextField-CngCNHbP.js";import{_ as qe}from"./SelectGroups.vue_vue_type_script_setup_true_lang-D0gFB9Z-.js";import{V as ke,a as oe,d as ee,b as Fe}from"./VList-D4E1xP3C.js";import{V as N,a as D}from"./VRow-Bw21XZ4O.js";import{V as De}from"./VDialog-BHa0xaYw.js";import{v as L}from"./v4-CQkTLCs1.js";import{V as me,a as ve,b as pe,c as fe}from"./VExpansionPanels-DcgK3iVS.js";import{V as ce}from"./VTextarea-CXSaOGai.js";import{T as K,a as Xe}from"./ticket-DqurB3v3.js";import{V as We}from"./VAutocomplete-PiTbGu4l.js";import{V as de}from"./filter-CANAzvAI.js";import{V as J}from"./VCheckbox-D87ybJM7.js";import{V as we,a as Le}from"./VChip-BzsHBfd9.js";import{V as Qe,a as te}from"./VTable-BD6eJSup.js";import{_ as Ke}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-BmoDqiGr.js";import{u as Ve}from"./useModel-Ma0cZvSf.js";import{_ as Re}from"./ModelDialog.vue_vue_type_script_setup_true_lang-CGj3Vh5a.js";import{V as he}from"./VDivider-Bk5MarIc.js";import{V as Ge}from"./VDataTable-BXeJDjEO.js";import{a as Ze,F as el}from"./form-Cqw16b_M.js";import{b as ll}from"./forwardRefs-BVcY16Oj.js";import{V as tl,a as al,b as ol,c as nl}from"./VTabs-DHBcT_7W.js";import"./submission-DAi9v6uc.js";import"./copyToClipboard-BtcEYe2-.js";import"./useStoreAPI-CZ3hwT-a.js";import"./VTooltip-C2yUsxqT.js";import"./VOverlay-b-A9_DTr.js";import"./VFileInput-DrkW4G6y.js";import"./VForm-FR88NsEz.js";import"./form-TY_kDQn9.js";import"./VCheckboxBtn-BVywYl8I.js";import"./userData-gFCegA13.js";import"./layout-Df_fcjdl.js";import"./createSimpleFunctional-CBP32ssf.js";var be=(I=>(I.PER_ROOM="PER_ROOM",I.PER_PERSON="PER_PERSON",I))(be||{});const ul=$({__name:"EditConventionExtraOptions",props:q({convention:{}},{modelValue:{},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(I,{emit:m}){const o=m,d=w(I,"modelValue"),r=b(H(d.value)),i=()=>{d.value=r.value,o("close")};return(u,n)=>(c(),C(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(R,{icon:"",dark:"",onClick:n[0]||(n[0]=t=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>n[6]||(n[6]=[E("mdi:mdi-close")])),_:1})]),_:1}),e(ie,null,{default:l(()=>n[7]||(n[7]=[E("Edit Option Choice")])),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(R,{variant:"text",onClick:i},{default:l(()=>n[8]||(n[8]=[E(" Apply ")])),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(z,null,{default:l(()=>[e(S,{label:T(M).formLabelName,type:"text",variant:"outlined",modelValue:r.value.Name,"onUpdate:modelValue":n[1]||(n[1]=t=>r.value.Name=t)},null,8,["label","modelValue"]),e(S,{label:T(M).formLabelDescription,type:"text",variant:"outlined",modelValue:r.value.Description,"onUpdate:modelValue":n[2]||(n[2]=t=>r.value.Description=t)},null,8,["label","modelValue"]),e(S,{label:T(M).formLabelPrice,type:"text",variant:"outlined","prepend-icon":T(M).currencyIcon,modelValue:r.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>r.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),e(Q,{modelValue:r.value.Tags,"onUpdate:modelValue":n[4]||(n[4]=t=>r.value.Tags=t),convention:u.convention,hint:"Tags acquired by selecting this option & any choice within it."},null,8,["modelValue","convention"]),r.value.Choices?(c(),C(Q,{key:0,modelValue:r.value.Choices,"onUpdate:modelValue":n[5]||(n[5]=t=>r.value.Choices=t),convention:u.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):x("",!0)]),_:1})]),_:1})]),_:1}))}}),il=$({__name:"EditConventionExtra",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=b(H(m.value)),d=b(!1),r=b(0),i=B(),u=b([""]),n=b([]),t=b([]);I.convention&&(i.getConventionTags(I.convention.ConventionUUID).then(s=>{t.value=s.sort((U,y)=>U.Title.localeCompare(y.Title))}),i.getOrganisationTags(I.convention.OrganisationUUID).then(s=>{n.value=s.sort((U,y)=>U.Title.localeCompare(y.Title))}));const a=le(()=>[...n.value,...t.value]),v=({callback:s})=>{i.saveExtra(o.value).then(U=>{U?(m.value=U,s&&s("Extra Saved")):s&&s("Failed to Save Extra")}).catch(()=>{s&&s("Failed to Save Extra")})},f=s=>{var U;s.Options||(s.Options=[]),s.Options.push({ID:0,OptionUUID:L(),ExtraID:s.ID,ExtraUUID:s.ExtraUUID,Order:((U=s.Options)==null?void 0:U.length)+1,Name:"",Description:"",Price:0,Choices:[],Tags:[]})},V=(s,U)=>{s.Options&&s.Options.splice(U,1)},p=s=>{if(s.Choices&&s.Choices.length>0)return s.Choices.map(U=>{const y=a.value.find(O=>O.TagUUID===U.TagUUID);if(y)return y.Title}).join(", ")};return(s,U)=>(c(),_(F,null,[e(z,{class:"px-0"},{default:l(()=>[e(S,{label:T(M).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":U[0]||(U[0]=y=>o.value.Name=y)},null,8,["label","modelValue"]),e(S,{label:T(M).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":U[1]||(U[1]=y=>o.value.Description=y)},null,8,["label","modelValue"]),e(Q,{modelValue:o.value.AppliesTags,"onUpdate:modelValue":U[2]||(U[2]=y=>o.value.AppliesTags=y),convention:s.convention,organisation:s.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(Q,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":U[3]||(U[3]=y=>o.value.RequiredTags=y),convention:s.convention,organisation:s.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),e(qe,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":U[4]||(U[4]=y=>o.value.RequiredGroupMemberships=y),convention:s.convention,organisation:s.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),U[11]||(U[11]=A("h3",null,"Options",-1)),e(ke,{opened:u.value,"onUpdate:opened":U[5]||(U[5]=y=>u.value=y)},{default:l(()=>[(c(!0),_(F,null,h(o.value.Options,(y,O)=>(c(),_(F,{key:y.ID},[y?(c(),C(oe,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${y.Name} ${y.Price&&y.Price>0?`(${T(M).currencySymbol}${y.Price})`:""}`},{append:l(()=>[e(R,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:g=>V(o.value,O)},null,8,["onClick"]),e(R,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:g=>{d.value=!0,r.value=O}},null,8,["onClick"])]),default:l(()=>[y.Choices&&y.Choices.length>0?(c(),C(ee,{key:0},{default:l(()=>[E(" Options: "+P(p(y)),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"])):x("",!0)],64))),128))]),_:1},8,["opened"]),e(R,{color:"primary",onClick:U[6]||(U[6]=y=>f(o.value))},{default:l(()=>U[10]||(U[10]=[E("Add Option")])),_:1}),e(N,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Z,{onClick:v})]),_:1})]),_:1})]),_:1}),e(De,{modelValue:d.value,"onUpdate:modelValue":U[9]||(U[9]=y=>d.value=y),scrollable:""},{default:l(()=>[e(ul,{modelValue:o.value.Options[r.value],"onUpdate:modelValue":U[7]||(U[7]=y=>o.value.Options[r.value]=y),convention:s.convention,onClose:U[8]||(U[8]=y=>d.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),dl=$({__name:"EditConventionExtras",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(I,{emit:m}){const o=m,d=w(I,"modelValue"),r=B(),i=()=>{const t={ID:0,ExtraUUID:L(),ConventionID:I.convention.ID,ConventionUUID:I.convention.ConventionUUID,Order:d.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[],Tags:[]};r.saveExtra(t).then(a=>{a&&d.value.push(a)})},u=t=>{r.deleteExtra(d.value[t].ExtraUUID).then(a=>{a&&d.value.splice(t,1)})},n=(...t)=>{t.forEach(a=>{a>=0&&a<d.value.length&&r.saveExtra(d.value[a])})};return(t,a)=>(c(),C(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>a[1]||(a[1]=[E("Edit Extras")])),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(R,{variant:"text",onClick:i},{default:l(()=>a[2]||(a[2]=[E(" Add ")])),_:1}),e(R,{icon:"",dark:"",onClick:a[0]||(a[0]=v=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[E("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(c(!0),_(F,null,h(d.value,(v,f)=>(c(),C(ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(pe,null,{actions:l(({expanded:V})=>[e(R,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:p=>u(f)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(R,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>{T(Ne)(v,d.value),n(f,f-1)},["stop"])},null,8,["onClick"]),e(R,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>{T(Se)(v,d.value),n(f,f+1)},["stop"])},null,8,["onClick"]),E(" "+P(v.Name)+" ",1)]),_:2},1024),e(fe,{class:"px-0"},{default:l(()=>[e(il,{convention:t.convention,modelValue:d.value[f],"onUpdate:modelValue":V=>d.value[f]=V},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),sl=$({__name:"Extras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=b([]),d=B(),r=b([""]),i=b(!1),u=t=>{if(t.Choices&&t.Choices.length>0)return t.Choices.map(a=>a.Title).join(", ")},n=()=>{i.value=!1};return d==null||d.getConventionExtras(m.value.ConventionUUID||"").then(t=>{t&&(o.value=t)}),(t,a)=>(c(),_(F,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(D,null,{default:l(()=>a[4]||(a[4]=[A("h3",null,"Additional Purchases",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(R,{color:"primary",onClick:a[0]||(a[0]=v=>i.value=!0)},{default:l(()=>a[5]||(a[5]=[E("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),a[6]||(a[6]=A("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1)),e(ke,{opened:r.value,"onUpdate:opened":a[1]||(a[1]=v=>r.value=v)},{default:l(()=>[(c(!0),_(F,null,h(o.value,v=>(c(),C(Fe,{key:v.ID,value:v.ID},{activator:l(({props:f})=>[e(oe,_e({ref_for:!0},f,{"prepend-icon":"mdi:mdi-group",title:v.Name}),null,16,["title"])]),default:l(()=>[v.Options?(c(!0),_(F,{key:0},h(v.Options,f=>(c(),C(oe,{key:f.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${f.Name} ${f.Price&&f.Price>0?`(${T(M).currencySymbol}${f.Price})`:""}`},{default:l(()=>[f.Choices&&f.Choices.length>0?(c(),C(ee,{key:0},{default:l(()=>[E(" Options: "+P(u(f)),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"]))),128)):x("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(De,{modelValue:i.value,"onUpdate:modelValue":a[3]||(a[3]=v=>i.value=v),scrollable:!0,persistent:!0,fullscreen:!0},{default:l(()=>[e(dl,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=v=>o.value=v),convention:m.value,onClose:n},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),rl=$({__name:"EditConventionInterest",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=b(H(m.value)),d=B(),r=({callback:i})=>{d.saveInterest(o.value).then(u=>{u?(m.value=u,i&&i("Interest Saved")):i&&i("Failed to Save Interest")}).catch(()=>{i&&i("Failed to Save Interest")})};return(i,u)=>(c(),C(z,{class:"px-0"},{default:l(()=>[e(S,{label:T(M).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":u[0]||(u[0]=n=>o.value.Name=n)},null,8,["label","modelValue"]),e(ce,{label:T(M).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":u[1]||(u[1]=n=>o.value.Description=n)},null,8,["label","modelValue"]),x("",!0),e(Q,{modelValue:o.value.AppliesTags,"onUpdate:modelValue":u[3]||(u[3]=n=>o.value.AppliesTags=n),convention:i.convention,organisation:i.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(N,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Z,{onClick:r})]),_:1})]),_:1})]),_:1}))}}),ml=$({__name:"EditConventionInterests",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(I,{emit:m}){const o=m,d=w(I,"modelValue"),r=B(),i=()=>{const t={ID:0,InterestUUID:L(),ConventionID:I.convention.ID,ConventionUUID:I.convention.ConventionUUID,Order:d.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};r.saveInterest(t).then(a=>{a&&d.value.push(a)})},u=t=>{r.deleteInterest(d.value[t].InterestUUID).then(a=>{a&&d.value.splice(t,1)})},n=(...t)=>{t.forEach(a=>{a>=0&&a<d.value.length&&r.saveInterest(d.value[a])})};return(t,a)=>(c(),C(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>a[1]||(a[1]=[E("Edit Interests")])),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(R,{variant:"text",onClick:i},{default:l(()=>a[2]||(a[2]=[E(" Add ")])),_:1}),e(R,{icon:"",dark:"",onClick:a[0]||(a[0]=v=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[E("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(c(!0),_(F,null,h(d.value,(v,f)=>(c(),C(ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(pe,null,{actions:l(({expanded:V})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>u(f)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(R,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>{T(Ne)(v,d.value),n(f,f-1)},["stop"])},null,8,["onClick"]),e(R,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>{T(Se)(v,d.value),n(f,f+1)},["stop"])},null,8,["onClick"]),E(" "+P(v.Name)+" ",1)]),_:2},1024),e(fe,{class:"px-0"},{default:l(()=>[e(rl,{convention:t.convention,modelValue:d.value[f],"onUpdate:modelValue":V=>d.value[f]=V},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),vl=$({__name:"Interests",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(I){const m=w(I,"modelValue"),o=B(),d=b([]);o.getConventionInterests(m.value.ConventionUUID).then(u=>{Pe(u),d.value=u});const r=b([""]),i=b(!1);return(u,n)=>(c(),_(F,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(D,null,{default:l(()=>n[5]||(n[5]=[A("h3",null,"Interests",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(R,{color:"primary",onClick:n[0]||(n[0]=t=>i.value=!0)},{default:l(()=>n[6]||(n[6]=[E("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),n[7]||(n[7]=A("p",null,"Attendees can tag themselves for particular things.",-1)),e(ke,{opened:r.value,"onUpdate:opened":n[1]||(n[1]=t=>r.value=t)},{default:l(()=>[(c(!0),_(F,null,h(d.value,t=>(c(),C(oe,{key:t.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${t.Name} ${t.Price&&t.Price>0?`(${T(M).currencySymbol}${t.Price})`:""}`},{default:l(()=>[t.Description?(c(),C(ee,{key:0},{default:l(()=>[E(P(t.Description),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(De,{modelValue:i.value,"onUpdate:modelValue":n[4]||(n[4]=t=>i.value=t),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(ml,{onClose:n[2]||(n[2]=t=>i.value=!1),convention:m.value,modelValue:d.value,"onUpdate:modelValue":n[3]||(n[3]=t=>d.value=t)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),Ie=$({__name:"SelectTickets",props:q({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=r=>r.Type===K.TICKET_TYPE_GROUP?"mdi:mdi-group":r.Type===K.TICKET_TYPE_TICKET?r.RequiresAccommodation?"mdi:mdi-home":r.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":r.Type===K.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":r.Type===K.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",d=le(()=>I.tickets.map(r=>({title:r.Name,value:m.value.find(i=>i&&i.TicketUUID===r.TicketUUID)||r,props:{appendIcon:o(r)}})));return(r,i)=>(c(),_("div",null,[e(We,{label:r.label,variant:r.variant||"filled",items:d.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=u=>m.value=u),hint:r.hint,chips:r.chips,clearable:r.clearable,multiple:"","persistent-hint":r.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),pl=$({__name:"EditConventionTicket",props:q({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=b(H(m.value)),d=B(),r=le(()=>I.tickets.filter(a=>a.Type===K.TICKET_TYPE_TICKET)),i=le(()=>I.tickets.filter(a=>a.Type===K.TICKET_TYPE_ADD_ON)),u=le(()=>I.tickets.filter(a=>a.Type===K.TICKET_TYPE_TICKET_COMPONENT)),n=a=>I.accommodation.filter(v=>v.Costs.find(f=>f.DateStart===a.DateStart&&f.DateEnd===a.DateEnd)),t=({callback:a})=>{d.saveTicket(o.value).then(v=>{v?(o.value.ID=v.ID,o.value.TicketUUID=v.TicketUUID,m.value=o.value,a&&a("Ticket Saved")):a&&a("Failed to Save Ticket")}).catch(()=>{a&&a("Failed to Save Ticket")})};return(a,v)=>(c(),C(z,{class:"px-0",fluid:""},{default:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(de,{label:"Ticket Type",variant:"outlined",modelValue:o.value.Type,"onUpdate:modelValue":v[0]||(v[0]=f=>o.value.Type=f),items:T(Xe),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(S,{label:T(M).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":v[1]||(v[1]=f=>o.value.Name=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(S,{label:T(M).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":v[2]||(v[2]=f=>o.value.Description=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),o.value.Type!==T(K).TICKET_TYPE_GROUP?(c(),_(F,{key:0},[e(D,{cols:"12"},{default:l(()=>[e(J,{label:T(M).formLabelRequiresAccommodation,modelValue:o.value.RequiresAccommodation,"onUpdate:modelValue":v[3]||(v[3]=f=>o.value.RequiresAccommodation=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(S,{label:T(M).formLabelDateStart,type:"date",variant:"outlined",modelValue:o.value.DateStart,"onUpdate:modelValue":v[4]||(v[4]=f=>o.value.DateStart=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(S,{label:T(M).formLabelDateEnd,type:"date",variant:"outlined",modelValue:o.value.DateEnd,"onUpdate:modelValue":v[5]||(v[5]=f=>o.value.DateEnd=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(S,{label:T(M).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":T(M).currencyIcon,modelValue:o.value.Price,"onUpdate:modelValue":v[6]||(v[6]=f=>o.value.Price=f),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(c(),C(D,{key:1,cols:"12"},{default:l(()=>[e(Ie,{label:"Tickets",variant:"outlined",tickets:r.value,modelValue:o.value.Tickets,"onUpdate:modelValue":v[7]||(v[7]=f=>o.value.Tickets=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(D,{cols:"12"},{default:l(()=>[e(Q,{label:"Applied Tags",variant:"outlined",modelValue:o.value.AppliesTags,"onUpdate:modelValue":v[8]||(v[8]=f=>o.value.AppliesTags=f),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Q,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":v[9]||(v[9]=f=>o.value.RequiredTags=f),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),o.value.Type===T(K).TICKET_TYPE_TICKET?(c(),_(F,{key:2},[e(D,{cols:"12"},{default:l(()=>[e(S,{label:"Components Required",type:"number",variant:"outlined",modelValue:o.value.ComponentsRequired,"onUpdate:modelValue":v[10]||(v[10]=f=>o.value.ComponentsRequired=f),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Ie,{label:"Components",variant:"outlined",tickets:u.value,modelValue:o.value.TicketComponents,"onUpdate:modelValue":v[11]||(v[11]=f=>o.value.TicketComponents=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Ie,{label:"Addons",variant:"outlined",tickets:i.value,modelValue:o.value.AddonTickets,"onUpdate:modelValue":v[12]||(v[12]=f=>o.value.AddonTickets=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):x("",!0),e(D,{cols:"12"},{default:l(()=>[e(Ie,{label:"Disables Tickets",variant:"outlined",tickets:a.tickets,modelValue:o.value.DisablesTickets,"onUpdate:modelValue":v[13]||(v[13]=f=>o.value.DisablesTickets=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),n(o.value).length?(c(),C(N,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>v[14]||(v[14]=[A("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1)])),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(we,null,{default:l(()=>[(c(!0),_(F,null,h(n(o.value),f=>(c(),C(Le,{key:f.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[E(P(f.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):x("",!0),e(N,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Z,{onClick:t})]),_:1})]),_:1})]),_:1}))}}),fl={class:"pr-2"},cl={class:"mb-2"},Vl={key:0,class:"text-grey-darken-1 font-italic"},Ul={key:1,class:"text-red"},Tl={key:0,class:"text-grey-darken-1 font-italic"},Dl={key:1,class:"text-red"},Il={key:0,class:"text-grey-darken-1 font-italic"},yl={key:1,class:"text-red"},gl={class:"text-grey-darken-1"},Cl=$({__name:"EditConventionTickets",props:q({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(I,{emit:m}){const o=w(I,"modelValue"),d=m,r=B(),i=()=>{o.value.push({ID:0,TicketUUID:L(),ConventionID:I.convention.ID,ConventionUUID:I.convention.ConventionUUID,Order:o.value.length+1,Name:"New Ticket",Type:K.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},u=t=>{r.deleteTicket(o.value[t].TicketUUID).then(a=>{a&&o.value.splice(t,1)})},n=t=>t.Type===K.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===K.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===K.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===K.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,a)=>(c(),C(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>a[1]||(a[1]=[E("Edit Tickets")])),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(R,{variant:"text",onClick:i},{default:l(()=>a[2]||(a[2]=[E(" Add Ticket ")])),_:1}),e(R,{icon:"",dark:"",onClick:a[0]||(a[0]=v=>d("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[E("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(c(!0),_(F,null,h(o.value,(v,f)=>(c(),C(ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(pe,{class:"py-2"},{actions:l(({expanded:V})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>u(f)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(R,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>T(Ne)(v,o.value),["stop"])},null,8,["onClick"]),e(R,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>T(Se)(v,o.value),["stop"])},null,8,["onClick"]),A("div",fl,[e(X,{icon:n(v)},null,8,["icon"])]),A("div",null,[A("p",cl,[E(P(v.Name)+" ",1),v.Type===T(K).TICKET_TYPE_TICKET?(c(),_(F,{key:0},[o.value.find(V=>V.Type===T(K).TICKET_TYPE_GROUP&&V.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),_("span",Vl," ("+P(o.value.filter(V=>V.Type===T(K).TICKET_TYPE_GROUP&&V.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(c(),_("span",Ul," (Ticket does not belong to any categories.) "))],64)):x("",!0),v.Type===T(K).TICKET_TYPE_ADD_ON?(c(),_(F,{key:1},[o.value.find(V=>V.Type===T(K).TICKET_TYPE_TICKET&&V.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),_("span",Tl," ("+P(o.value.filter(V=>V.Type===T(K).TICKET_TYPE_TICKET&&V.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(c(),_("span",Dl," (Ticket addon must be associated to at least one ticket.) "))],64)):x("",!0),v.Type===T(K).TICKET_TYPE_TICKET_COMPONENT?(c(),_(F,{key:2},[o.value.find(V=>V.Type===T(K).TICKET_TYPE_TICKET&&V.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),_("span",Il," ("+P(o.value.filter(V=>V.Type===T(K).TICKET_TYPE_TICKET&&V.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(c(),_("span",yl," (Component has not been assigned to any tickets.) "))],64)):x("",!0)]),A("p",gl,[v.Type===T(K).TICKET_TYPE_GROUP?(c(),_(F,{key:0},[E("Category")],64)):v.Type===T(K).TICKET_TYPE_TICKET?(c(),_(F,{key:1},[a[4]||(a[4]=E(" Ticket ")),v.ComponentsRequired>0?(c(),_(F,{key:0},[E(" ("+P(v.ComponentsRequired)+" component"+P(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):x("",!0)],64)):x("",!0),v.Type===T(K).TICKET_TYPE_TICKET_COMPONENT?(c(),_(F,{key:2},[E("Component")],64)):x("",!0),v.Type===T(K).TICKET_TYPE_ADD_ON?(c(),_(F,{key:3},[E("Addon")],64)):x("",!0)])])]),_:2},1024),e(fe,{class:"px-0"},{default:l(()=>[e(pl,{accommodation:t.accommodation,convention:t.convention,tickets:o.value,modelValue:o.value[f],"onUpdate:modelValue":V=>o.value[f]=V},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),bl=$({__name:"Tickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(I){var f;const m=w(I,"modelValue"),o=B(),d=b([]),r=b([]);o.getConventionTickets(((f=m.value)==null?void 0:f.ConventionUUID)||"").then(V=>{Pe(V),d.value=V});const i=b([""]),u=b(!1),n=V=>V.AddonTickets&&V.AddonTickets.map(p=>d.value&&d.value.find(s=>s.ID===p.ID)),t=V=>V.TicketComponents&&V.TicketComponents.map(p=>d.value&&d.value.find(s=>s.ID===p.ID)),a=V=>"",v=V=>r.value.filter(p=>p.Costs.find(s=>s.DateStart===V.DateStart&&s.DateEnd===V.DateEnd)).map(p=>p.Name).join(", ");return(V,p)=>(c(),_(F,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(D,null,{default:l(()=>p[5]||(p[5]=[A("h3",null,"Tickets",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(R,{color:"primary",onClick:p[0]||(p[0]=s=>u.value=!0)},{default:l(()=>p[6]||(p[6]=[E("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),p[7]||(p[7]=A("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1)),e(ke,{opened:i.value,"onUpdate:opened":p[1]||(p[1]=s=>i.value=s)},{default:l(()=>[(c(!0),_(F,null,h(d.value.filter(s=>s.Type===T(K).TICKET_TYPE_GROUP),s=>(c(),C(Fe,{key:s.ID,value:s.ID},{activator:l(({props:U})=>[e(oe,_e({ref_for:!0},U,{"prepend-icon":"mdi:mdi-group",title:s.Name}),null,16,["title"])]),default:l(()=>[(c(!0),_(F,null,h(d.value.filter(U=>s.Tickets.find(y=>y&&U&&y.TicketUUID===U.TicketUUID)),U=>(c(),_(F,{key:U.ID},[U.AddonTickets&&U.AddonTickets.length?(c(),C(Fe,{key:0,value:U.ID},{activator:l(({props:y})=>[e(oe,_e({ref_for:!0},y,{"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${T(M).currencySymbol}${U.Price})`:""}`}),{default:l(()=>[U.ComponentsRequired>0?(c(),C(ee,{key:0},{default:l(()=>[E(" Options: "+P(t(U).map(O=>O&&O.Name).join(", ")),1)]),_:2},1024)):x("",!0),U.RequiresAccommodation&&v(U)?(c(),C(ee,{key:1},{default:l(()=>[E(" Accommodation: "+P(v(U)),1)]),_:2},1024)):x("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(c(!0),_(F,null,h(n(U),y=>(c(),_(F,{key:y},[y?(c(),C(oe,{key:0,title:`${y.Name} ${y.Price>0?`(${T(M).currencySymbol}${y.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[y.RequiredTags&&y.RequiredTags.length>0?(c(),C(ee,{key:0},{default:l(()=>[E(" Required Tags: "+P(y.RequiredTags.join(", ")),1)]),_:2},1024)):x("",!0),y.RequiredGroupMemberships&&y.RequiredGroupMemberships.length>0?(c(),C(ee,{key:1},{default:l(()=>[E(" Required Groups: "+P(a(y.RequiredGroupMemberships)),1)]),_:2},1024)):x("",!0),v(y)?(c(),C(ee,{key:2},{default:l(()=>[E(" Accommodation: "+P(v(y)),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"])):x("",!0)],64))),128))]),_:2},1032,["value"])):(c(),C(oe,{key:1,"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${T(M).currencySymbol}${U.Price})`:""}`},{default:l(()=>[U.ComponentsRequired>0?(c(),C(ee,{key:0},{default:l(()=>[E(" Options: "+P(t(U).map(y=>y&&y.Name).join(", ")),1)]),_:2},1024)):x("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(De,{modelValue:u.value,"onUpdate:modelValue":p[4]||(p[4]=s=>u.value=s),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(Cl,{onClose:p[2]||(p[2]=s=>u.value=!1),modelValue:d.value,"onUpdate:modelValue":p[3]||(p[3]=s=>d.value=s),accommodation:r.value,convention:m.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),El=$({__name:"VenueRoomCost",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["deleted"],["update:modelValue"]),setup(I,{emit:m}){const o=m,d=w(I,"modelValue"),r=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],i=()=>{o("deleted")};return(u,n)=>(c(),C(N,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:T(M).formLabelDateStart,type:"date",variant:"outlined",modelValue:d.value.DateStart,"onUpdate:modelValue":n[0]||(n[0]=t=>d.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:T(M).formLabelDateEnd,type:"date",variant:"outlined",modelValue:d.value.DateEnd,"onUpdate:modelValue":n[1]||(n[1]=t=>d.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:T(M).formLabelAvailability,type:"number",variant:"outlined",modelValue:d.value.Availability,"onUpdate:modelValue":n[2]||(n[2]=t=>d.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:T(M).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:d.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>d.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(de,{label:T(M).formLabelPriceType,variant:"outlined",modelValue:d.value.Type,"onUpdate:modelValue":n[4]||(n[4]=t=>d.value.Type=t),items:r,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(R,{color:"red",icon:"mdi:mdi-minus",onClick:i})]),_:1})]),_:1}))}}),kl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},_l=$({__name:"VenueRoom",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["deleted"],["update:modelValue"]),setup(I,{emit:m}){const o=B(),d=m,r=b(M),i=w(I,"modelValue"),u=b(H(i.value)),n=b(!1),t=p=>{switch(p.Type){case be.PER_PERSON:return r.value.enumPER_PERSON;case be.PER_ROOM:return r.value.enumPER_ROOM}return"Unknown"},a=()=>{u.value.Costs||(u.value.Costs=[]),u.value.Costs.push({ID:0,CostUUID:L(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=p=>{u.value.Costs.splice(p,1)},f=({callback:p})=>{const s=()=>{p&&p("Failed to Delete Room")},U=()=>{p&&p("Room Deleted")};o.deleteRoom(u.value.RoomUUID).then(y=>{y?(U(),d("deleted",u.value)):s()}).catch(()=>{s()})},V=()=>{o.saveRoom(u.value).then(()=>{i.value=u.value,n.value=!1})};return(p,s)=>(c(),_(F,null,[e(z,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[A("h4",null,P(u.value.Name),1),A("p",null,P(u.value.Notes),1),A("p",null,[s[7]||(s[7]=A("strong",null,"Capacity:",-1)),E(" "+P(u.value.MinimumCapacity)+" ",1),u.value.MinimumCapacity!=u.value.MaximumCapacity?(c(),_(F,{key:0},[E(" - "+P(u.value.MaximumCapacity),1)],64)):x("",!0)]),e(Qe,{density:"compact"},{default:l(()=>[s[8]||(s[8]=A("thead",null,[A("tr",null,[A("th",null,"Date"),A("th",null,"Price"),A("th",null,"Availability")])],-1)),A("tbody",null,[(c(!0),_(F,null,h(u.value.Costs,U=>(c(),_("tr",{key:`venue-room-${u.value.ID}-cost-${U.ID}`},[A("td",null,P(U.DateStart)+" - "+P(U.DateEnd),1),A("td",null,P(r.value.currencySymbol)+P(U.Price)+" "+P(t(U)),1),A("td",null,P(U.Availability),1)]))),128))])]),_:1}),A("div",kl,[e(R,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:s[0]||(s[0]=U=>n.value=!0)},{default:l(()=>s[9]||(s[9]=[E("Edit Room")])),_:1}),e(Z,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:f},{default:l(()=>s[10]||(s[10]=[E("Delete Room")])),_:1})])]),_:1}),e(De,{scrollable:"",modelValue:n.value,"onUpdate:modelValue":s[6]||(s[6]=U=>n.value=U),width:"auto"},{default:l(()=>[e(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(R,{icon:"",dark:"",onClick:s[1]||(s[1]=U=>n.value=!1)},{default:l(()=>[e(X,null,{default:l(()=>s[11]||(s[11]=[E("mdi:mdi-close")])),_:1})]),_:1}),e(ie,null,{default:l(()=>[E("Room Details ("+P(u.value.Name)+")",1)]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(R,{variant:"text",onClick:V},{default:l(()=>s[12]||(s[12]=[E(" Save ")])),_:1})]),_:1})]),_:1}),e(Te,null,{default:l(()=>[e(te,null,{default:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(S,{label:r.value.formLabelName,type:"text",variant:"outlined",modelValue:u.value.Name,"onUpdate:modelValue":s[2]||(s[2]=U=>u.value.Name=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(D,null,{default:l(()=>[e(ce,{label:r.value.formLabelNotes,variant:"outlined",modelValue:u.value.Notes,"onUpdate:modelValue":s[3]||(s[3]=U=>u.value.Notes=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{type:"number",label:r.value.formLabelMinimumCapacity,variant:"outlined",modelValue:u.value.MinimumCapacity,"onUpdate:modelValue":s[4]||(s[4]=U=>u.value.MinimumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{type:"number",label:r.value.formLabelMaximumCapacity,variant:"outlined",modelValue:u.value.MaximumCapacity,"onUpdate:modelValue":s[5]||(s[5]=U=>u.value.MaximumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(D,null,{default:l(()=>s[13]||(s[13]=[A("h4",null," Availability & Costs (To Organisation) ",-1)])),_:1})]),_:1}),(c(!0),_(F,null,h(u.value.Costs,(U,y)=>(c(),_(F,{key:`venue-room-${u.value.ID}-cost-${U.ID}`},[u.value.Costs&&u.value.Costs[y]?(c(),C(El,{key:0,modelValue:u.value.Costs[y],"onUpdate:modelValue":O=>u.value.Costs[y]=O,onDeleted:O=>v(y)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):x("",!0)],64))),128)),e(R,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:a},{default:l(()=>s[14]||(s[14]=[E("Add Row")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Al=$({__name:"Venue",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["deleted"],["update:modelValue"]),setup(I,{emit:m}){const o=B(),d=m,r=w(I,"modelValue"),i=b(H(r.value)),u=b([]),n=b(!1),t=b(!1);o.getVenueRooms(i.value.VenueUUID).then(p=>{u.value=p}),W(i.value,()=>{t.value=!0});const a=({callback:p})=>{n.value=!0,o.saveVenue(i.value).then(()=>{n.value=!1,t.value=!1,r.value=i.value,p&&p("Venue Saved")}).catch(()=>{n.value=!1,p&&p("Failed to Saved Venue")})},v=({callback:p})=>{n.value=!0,o.deleteVenue(i.value.VenueUUID).then(s=>{n.value=!1,s?p&&(p("Venue Deleted"),d("deleted")):p&&p("Failed to Delete Venue")}).catch(()=>{p&&(p("Failed to Delete Venue"),n.value=!1)})},f=()=>{const p={ID:0,RoomUUID:L(),VenueID:i.value.ID,VenueUUID:i.value.VenueUUID,Order:u.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};o.saveRoom(p).then(s=>{s&&u.value.push(s)})},V=(p,s)=>{o.deleteRoom(u.value[s].RoomUUID).then(U=>{U&&u.value.splice(s,1)})};return(p,s)=>(c(),C(ve,null,{default:l(()=>[e(pe,null,{default:l(()=>[E(P(i.value.Name),1)]),_:1}),e(fe,null,{default:l(()=>[e(N,{"no-gutters":""},{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(S,{label:T(M).formLabelName,name:"name",variant:"outlined",modelValue:i.value.Name,"onUpdate:modelValue":s[0]||(s[0]=U=>i.value.Name=U)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ce,{label:T(M).formLabelDescription,name:"description",variant:"outlined",modelValue:i.value.Description,"onUpdate:modelValue":s[1]||(s[1]=U=>i.value.Description=U)},null,8,["label","modelValue"])]),_:1}),e(D,{class:"text-right",cols:"12"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(Z,{enabled:t.value,timeout:"7",onClick:a},null,8,["enabled"])]),_:1})]),_:1}),s[3]||(s[3]=A("h3",null,"Rooms",-1)),(c(!0),_(F,null,h(u.value,(U,y)=>(c(),C(te,{variant:"elevation",elevation:"6",key:`venue-room-${U.ID}`},{default:l(()=>[u.value&&u.value[y]?(c(),C(_l,{key:0,modelValue:u.value[y],"onUpdate:modelValue":O=>u.value[y]=O,onDeleted:O=>V(O,y)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):x("",!0)]),_:2},1024))),128)),e(te,{class:"ma-2"},{default:l(()=>[e(R,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:f},{default:l(()=>s[2]||(s[2]=[E("Add Room")])),_:1})]),_:1})]),_:1})]),_:1}))}}),Fl=$({__name:"VenuesEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["close","pageTitle","refresh"],["update:modelValue"]),setup(I,{emit:m}){const o=B(),d=m,r=w(I,"modelValue");d("pageTitle","Venues");const i=b([]);o.getConventionVenues(r.value.ConventionUUID).then(t=>{i.value=t});const u=()=>{const t={ID:0,VenueUUID:L(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Order:i.value.length+1,Name:"New Venue",Description:"",Rooms:[]};o.saveVenue(t).then(a=>{a&&i.value.push(a)})},n=t=>{i.value.splice(t,1)};return(t,a)=>(c(),_(F,null,[e(z,{fluid:"",class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(D,null,{default:l(()=>a[0]||(a[0]=[A("h3",null,"Venues",-1)])),_:1})]),_:1})]),_:1}),a[2]||(a[2]=A("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1)),a[3]||(a[3]=A("p",null," Attendee options are configured via the accommodation tab. ",-1)),e(te,null,{default:l(()=>[e(me,{variant:"accordion"},{default:l(()=>[(c(!0),_(F,null,h(i.value,(v,f)=>(c(),C(Al,{key:`venues-${v.ID}`,modelValue:i.value[f],"onUpdate:modelValue":V=>i.value[f]=V,onDeleted:V=>n(f)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(R,{color:"primary",onClick:u},{default:l(()=>a[1]||(a[1]=[E("Add Venue")])),_:1})]),_:1})]),_:1})],64))}}),Nl=$({__name:"AccommodationCost",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["deleted"],["update:modelValue"]),setup(I,{emit:m}){const o=m,d=w(I,"modelValue"),r=b([]);B().getConventionTickets(I.convention.ConventionUUID).then(a=>{a&&(r.value=a)});const u=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],n=()=>{o("deleted")},t=le(()=>r.value.filter(a=>(a.Type===K.TICKET_TYPE_TICKET||a.Type===K.TICKET_TYPE_ADD_ON)&&a.RequiresAccommodation&&a.DateStart===d.value.DateStart&&a.DateEnd===d.value.DateEnd));return(a,v)=>(c(),_(F,null,[e(N,{class:"align-center",dense:""},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>v[4]||(v[4]=[A("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1)])),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(we,null,{default:l(()=>[(c(!0),_(F,null,h(t.value,f=>(c(),C(Le,{key:f.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[E(P(f.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(N,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(S,{label:T(M).formLabelDateStart,type:"date",variant:"outlined",modelValue:d.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=f=>d.value.DateStart=f)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(S,{label:T(M).formLabelDateEnd,type:"date",variant:"outlined",modelValue:d.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=f=>d.value.DateEnd=f)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(S,{label:T(M).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:d.value.Price,"onUpdate:modelValue":v[2]||(v[2]=f=>d.value.Price=f),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(de,{label:T(M).formLabelPriceType,variant:"outlined",modelValue:d.value.Type,"onUpdate:modelValue":v[3]||(v[3]=f=>d.value.Type=f),items:u,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(R,{color:"red",icon:"mdi:mdi-minus",onClick:n})]),_:1})]),_:1})],64))}}),Sl=$({__name:"Accommodation",props:q({convention:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["deleted"],["update:modelValue"]),setup(I,{emit:m}){const o=B(),d=m,r=w(I,"modelValue"),i=b(H(r.value)),u=le(()=>I.venues.map(f=>f.Rooms.map(V=>({title:` ${f.Name} - ${V.Name}`,value:V}))).flat()),n=()=>{i.value.Costs||(i.value.Costs=[]),i.value.Costs.push({ID:0,CostUUID:L(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:be.PER_ROOM})},t=f=>{i.value.Costs.splice(f,1)},a=({callback:f})=>{o.deleteAccommodation(i.value.AccommodationUUID).then(V=>{V?f&&(f("Accommodation Deleted"),d("deleted")):f&&f("Failed to Delete Accommodation")}).catch(()=>{f&&f("Failed to Delete Accommodation")})},v=({callback:f})=>{o.saveAccommodation(i.value).then(V=>{V?(i.value.ID=V.ID,r.value=V,f&&f("Accommodation Saved")):f&&f("Failed to Save Accommodation")}).catch(()=>{f&&f("Failed to Save Accommodation")})};return(f,V)=>(c(),C(ve,null,{default:l(()=>[e(pe,null,{default:l(()=>[E(P(i.value.Name),1)]),_:1}),e(fe,null,{default:l(()=>[e(te,null,{default:l(()=>[e(N,null,{default:l(()=>[e(D,null,{default:l(()=>[e(S,{modelValue:i.value.Name,"onUpdate:modelValue":V[0]||(V[0]=p=>i.value.Name=p),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(D,null,{default:l(()=>[V[3]||(V[3]=A("h4",null," Room Pool ",-1)),V[4]||(V[4]=A("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1)),e(de,{clearable:!0,modelValue:i.value.Pool,"onUpdate:modelValue":V[1]||(V[1]=p=>i.value.Pool=p),items:u.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),V[5]||(V[5]=A("p",null," Pool total: ",-1)),A("p",null,[e(Q,{label:"Required Tags",variant:"outlined",modelValue:i.value.RequiredTags,"onUpdate:modelValue":V[2]||(V[2]=p=>i.value.RequiredTags=p),convention:f.convention,organisation:f.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),V[6]||(V[6]=A("h4",null," Accommodation Costs ",-1)),V[7]||(V[7]=A("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1)),i.value.Costs?(c(!0),_(F,{key:0},h(i.value.Costs,(p,s)=>(c(),C(Nl,{key:`venue-room-${i.value.ID}-cost-${p.ID}`,convention:f.convention,modelValue:i.value.Costs[s],"onUpdate:modelValue":U=>i.value.Costs[s]=U,onDeleted:U=>t(s)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):x("",!0)]),_:1})]),_:1}),e(N,{"no-gutters":""},{default:l(()=>[e(D,{class:"text-left"},{default:l(()=>[e(R,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:n},{default:l(()=>V[8]||(V[8]=[E("Add Row")])),_:1})]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:a}),e(Z,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Rl=$({__name:"AccommodationEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=B(),o=w(I,"modelValue"),d=b([]),r=b([]);m.getConventionAccommodation(o.value.ConventionUUID).then(n=>{n&&(d.value=n)}),m.getConventionVenues(o.value.ConventionUUID).then(n=>{n&&(r.value=n)});const i=()=>{const n={ID:0,AccommodationUUID:L(),ConventionID:o.value.ID,ConventionUUID:o.value.ConventionUUID,Order:d.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};m.saveAccommodation(n).then(t=>{t&&d.value.push(t)})},u=n=>{d.value.splice(n,1)};return(n,t)=>(c(),_(F,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(D,null,{default:l(()=>t[0]||(t[0]=[A("h3",null,"Accommodation",-1)])),_:1})]),_:1})]),_:1}),t[2]||(t[2]=A("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1)),t[3]||(t[3]=A("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1)),e(te,null,{default:l(()=>[e(me,{variant:"accordion"},{default:l(()=>[(c(!0),_(F,null,h(d.value,(a,v)=>(c(),C(Sl,{key:a.AccommodationUUID,convention:o.value,venues:r.value,modelValue:d.value[v],"onUpdate:modelValue":f=>d.value[v]=f,onDeleted:f=>u(v)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(R,{color:"primary",onClick:i},{default:l(()=>t[1]||(t[1]=[E("Add Accommodation")])),_:1})]),_:1})]),_:1})],64))}}),xl=$({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=Ee.getInstance(),d=b([]),r=b([]);return o==null||o.getConventionExtras(m.value.ConventionUUID).then(i=>{d.value=i;const u=m.value.Values.find(n=>n.Title==="SelectedExtras");if(u)try{r.value=JSON.parse(u.Value)}catch{}}),W(r,()=>{const i=m.value.Values.find(u=>u.Title==="SelectedExtras");if(i)i.Value=JSON.stringify(r.value);else{const u={ID:0,FieldValueUUID:L(),FieldID:m.value.ID,FieldUUID:m.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(r.value)};m.value.Values.push(u)}}),(i,u)=>(c(!0),_(F,null,h(d.value,n=>(c(),C(J,{key:n.ExtraUUID,modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=t=>r.value=t),label:n.Name,value:n.ExtraUUID,name:m.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),Pl=$({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=Ee.getInstance(),d=b([]),r=b([]);return o==null||o.getConventionInterests(m.value.ConventionUUID).then(i=>{d.value=i;const u=m.value.Values.find(n=>n.Title==="SelectedInterests");if(u)try{r.value=JSON.parse(u.Value)}catch{}}),W(r,()=>{const i=m.value.Values.find(u=>u.Title==="SelectedInterests");if(i)i.Value=JSON.stringify(r.value);else{const u={ID:0,FieldValueUUID:L(),FieldID:m.value.ID,FieldUUID:m.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(r.value)};m.value.Values.push(u)}}),(i,u)=>(c(!0),_(F,null,h(d.value,n=>(c(),C(J,{key:n.InterestUUID,modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=t=>r.value=t),label:n.Name,value:n.InterestUUID,name:m.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),Ol=$({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=Ee.getInstance(),d=b([]),r=b([]);return o==null||o.getConventionTickets(m.value.ConventionUUID).then(i=>{d.value=i;const u=m.value.Values.find(n=>n.Title==="SelectedTickets");if(u)try{r.value=JSON.parse(u.Value)}catch{}}),W(r,()=>{const i=m.value.Values.find(u=>u.Title==="SelectedTickets");if(i)i.Value=JSON.stringify(r.value);else{const u={ID:0,FieldValueUUID:L(),FieldID:m.value.ID,FieldUUID:m.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(r.value)};m.value.Values.push(u)}}),(i,u)=>(c(!0),_(F,null,h(d.value.filter(n=>n&&n.Type===T(K).TICKET_TYPE_GROUP),n=>(c(),C(J,{key:n.TicketUUID,modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=t=>r.value=t),label:n.Name,value:n.TicketUUID,name:m.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),$l=$({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=Ee.getInstance(),d=b([]),r=b(m.value.Values.map(n=>n.Value)),i=b({sharing:!1});try{const n=JSON.parse(m.value.Data);n&&(i.value=n)}catch{}const u=()=>{m.value.Data=JSON.stringify(i.value),m.value.Values=r.value.map(n=>{var t,a,v;return{ID:0,FieldValueUUID:L(),FieldID:((t=m.value)==null?void 0:t.ID)||0,FieldUUID:((a=m.value)==null?void 0:a.FieldUUID)||"",Title:((v=d.value.find(f=>f.AccommodationUUID==n))==null?void 0:v.Name)||"",Value:n}})};return o==null||o.getConventionAccommodation(m.value.ConventionUUID).then(n=>{n&&(d.value=n)}),(n,t)=>(c(),_(F,null,[t[2]||(t[2]=A("h5",null,"Display Options",-1)),e(J,{label:"Show Sharing Options",modelValue:i.value.sharing,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value.sharing=a),"hide-details":"",onChange:u},null,8,["modelValue"]),t[3]||(t[3]=A("h5",null,"Accommodation Choices",-1)),(c(!0),_(F,null,h(d.value,a=>(c(),C(J,{key:a.ID,modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=v=>r.value=v),label:a.Name,value:a.AccommodationUUID,"hide-details":"",onChange:u},null,8,["modelValue","label","value"]))),128))],64))}}),Ml=$({__name:"EditFieldDialogAge",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){var v,f,V;const m=w(I,"modelValue"),o=new Date,d=o.getFullYear(),r=(o.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),i=o.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),u=b(parseInt(((v=m.value.Values.find(p=>p.Title==="MIN_AGE"))==null?void 0:v.Value)||"18")),n=b(((f=m.value.Values.find(p=>p.Title==="BEFORE_DATE"))==null?void 0:f.Value)||`${d}-${r}-${i}`),t=b(((V=m.value.Values.find(p=>p.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:V.Value)||""),a=()=>{var p,s,U,y,O,g;m.value.Values=[{ID:0,FieldValueUUID:L(),FieldID:((p=m.value)==null?void 0:p.ID)||0,FieldUUID:((s=m.value)==null?void 0:s.FieldUUID)||"",Title:"MIN_AGE",Value:u.value.toString()},{ID:0,FieldValueUUID:L(),FieldID:((U=m.value)==null?void 0:U.ID)||0,FieldUUID:((y=m.value)==null?void 0:y.FieldUUID)||"",Title:"BEFORE_DATE",Value:n.value},{ID:0,FieldValueUUID:L(),FieldID:((O=m.value)==null?void 0:O.ID)||0,FieldUUID:((g=m.value)==null?void 0:g.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:t.value}]};return a(),(p,s)=>(c(),C(z,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=U=>u.value=U),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:a},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=U=>n.value=U),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:a},null,8,["modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(D,null,{default:l(()=>[e(Q,{modelValue:t.value,"onUpdate:modelValue":s[2]||(s[2]=U=>t.value=U),convention:p.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${u.value} at time of data entry`,onChange:a},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),ql=$({__name:"EditFieldDialogHTML",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=b({html:""});try{const r=JSON.parse(m.value.Data);r&&(o.value=r)}catch{}const d=()=>{m.value.Data=JSON.stringify(o.value)};return(r,i)=>(c(),C(ce,{variant:"outlined",label:"Raw HTML",modelValue:o.value.html,"onUpdate:modelValue":i[0]||(i[0]=u=>o.value.html=u),onKeydown:d,onChange:d},null,8,["modelValue"]))}}),wl=$({__name:"EditFieldDialogBadgeImage",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=b({charge:0,free:0,height:0,label:!1,maximum:0,tags:[],width:0});try{o.value=je(m.value.Data)}catch{}const d=()=>{m.value.Data=JSON.stringify(o.value)};return(r,i)=>(c(),_(F,null,[i[7]||(i[7]=A("h5",{class:"my-2"},"Tags & Labels",-1)),e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(Q,{label:"Badge Tags",variant:"outlined",modelValue:o.value.tags,"onUpdate:modelValue":i[0]||(i[0]=u=>o.value.tags=u),convention:m.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that apply to this badge.","input-type":T(Je).UUID_ARRAY,onChange:d},null,8,["modelValue","convention","input-type"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(J,{modelValue:o.value.label,"onUpdate:modelValue":i[1]||(i[1]=u=>o.value.label=u),label:"Allow Custom Label",variant:"outlined","hide-details":"",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),i[8]||(i[8]=A("h5",{class:"my-2"},"Dimensions",-1)),e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:o.value.width,"onUpdate:modelValue":i[2]||(i[2]=u=>o.value.width=u),modelModifiers:{number:!0},label:"Width",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:d},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:o.value.height,"onUpdate:modelValue":i[3]||(i[3]=u=>o.value.height=u),modelModifiers:{number:!0},label:"Height",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),i[9]||(i[9]=A("h5",{class:"my-2"},"Limits",-1)),e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:o.value.maximum,"onUpdate:modelValue":i[4]||(i[4]=u=>o.value.maximum=u),modelModifiers:{number:!0},label:"Maximum Badges",hint:"Zero = Unlimited",variant:"outlined",type:"number",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),i[10]||(i[10]=A("h5",{class:"my-2"},"Costs",-1)),e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:o.value.charge,"onUpdate:modelValue":i[5]||(i[5]=u=>o.value.charge=u),modelModifiers:{number:!0},label:"Charge Per Badge",prefix:T(M).currencySymbol,variant:"outlined","hide-details":"",type:"number",min:"0",onChange:d},null,8,["modelValue","prefix"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:o.value.free,"onUpdate:modelValue":i[6]||(i[6]=u=>o.value.free=u),modelModifiers:{number:!0},label:"Free Badges",variant:"outlined","hide-details":"",type:"number",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1})],64))}}),Ll={key:0},Kl={key:1},hl=$({__name:"EditFieldDialog",props:q({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:q(["update:field"],["update:modelValue"]),setup(I,{emit:m}){const o=I,{convention:d,title:r=""}=o,i=m,u=w(I,"modelValue"),n=Ve(o,i,void 0,void 0,"field"),t=b(H(n.value)),a=b(""),v=b(t.value.Type);W(n,()=>{t.value=H(n.value)});const f=()=>{u.value=!1},V=()=>{t.value=H(n.value)},p=()=>{n.value=t.value},s=()=>{t.value.Values.push({ID:0,FieldValueUUID:L(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},U=O=>{t.value.Values.splice(O,1)},y=()=>{a.value="",t.value.Values=[]};return W(v,(O,g)=>{O!==g&&(t.value.Type=O,y())}),(O,g)=>(c(),C(Re,{modelValue:u.value,"onUpdate:modelValue":g[16]||(g[16]=k=>u.value=k),onReset:V,onSave:p,title:T(r),color:"primary",persistent:!0,fullscreen:!0},{default:l(()=>[e(z,{class:"pa-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(z,{class:"pa-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Name,"onUpdate:modelValue":g[0]||(g[0]=k=>t.value.Name=k),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Label,"onUpdate:modelValue":g[1]||(g[1]=k=>t.value.Label=k),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Hint,"onUpdate:modelValue":g[2]||(g[2]=k=>t.value.Hint=k),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Placeholder,"onUpdate:modelValue":g[3]||(g[3]=k=>t.value.Placeholder=k),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(de,{modelValue:v.value,"onUpdate:modelValue":g[4]||(g[4]=k=>v.value=k),label:"Type",variant:"outlined",items:T(Oe),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===T(Y).SELECT||t.value.Type===T(Y).CHECKBOX||t.value.Type===T(Y).BADGE_IMAGE?(c(),C(D,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[t.value.Type===T(Y).SELECT||t.value.Type===T(Y).CHECKBOX?(c(),C(J,{key:0,modelValue:t.value.Multiple,"onUpdate:modelValue":g[5]||(g[5]=k=>t.value.Multiple=k),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"])):t.value.Type===T(Y).BADGE_IMAGE?(c(),C(J,{key:1,modelValue:t.value.Multiple,"onUpdate:modelValue":g[6]||(g[6]=k=>t.value.Multiple=k),label:"Custom Fields",hint:"Enable additional badge fields","hide-details":""},null,8,["modelValue"])):x("",!0),t.value.Type===T(Y).SELECT?(c(),C(J,{key:2,modelValue:t.value.Autofill,"onUpdate:modelValue":g[7]||(g[7]=k=>t.value.Autofill=k),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):x("",!0)]),_:1})):x("",!0)]),_:1}),t.value.Type===T(Y).BADGE_IMAGE?(c(),C(N,{key:0},{default:l(()=>[e(D,null,{default:l(()=>[g[17]||(g[17]=A("h4",null,"Badge Image Options",-1)),e(wl,{modelValue:t.value,"onUpdate:modelValue":g[8]||(g[8]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):x("",!0),t.value.Type===T(Y).SELECT||t.value.Type===T(Y).CHECKBOX&&t.value.Multiple||t.value.Type===T(Y).RADIO||t.value.Type===T(Y).BADGE_IMAGE&&t.value.Multiple?(c(),C(N,{key:1},{default:l(()=>[e(D,null,{default:l(()=>[t.value.Type===T(Y).BADGE_IMAGE?(c(),_("h4",Ll,"Custom Fields")):(c(),_("h4",Kl,"Values")),e(z,{fluid:!0,class:"px-0"},{default:l(()=>[(c(!0),_(F,null,h(t.value.Values,(k,G)=>(c(),C(N,{key:k.ID},{default:l(()=>[e(D,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(S,{modelValue:k.Title,"onUpdate:modelValue":j=>k.Title=j,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(S,{modelValue:k.Value,"onUpdate:modelValue":j=>k.Value=j,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(R,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:j=>U(G)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(N,null,{default:l(()=>[e(D,null,{default:l(()=>[e(R,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:s},{default:l(()=>g[18]||(g[18]=[E("Add Item")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===T(Y).ACCOMMODATION?(c(),C(N,{key:2},{default:l(()=>[e(D,null,{default:l(()=>[g[19]||(g[19]=A("h4",null,"Accommodation",-1)),e($l,{modelValue:t.value,"onUpdate:modelValue":g[9]||(g[9]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(Y).AGE?(c(),C(N,{key:3},{default:l(()=>[e(D,null,{default:l(()=>[g[20]||(g[20]=A("h4",null,"Age",-1)),e(Ml,{modelValue:t.value,"onUpdate:modelValue":g[10]||(g[10]=k=>t.value=k),convention:T(d)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===T(Y).EXTRAS?(c(),C(N,{key:4},{default:l(()=>[e(D,null,{default:l(()=>[g[21]||(g[21]=A("h4",null,"Additional Purchases",-1)),e(xl,{modelValue:t.value,"onUpdate:modelValue":g[11]||(g[11]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(Y).HTML?(c(),C(N,{key:5},{default:l(()=>[e(D,null,{default:l(()=>[e(ql,{modelValue:t.value,"onUpdate:modelValue":g[12]||(g[12]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(Y).INTERESTS?(c(),C(N,{key:6},{default:l(()=>[e(D,null,{default:l(()=>[g[22]||(g[22]=A("h4",null,"Available Interests",-1)),e(Pl,{modelValue:t.value,"onUpdate:modelValue":g[13]||(g[13]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(Y).TICKET?(c(),C(N,{key:7},{default:l(()=>[e(D,null,{default:l(()=>[g[23]||(g[23]=A("h4",null,"Tickets",-1)),e(Ol,{modelValue:t.value,"onUpdate:modelValue":g[14]||(g[14]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):x("",!0)]),_:1})]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(te,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[g[24]||(g[24]=A("h4",{class:"mb-3"},"Field Preview",-1)),e($e,{admin:!0,field:t.value,convention:T(d),modelValue:a.value,"onUpdate:modelValue":g[15]||(g[15]=k=>a.value=k)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(R,{color:"blue-darken-1",variant:"text",onClick:f},{default:l(()=>g[25]||(g[25]=[E(" Cancel ")])),_:1}),e(R,{color:"blue-darken-1",variant:"text",onClick:V},{default:l(()=>g[26]||(g[26]=[E(" Reset ")])),_:1}),e(ae),e(R,{color:"blue-darken-1",variant:"text",onClick:p},{default:l(()=>g[27]||(g[27]=[E(" Save ")])),_:1})]),_:1},8,["modelValue","title"]))}}),Gl=$({__name:"FieldEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(I){const m=w(I,"modelValue"),o=B(),d=b(!1),r=b(!1),i=b([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),u=b([]);o.getConventionFields(m.value.ConventionUUID).then(k=>{k&&(u.value=k)});const n=b(-1),t=b({ID:0,FieldUUID:L(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),a=le(()=>n.value===-1?"New Field":"Edit Field"),v=()=>({ID:0,FieldUUID:L(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),f=b(v()),V=()=>{f.value.FieldUUID=L(),t.value=Object.assign({},v()),n.value=-1,d.value=!0},p=k=>{n.value=u.value.indexOf(k),t.value=Object.assign({},k),d.value=!0},s=k=>{n.value=u.value.indexOf(k),t.value=Object.assign({},k),r.value=!0},U=()=>{o.deleteField(t.value.FieldUUID).then(k=>{k&&(u.value.splice(n.value,1),O())})},y=()=>{d.value=!1,ge(()=>{t.value=Object.assign({},f.value),n.value=-1})},O=()=>{r.value=!1,ge(()=>{t.value=Object.assign({},f.value),n.value=-1})},g=()=>{o.saveField(t.value).then(k=>{k&&(n.value>-1?Object.assign(u.value[n.value],k):u.value.push(k),y())})};return(k,G)=>(c(),C(Ge,{headers:i.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>G[3]||(G[3]=[E("Field Editor")])),_:1}),e(he,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(R,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:V},{default:l(()=>G[4]||(G[4]=[E(" New Item ")])),_:1}),e(Ke,{modelValue:r.value,"onUpdate:modelValue":G[0]||(G[0]=j=>r.value=j),onDelete:U},null,8,["modelValue"])]),_:1}),d.value?(c(),C(hl,{key:0,modelValue:d.value,"onUpdate:modelValue":G[1]||(G[1]=j=>d.value=j),field:t.value,"onUpdate:field":[G[2]||(G[2]=j=>t.value=j),g],title:a.value,convention:m.value},null,8,["modelValue","field","title","convention"])):x("",!0)]),"item.actions":l(({item:j})=>[e(X,{size:"small",class:"me-2",onClick:Be=>p(j)},{default:l(()=>G[5]||(G[5]=[E(" mdi:mdi-pencil ")])),_:2},1032,["onClick"]),e(X,{size:"small",onClick:Be=>s(j)},{default:l(()=>G[6]||(G[6]=[E(" mdi:mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Bl=(I,m)=>{const o=Ve(I,m),d=Ve(I,m,void 0,void 0,"item"),r=b(H(d.value));return W(d,()=>{r.value=H(d.value)}),{state:o,model:d,close:()=>{o.value=!1},reset:()=>{d.value=H(r.value)},save:()=>{m("save")}}},Yl=$({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(I,{emit:m}){const o=I,d=m,{state:r,model:i,close:u,reset:n,save:t}=Bl(o,d);return(a,v)=>(c(),C(Re,{modelValue:T(r),"onUpdate:modelValue":v[0]||(v[0]=f=>ye(r)?r.value=f:null),onReset:T(n),onSave:T(t),title:a.title,color:"primary","card-class":a.cardClass,fullscreen:!0,persistent:!0},{toolbarButtons:l(()=>[Ae(a.$slots,"toolbarButtons")]),actions:l(()=>[e(R,{color:"blue-darken-1",variant:"text",onClick:T(u)},{default:l(()=>v[1]||(v[1]=[E(" Cancel ")])),_:1},8,["onClick"]),e(R,{color:"blue-darken-1",variant:"text",onClick:T(n)},{default:l(()=>v[2]||(v[2]=[E(" Reset ")])),_:1},8,["onClick"]),e(ae),e(R,{color:"blue-darken-1",variant:"text",onClick:T(t)},{default:l(()=>v[3]||(v[3]=[E(" Save ")])),_:1},8,["onClick"])]),default:l(()=>[Ae(a.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),Hl={class:"pa-0 border-0 ma-0"},jl={class:"pa-0 border-0 ma-0"},zl=$({__name:"EditFormField",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=B(),d=b([]),r=b([]),i=b(""),u=n=>{var t;m.value.Field=(t=r.value.find(a=>a.value===n))==null?void 0:t.field};return o.getConventionFields(I.convention.ConventionUUID).then(n=>{n&&(d.value=n,r.value=n.map(t=>({title:`${t.Label} (${(Oe.find(a=>a.value===t.Type)||{title:""}).title})`,value:t.FieldUUID,field:t})),u(m.value.FieldUUID))}),(n,t)=>(c(),C(N,null,{default:l(()=>[e(D,{cols:"12",md:"6"},{default:l(()=>[A("fieldset",Hl,[t[5]||(t[5]=A("legend",{class:"mb-2"},"Field Settings",-1)),e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(de,{modelValue:m.value.FieldUUID,"onUpdate:modelValue":[t[0]||(t[0]=a=>m.value.FieldUUID=a),u],items:r.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(S,{modelValue:m.value.MinLength,"onUpdate:modelValue":t[1]||(t[1]=a=>m.value.MinLength=a),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(S,{modelValue:m.value.MaxLength,"onUpdate:modelValue":t[2]||(t[2]=a=>m.value.MaxLength=a),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"4"},{default:l(()=>[e(J,{modelValue:m.value.Required,"onUpdate:modelValue":t[3]||(t[3]=a=>m.value.Required=a),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),m.value.FieldUUID&&m.value.Field?(c(),C(D,{key:0,cols:"12",md:"6"},{default:l(()=>[A("fieldset",jl,[t[6]||(t[6]=A("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1)),m.value.Field?(c(),C($e,{key:0,admin:!0,field:m.value.Field,"persistent-hint":!0,required:m.value.Required,convention:n.convention,modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=a=>i.value=a)},null,8,["field","required","convention","modelValue"])):x("",!0)])]),_:1})):x("",!0)]),_:1}))}}),Jl={class:"d-none d-sm-block"},Xl=$({__name:"EditFormSectionFields",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=()=>{var d;return{ID:0,SectionFieldUUID:L(),SectionID:m.value.ID,SectionUUID:m.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((d=m.value.Fields)==null?void 0:d.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(d,r)=>m.value.Fields!==void 0?(c(),C(Me,{key:0,modelValue:m.value.Fields,"onUpdate:modelValue":r[0]||(r[0]=i=>m.value.Fields=i),closeable:!1,title:"Fields","new-item":o,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},xe({_:2},[h(m.value.Fields,(i,u)=>({name:`field_${u}_title`,fn:l(()=>[i.Field?(c(),_(F,{key:0},[E(P(i.Field.Label)+" ("+P(i.Field.Name)+") ",1),A("template",Jl,[E(" ["+P(i.Field.Type)+"] ",1)])],64)):(c(),_(F,{key:1},[E("New Field")],64))])})),h(m.value.Fields,(i,u)=>({name:`field_${u}`,fn:l(()=>[e(zl,{modelValue:m.value.Fields[u],"onUpdate:modelValue":n=>m.value.Fields[u]=n,convention:d.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):x("",!0)}}),Wl=$({__name:"EditFormSections",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const m=w(I,"modelValue"),o=()=>{const d={ID:0,SectionUUID:L(),FormID:m.value.ID,FormUUID:m.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:L(),SectionID:0,SectionUUID:"",Edit:!0}};return d.State.SectionID=d.ID,d.State.SectionUUID=d.SectionUUID,d};return(d,r)=>(c(),C(Me,{modelValue:m.value.Sections,"onUpdate:modelValue":r[0]||(r[0]=i=>m.value.Sections=i),"new-item":o,closeable:!1,title:"Sections","slot-name-prefix":"section"},xe({_:2},[h(m.value.Sections,(i,u)=>({name:`section_${u}`,fn:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:i.Name,"onUpdate:modelValue":n=>i.Name=n,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:i.Heading,"onUpdate:modelValue":n=>i.Heading=n,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(ce,{modelValue:i.Description,"onUpdate:modelValue":n=>i.Description=n,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),i.Fields?(c(),C(Xl,{key:0,modelValue:m.value.Sections[u],"onUpdate:modelValue":n=>m.value.Sections[u]=n,convention:d.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):x("",!0)])}))]),1032,["modelValue"]))}}),Ql=$({__name:"FormRendererPopup",props:q({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:q(["update:form"],["update:modelValue"]),setup(I,{emit:m}){const o=I,{admin:d=!1,convention:r,title:i="",cardClass:u=""}=o,n=m,t=w(I,"modelValue"),a=Ve(o,n,void 0,void 0,"form"),v=b(H(a.value));W(a,()=>{v.value=H(a.value)});const f=()=>{t.value=!1};return(V,p)=>(c(),C(Re,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=s=>t.value=s),title:T(i),color:"primary","card-class":T(u)},{toolbarButtons:l(()=>[Ae(V.$slots,"toolbarButtons")]),actions:l(()=>[e(R,{color:"blue-darken-1",variant:"text",onClick:f},{default:l(()=>p[2]||(p[2]=[E(" Close ")])),_:1})]),default:l(()=>[e(ze,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=s=>v.value=s),admin:T(d),convention:T(r),preview:V.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),Zl=$({__name:"EditFormDialog",props:q({convention:{},form:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:q(["update:form"],["update:modelValue"]),setup(I,{emit:m}){const o=I,{convention:d}=o,r=w(I,"modelValue"),i=m,u=B(),n=Ve(o,i,void 0,void 0,"form"),t=b(!1),a=b(H(n.value));W(n,()=>{a.value=H(n.value)});const v=()=>{u.saveForm(a.value).then(V=>{V&&(n.value=V,r.value=!1)})},f=()=>{t.value=!0};return(V,p)=>(c(),C(Yl,{modelValue:r.value,"onUpdate:modelValue":p[14]||(p[14]=s=>r.value=s),item:a.value,"onUpdate:item":p[15]||(p[15]=s=>a.value=s),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(ll,null,{default:l(()=>[e(R,{"prepend-icon":"mdi:mdi-developer-board",onClick:f},{default:l(()=>p[16]||(p[16]=[A("template",{class:"d-none d-sm-inline"},[E("Preview")],-1)])),_:1})]),_:1})]),default:l(()=>[e(me,null,{default:l(()=>[e(ve,{class:"mt-0"},{default:l(()=>[e(pe,null,{default:l(()=>p[17]||(p[17]=[E("General Settings")])),_:1}),e(fe,null,{default:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(z,{class:"pa-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:a.value.Name,"onUpdate:modelValue":p[0]||(p[0]=s=>a.value.Name=s),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:a.value.Heading,"onUpdate:modelValue":p[1]||(p[1]=s=>a.value.Heading=s),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ce,{modelValue:a.value.Description,"onUpdate:modelValue":p[2]||(p[2]=s=>a.value.Description=s),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(de,{modelValue:a.value.Type,"onUpdate:modelValue":p[3]||(p[3]=s=>a.value.Type=s),label:"Type",variant:"outlined",items:T(Ze),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:a.value.NotificationEmail,"onUpdate:modelValue":p[4]||(p[4]=s=>a.value.NotificationEmail=s),label:"Notification Email",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",class:"d-none"},{default:l(()=>[e(S,{modelValue:a.value.State.Stage,"onUpdate:modelValue":p[5]||(p[5]=s=>a.value.State.Stage=s),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(J,{modelValue:a.value.State.New,"onUpdate:modelValue":p[6]||(p[6]=s=>a.value.State.New=s),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(J,{modelValue:a.value.State.Edit,"onUpdate:modelValue":p[7]||(p[7]=s=>a.value.State.Edit=s),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(J,{modelValue:a.value.State.Independent,"onUpdate:modelValue":p[8]||(p[8]=s=>a.value.State.Independent=s),label:"Independent of Registration Form"},null,8,["modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Q,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":p[9]||(p[9]=s=>a.value.RequiredTags=s),convention:T(d),organisation:T(d).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(qe,{label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":p[10]||(p[10]=s=>a.value.RequiredGroupMemberships=s),convention:T(d),organisation:T(d).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a.value?(c(),C(Wl,{key:0,modelValue:a.value,"onUpdate:modelValue":p[11]||(p[11]=s=>a.value=s),convention:T(d),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):x("",!0),t.value?(c(),C(Ql,{key:1,modelValue:t.value,"onUpdate:modelValue":p[12]||(p[12]=s=>t.value=s),form:a.value,"onUpdate:form":p[13]||(p[13]=s=>a.value=s),admin:!0,convention:T(d),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):x("",!0)]),_:1},8,["modelValue","item"]))}}),et=(I,m)=>{const o=b(!1),d=b(!1),r=b(I),i=b(-1),u=b(m),n=b(m),t=le(()=>i.value===-1?"New Form":"Edit Form"),a=()=>{r.value=I},v=y=>{i.value=r.value.indexOf(y),u.value=Object.assign({},y),o.value=!0},f=y=>{i.value=r.value.indexOf(y),u.value=Object.assign({},y),d.value=!0},V=()=>{d.value=!1,ge(()=>{u.value=Object.assign({},n.value),i.value=-1}).then()},p=()=>{r.value.splice(i.value,1),V()},s=()=>{o.value=!1,ge(()=>{u.value=Object.assign({},n.value),i.value=-1}).then()},U=()=>{i.value>-1?Object.assign(r.value[i.value],u.value):r.value.push(u.value),s()};return W(o,y=>{y||s()}),W(d,y=>{y||V()}),{collection:r,defaultItem:n,dialog:o,dialogDelete:d,editedItem:u,formTitle:t,reset:a,editItem:v,deleteItem:f,deleteItemConfirm:p,close:s,save:U}},lt=$({__name:"FormEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(I){const m=w(I,"modelValue"),o=B(),d=b([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),r=b([]),i=b([]);o.getConventionFields(m.value.ConventionUUID).then(O=>{r.value=O}),o.getConventionForms(m.value.ConventionUUID).then(O=>{i.value=O});const u={ID:0,FormUUID:L(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,ParentID:0,ParentUUID:Ce,Name:"",Heading:"",Description:"",Type:el.FORM_TYPE_ADDITIONAL,Sections:[],State:{ID:0,FormStateUUID:L(),FormID:0,FormUUID:Ce,New:!1,Edit:!1,Stage:0,Independent:!1},RequiredGroupMemberships:[],RequiredTags:[],NotificationEmail:""};u.State.FormUUID=u.FormUUID;const{collection:n,defaultItem:t,dialog:a,dialogDelete:v,editedItem:f,editItem:V,deleteItem:p,deleteItemConfirm:s,save:U}=et(i,u);n.value.forEach(O=>{O.Sections.forEach(g=>{var k;(k=g.Fields)==null||k.forEach(G=>{G.Field=r.value.find(j=>j.ID===G.FieldID)})})});const y=O=>{o.deleteForm(O.FormUUID).then(g=>{g&&p(O)})};return(O,g)=>(c(),C(Ge,{headers:d.value,items:T(n),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>g[4]||(g[4]=[E("Form Editor")])),_:1}),e(he,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(R,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:g[0]||(g[0]=k=>{f.value=Object.assign({},T(t)),a.value=!0})},{default:l(()=>g[5]||(g[5]=[E(" New Item ")])),_:1}),e(Ke,{modelValue:T(v),"onUpdate:modelValue":g[1]||(g[1]=k=>ye(v)?v.value=k:null),onDelete:T(s)},null,8,["modelValue","onDelete"])]),_:1}),T(a)?(c(),C(Zl,{key:0,modelValue:T(a),"onUpdate:modelValue":g[2]||(g[2]=k=>ye(a)?a.value=k:null),form:T(f),"onUpdate:form":[g[3]||(g[3]=k=>ye(f)?f.value=k:null),T(U)],convention:m.value},null,8,["modelValue","form","onUpdate:form","convention"])):x("",!0)]),"item.actions":l(({item:k})=>[e(X,{size:"small",class:"me-2",onClick:G=>T(V)(k)},{default:l(()=>g[6]||(g[6]=[E(" mdi:mdi-pencil ")])),_:2},1032,["onClick"]),e(X,{size:"small",onClick:G=>y(k)},{default:l(()=>g[7]||(g[7]=[E(" mdi:mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Ht=$({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(I,{emit:m}){const o=m,d=Ye(),r=B(),u=b({ID:0,ConventionUUID:Ce,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),n=b();W(n,()=>{a.value.find(f=>f.id===n.value&&f.title==="General")&&t()});const t=()=>{r.getConvention(d.params.convention.toString()).then(v=>{v?(u.value=v,o("pageTitle",`Convention Editor - ${u.value.Name}`)):o("pageTitle","Convention Editor - New Convention")})},a=b([{id:L(),title:"Accommodation",component:ue(Rl),model:u},{id:L(),title:"Additional Purchases",component:ue(sl),model:u},{id:L(),title:"Fields",component:ue(Gl),model:u},{id:L(),title:"Forms",component:ue(lt),model:u},{id:L(),title:"Interests",component:ue(vl),model:u},{id:L(),title:"Tickets",component:ue(bl),model:u},{id:L(),title:"Venues",component:ue(Fl),model:u}]);return o("pageTitle","Convention Editor"),t(),(v,f)=>(c(),_("div",null,[u.value&&u.value.ConventionUUID!==T(Ce)?(c(),_(F,{key:0},[e(ne,{color:"blue-darken-4"},{default:l(()=>[e(al,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=V=>n.value=V),"show-arrows":""},{default:l(()=>[(c(!0),_(F,null,h(a.value,V=>(c(),C(ol,{key:V.id,value:V.id},{default:l(()=>[E(P(V.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(tl,{modelValue:n.value,"onUpdate:modelValue":f[1]||(f[1]=V=>n.value=V),disabled:!0},{default:l(()=>[(c(!0),_(F,null,h(a.value,V=>(c(),C(nl,{key:V.id,value:V.id},{default:l(()=>[V.id===n.value?(c(),C(re,{key:0,class:"pa-2"},{default:l(()=>[(c(),C(He(V.component),{modelValue:V.model,"onUpdate:modelValue":p=>V.model=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):x("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):x("",!0)]))}});export{Ht as default};
