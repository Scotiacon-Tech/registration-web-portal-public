import{u as C}from"./useStoreAPI-DljgL9dg.js";import{i as D,r as A,$ as I,q as u,v as s,R as k,n,f as m,x as p,G as d,D as x,H as B,O as U}from"./index-BMoGObfb.js";import{V as _}from"./VApp-nCGHdH2x.js";import{V as F,a as R}from"./VAlert-Cw5I9eMz.js";import{V as E}from"./VBtn-Cx5iTPZn.js";import"./layout-M72nyDQC.js";import"./createSimpleFunctional-dU5y76ve.js";const q=D({__name:"CameraView",setup(N){const f=U(),g=C(),v=k(),l=A(!1),o=I("videoDisplay");navigator.mediaDevices.getUserMedia({video:!0}).then(a=>{o.value&&(o.value.srcObject=a,o.value.play())}).catch(a=>{console.error("Error accessing camera: ",a)});const w=()=>{if(!o.value)return;const a=document.createElement("canvas");a.width=o.value.videoWidth,a.height=o.value.videoHeight;const e=a.getContext("2d",{alpha:!1,jpegQuality:.8});e&&"drawImage"in e&&e.drawImage(o.value,0,0);const r=a.toDataURL("image/webp").replace(/^data:image\/(png|jpeg|webp);base64,/,"");y(r)},y=(a,e="capture.webp")=>{const r=atob(a),i=new Array(r.length);for(let t=0;t<r.length;t++)i[t]=r.charCodeAt(t);const b=new Uint8Array(i),h=new Blob([b],{type:"image/webp"}),c=new FormData;c.append("image",h,e),g.SaveFormFile(c).then(t=>{console.log("Success:",t),f.registerCameraTetherSession(v.params.session,t.FileUUID).then(V=>{V.FileUUID&&(console.log("Camera tether session registered"),l.value=!0)})}).catch(t=>{console.error("Error:",t)})};return(a,e)=>(n(),u(_,null,{default:s(()=>[l.value?(n(),u(F,{key:0,color:"success"},{default:s(()=>[m(R,null,{default:s(()=>e[0]||(e[0]=[p("Photo Received")])),_:1}),e[1]||(e[1]=d("p",null," You may now close this window. ",-1))]),_:1})):(n(),x(B,{key:1},[d("video",{ref_key:"videoDisplay",ref:o},null,512),m(E,{color:"success",class:"rounded-0",onClick:w},{default:s(()=>e[2]||(e[2]=[p("Capture")])),_:1})],64))]),_:1}))}});export{q as default};
