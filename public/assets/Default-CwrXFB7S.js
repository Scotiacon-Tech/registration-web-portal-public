import{p as R,r as p,s as w,c as g,a as ce,w as E,o as de,b as ve,d as B,u as me,e as Q,t as N,f as t,m as M,h as W,i as G,j as fe,k as Y,l as H,n as V,q as _,v as n,x as K,y as X,z as ge,A as L,E as Z,_ as ee,B as pe,C as A,D as $,F as he,G as ae,H as te,I as ye,J as Ve,T as ke,S as _e}from"./index-C2be9rQA.js";import{G as Se,R as O,a as be}from"./userData-zDq4J9g2.js";import{u as Ce}from"./useAvatar-DlhRhHNC.js";import{C as Te}from"./canEditOrganisation-B4LefMVD.js";import{G as D}from"./group-Dg_peWef.js";import{C as x}from"./canDo-p4a2Dhdx.js";import{C as Ie}from"./canViewOperations-B4eKc6Xb.js";import{m as Pe,V as j,a as we}from"./VToolbar-1nvAAjx6.js";import{V as Re}from"./scopeId-PTROHj70.js";import{V as Le}from"./VTextField-DFkSeFBJ.js";import{u as U,m as Be,V as le,a as z,b as Ue,c as Ee,d as Ne,e as q,f as Ae,g as De,h as xe,i as Oe,j as He,k as Me,l as Ge,n as ze,o as Fe}from"./VContainer-DsKJp95U.js";import{m as oe,u as se,a as ne,c as re}from"./layout-CTlWo4Sc.js";import{u as Ye,V as J,a as T,b as $e}from"./VList-BSiSbCAy.js";import{V as ue,a as je}from"./forwardRefs-mpSsDQm9.js";import{V as qe}from"./VDivider-CVpoQYAf.js";import{V as Je,a as ie}from"./VNavigationDrawer-CUwHatM7.js";import{s as Qe}from"./index-DFZh32pl.js";import"./useStoreAPI-BzkqZw9C.js";import"./createSimpleFunctional-DNH0bj_6.js";import"./form-COM3naNk.js";const We=(e,r=void 0)=>e===void 0?!1:r===void 0?x(e,D.GROUP_TYPE_CONVENTION).ManageUsers:x(e,D.GROUP_TYPE_CONVENTION,r.ConventionUUID,r).ManageUsers,Ke=(e,r=void 0)=>{let l;return e===void 0?!1:(r===void 0?l=x(e,D.GROUP_TYPE_CONVENTION):l=x(e,D.GROUP_TYPE_CONVENTION,r.ConventionUUID,r),l.EditConvention||l.ManageViews||l.ViewRegistration||l.EditRegistration)},Xe=R({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function Ze(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:l}=r;let u=0,i=0;const a=p(null),o=w(0),d=w(0),m=w(0),c=w(!1),v=w(!1),h=g(()=>Number(e.scrollThreshold)),S=g(()=>ce((h.value-o.value)/h.value||0)),y=()=>{const f=a.value;if(!f||l&&!l.value)return;u=o.value,o.value="window"in f?f.pageYOffset:f.scrollTop;const k=f instanceof Window?document.documentElement.scrollHeight:f.scrollHeight;if(i!==k){i=k;return}v.value=o.value<u,m.value=Math.abs(o.value-h.value)};return E(v,()=>{d.value=d.value||o.value}),E(c,()=>{d.value=0}),de(()=>{E(()=>e.scrollTarget,f=>{var b;const k=f?document.querySelector(f):window;k&&k!==a.value&&((b=a.value)==null||b.removeEventListener("scroll",y),a.value=k,a.value.addEventListener("scroll",y,{passive:!0}))},{immediate:!0})}),ve(()=>{var f;(f=a.value)==null||f.removeEventListener("scroll",y)}),l&&E(l,y,{immediate:!0}),{scrollThreshold:h,currentScroll:o,currentThreshold:m,isScrollActive:c,scrollRatio:S,isScrollingUp:v,savedScroll:d}}const ea=R({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...Pe(),...oe(),...Xe(),height:{type:[Number,String],default:64}},"VAppBar"),aa=B()({name:"VAppBar",props:ea(),emits:{"update:modelValue":e=>!0},setup(e,r){let{slots:l}=r;const u=p(),i=me(e,"modelValue"),a=g(()=>{var P;const s=new Set(((P=e.scrollBehavior)==null?void 0:P.split(" "))??[]);return{hide:s.has("hide"),fullyHide:s.has("fully-hide"),inverted:s.has("inverted"),collapse:s.has("collapse"),elevate:s.has("elevate"),fadeImage:s.has("fade-image")}}),o=g(()=>{const s=a.value;return s.hide||s.fullyHide||s.inverted||s.collapse||s.elevate||s.fadeImage||!i.value}),{currentScroll:d,scrollThreshold:m,isScrollingUp:c,scrollRatio:v}=Ze(e,{canScroll:o}),h=g(()=>a.value.hide||a.value.fullyHide),S=g(()=>e.collapse||a.value.collapse&&(a.value.inverted?v.value>0:v.value===0)),y=g(()=>e.flat||a.value.fullyHide&&!i.value||a.value.elevate&&(a.value.inverted?d.value>0:d.value===0)),f=g(()=>a.value.fadeImage?a.value.inverted?1-v.value:v.value:void 0),k=g(()=>{var C,F;if(a.value.hide&&a.value.inverted)return 0;const s=((C=u.value)==null?void 0:C.contentHeight)??0,P=((F=u.value)==null?void 0:F.extensionHeight)??0;return h.value?d.value<m.value||a.value.fullyHide?s+P:s:s+P});Q(g(()=>!!e.scrollBehavior),()=>{W(()=>{h.value?a.value.inverted?i.value=d.value>m.value:i.value=c.value||d.value<m.value:i.value=!0})});const{ssrBootStyles:b}=Ye(),{layoutItemStyles:I}=se({id:e.name,order:g(()=>parseInt(e.order,10)),position:N(e,"location"),layoutSize:k,elementSize:w(void 0),active:i,absolute:N(e,"absolute")});return U(()=>{const s=j.filterProps(e);return t(j,M({ref:u,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...I.value,"--v-toolbar-image-opacity":f.value,height:void 0,...b.value},e.style]},s,{collapse:S.value,flat:y.value}),l)}),{}}}),ta=R({...Be({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),la=B()({name:"VAppBarNavIcon",props:ta(),setup(e,r){let{slots:l}=r;return U(()=>t(le,M(e,{class:["v-app-bar-nav-icon"]}),l)),{}}}),oa=R({...z(),...Ue(),...ne()},"VLayout"),sa=B()({name:"VLayout",props:oa(),setup(e,r){let{slots:l}=r;const{layoutClasses:u,layoutStyles:i,getLayoutItem:a,items:o,layoutRef:d}=re(e),{dimensionStyles:m}=Ee(e);return U(()=>{var c;return t("div",{ref:d,class:[u.value,e.class],style:[m.value,i.value,e.style]},[(c=l.default)==null?void 0:c.call(l)])}),{getLayoutItem:a,items:o}}}),na=G({__name:"DashboardLayout",props:{user:{}},setup(e){const r=Ce(),l=fe(),u=p(!1),i=p("Default Title"),a=p(""),o=p(Y(e.user)),d=p(r(o.value.UserUUID));Z.getInstance().on("user.profile.saved",b=>{o.value=Y(b)});const c=p(localStorage.getItem("theme")||"light");l.global.name.value=c.value;const v=()=>{c.value=="light"?c.value="dark":c.value="light",l.global.name.value=c.value,localStorage.setItem("theme",c.value)},h=b=>{i.value=b},S=p(Ke(e.user)),y=p(Ie(e.user)),f=p(Te(e.user)),k=p(We(e.user));return(b,I)=>{const s=H("RouterLink"),P=H("RouterView");return V(),_(sa,{class:"h-100"},{default:n(()=>[t(aa,{color:"blue-darken-3"},{default:n(()=>[t(we,null,{default:n(()=>[K(X(i.value),1)]),_:1}),t(Re),t(Le,{modelValue:a.value,"onUpdate:modelValue":I[0]||(I[0]=C=>a.value=C),"prepend-inner-icon":"mdi:mdi-magnify",label:"Search",variant:"underlined","hide-details":"",clearable:!0,class:"d-none"},null,8,["modelValue"]),t(la,{variant:"text",onClick:I[1]||(I[1]=ge(C=>u.value=!u.value,["stop"]))})]),_:1}),t(Je,{modelValue:u.value,"onUpdate:modelValue":I[2]||(I[2]=C=>u.value=C),location:"right",temporary:!0},{default:n(()=>[t(J,null,{default:n(()=>[t(s,{to:{name:"Profile"}},{default:n(()=>[t(T,{title:o.value.DisplayName},{prepend:n(()=>[d.value?(V(),_(ue,{key:0,src:d.value,class:"rounded-circle mr-2",height:"32",width:"32"},null,8,["src"])):(V(),_(Ne,{key:1,icon:"mdi:mdi-account-circle",size:"x-large"}))]),_:1},8,["title"])]),_:1})]),_:1}),t(qe),t(P,{name:"navigation"},{default:n(()=>[t(J,null,{default:n(()=>[t(s,{to:"/"},{default:n(()=>[t(T,{"prepend-icon":"mdi:mdi-view-dashboard-outline",title:"Home",value:"home"})]),_:1}),S.value||f.value||k.value?(V(),_($e,{key:0,value:"Admin"},{activator:n(({props:C})=>[t(T,M(C,{"prepend-icon":"mdi:mdi-security",title:"Admin"}),null,16)]),default:n(()=>[S.value||y.value?(V(),_(s,{key:0,to:"/admin/conventions"},{default:n(()=>[t(T,{"prepend-icon":"mdi:mdi-domain",title:"Conventions",value:"Conventions"})]),_:1})):L("",!0),f.value?(V(),_(s,{key:1,to:"/admin/organisations"},{default:n(()=>[t(T,{"prepend-icon":"mdi:mdi-store",title:"Organisations",value:"Organisations"})]),_:1})):L("",!0),k.value?(V(),_(s,{key:2,to:"/admin/groups"},{default:n(()=>[t(T,{"prepend-icon":"mdi:mdi-key-chain-variant",title:"Permissions",value:"Permissions"})]),_:1})):L("",!0)]),_:1})):L("",!0),t(s,{to:{name:"Profile"}},{default:n(()=>[t(T,{"prepend-icon":"mdi:mdi-account-circle",title:"Manage Account"})]),_:1}),t(T,{"prepend-icon":"mdi:mdi-theme-light-dark",onClick:v,title:`${c.value=="light"?"Dark":"Light"} Mode`},null,8,["title"]),t(s,{to:"/logout"},{default:n(()=>[t(T,{"prepend-icon":"mdi:mdi-logout",title:"Logout",value:"Logout"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ie,null,{default:n(()=>[t(P,{onPageTitle:h,"logged-in":!0})]),_:1})]),_:1})}}}),ra=ee(na,[["__scopeId","data-v-58209c7d"]]),ua="/assets/scotiacon-logo-DsrTQlsL.svg",ia=G({__name:"LoginLayout",setup(e){return(r,l)=>{const u=H("RouterView");return V(),pe(he,null,[t(q,{class:"logo-container text-center"},{default:n(()=>[t(ue,{src:A(ua),class:"scotiacon-logo ma-auto"},null,8,["src"]),l[0]||(l[0]=$("h1",null,"Scotiacon Registration System",-1))]),_:1}),t(q,{class:"login-container text-center mb-0 rounded rounded-lg mb-md-10"},{default:n(()=>[t(je,null,{default:n(()=>[t(le,{class:"ma-2",color:"indigo",icon:"mdi:mdi-lock-outline"})]),_:1}),$("h2",null,X(A(Qe).headingSignIn),1),t(u,{"logged-in":!1})]),_:1})],64)}}}),ca=ee(ia,[["__scopeId","data-v-5e348755"]]),da=R({...z(),...ne({fullHeight:!0}),...ae()},"VApp"),va=B()({name:"VApp",props:da(),setup(e,r){let{slots:l}=r;const u=te(e),{layoutClasses:i,getLayoutItem:a,items:o,layoutRef:d}=re(e),{rtlClasses:m}=ye();return U(()=>{var c;return t("div",{ref:d,class:["v-application",u.themeClasses.value,i.value,m.value,e.class],style:[e.style]},[t("div",{class:"v-application__wrap"},[(c=l.default)==null?void 0:c.call(l)])])}),{getLayoutItem:a,items:o,theme:u}}}),ma=R({app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...Ae(),...z(),...De(),...oe(),...xe(),...Oe({tag:"footer"}),...ae()},"VFooter"),fa=B()({name:"VFooter",props:ma(),setup(e,r){let{slots:l}=r;const u=p(),{themeClasses:i}=te(e),{backgroundColorClasses:a,backgroundColorStyles:o}=He(N(e,"color")),{borderClasses:d}=Me(e),{elevationClasses:m}=Ge(e),{roundedClasses:c}=ze(e),v=w(32),{resizeRef:h}=Fe(y=>{y.length&&(v.value=y[0].target.clientHeight)}),S=g(()=>e.height==="auto"?v.value:parseInt(e.height,10));return Q(()=>e.app,()=>{const y=se({id:e.name,order:g(()=>parseInt(e.order,10)),position:g(()=>"bottom"),layoutSize:S,elementSize:g(()=>e.height==="auto"?void 0:S.value),active:g(()=>e.app),absolute:N(e,"absolute")});W(()=>{u.value=y.layoutItemStyles.value})}),U(()=>t(e.tag,{ref:h,class:["v-footer",i.value,a.value,d.value,m.value,c.value,e.class],style:[o.value,e.app?u.value:{height:Ve(e.height)},e.style]},l)),{}}}),Aa=G({__name:"Default",emits:["pageTitle"],setup(e,{emit:r}){let l=Se();const u=ke.getInstance(),i=u.getTokenByService("GrazeAPI"),a=p(!1),o=p(!1),d=r,m=Z.getInstance();m.on("login",v=>{l=v,a.value=!0}),m.on("logout",()=>{l=void 0,a.value=!1}),m.on("tokenManager.tokenUpdated",()=>{a.value=!0,o.value=!0}),m.on("tokenManager.sessionExpired",()=>{a.value=!1,o.value=!1,O(),location.reload()}),i?l?i.AccessExpires<=Date.now()&&i.RefreshExpires>Date.now()?u.refreshToken(i):i.AccessExpires>Date.now()?(O(),a.value=!1,o.value=!0):(a.value=!0,o.value=!0):be().then(v=>{l=v,a.value=!0,o.value=!0}).catch(()=>{a.value=!1,o.value=!0}):(O(),a.value=!1,o.value=!0);const c=v=>{d("pageTitle",v)};return(v,h)=>(V(),_(_e,null,{default:n(()=>[t(va,{class:"bg-image"},{default:n(()=>[o.value?(V(),_(ie,{key:0},{default:n(()=>[a.value&&A(l)?(V(),_(ra,{key:0,user:A(l),onPageTitle:c},null,8,["user"])):(V(),_(ca,{key:1}))]),_:1})):L("",!0),t(fa,null,{default:n(()=>h[0]||(h[0]=[K(" Powered by Graze ")])),_:1})]),_:1})]),_:1}))}});export{Aa as default};
