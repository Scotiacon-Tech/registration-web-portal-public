import{i as x,r as p,q as g,v as r,P as T,N as C,n as a,f as m,B as s,x as t,F as i,D as o,y as k,A as v}from"./index-B6R-Aew_.js";import{l as D}from"./stripe.esm-C9RHaPzS.js";import{e as I,p as S,V as B}from"./VContainer-5F-xl_LL.js";import{V as P,a as b}from"./VRow-DudUHBc5.js";import{V as N}from"./VAlert-B77sdcoH.js";import"./createSimpleFunctional-COPlfcGM.js";const R={key:0},q={key:0},L=x({__name:"PaymentProcessingView",emits:["pageTitle"],setup(A,{emit:w}){const h=T(),V=C();w("pageTitle","Payment Processing");const c=p(),n=p(""),y=p(""),d=()=>{h.push({name:"Home"})};V.stripePublicKey().then(async l=>{l&&(c.value=await D(l),await f(c.value))});async function f(l){if(!l)return;const e=new URLSearchParams(window.location.search).get("payment_intent_client_secret");if(!e)return;const{paymentIntent:u}=await l.retrievePaymentIntent(e);y.value=(u==null?void 0:u.id)||"",n.value=(u==null?void 0:u.status)||"",n.value==="processing"&&setTimeout(()=>{f(l)},2e3)}return(l,e)=>(a(),g(I,null,{default:r(()=>[m(N,{closable:!0,"onClick:close":d},{title:r(()=>[n.value==""?(a(),s(i,{key:0},[t(" Retrieving Payment Status ")],64)):n.value=="succeeded"?(a(),s(i,{key:1},[t(" Payment Succeeded ")],64)):n.value=="processing"?(a(),s(i,{key:2},[t(" Payment Processing ")],64)):n.value=="requires_payment_method"?(a(),s(i,{key:3},[t(" Payment Failed ")],64)):(a(),s(i,{key:4},[t(" Payment Error ")],64))]),text:r(()=>[n.value==""?(a(),g(P,{key:0},{default:r(()=>[m(b,{class:"text-center"},{default:r(()=>[m(S,{color:"primary",indeterminate:"",size:175,width:12,class:"font-weight-bold my-4"},{default:r(()=>e[0]||(e[0]=[t(" Processing"),o("br",null,null,-1),t("Payment ")])),_:1})]),_:1})]),_:1})):n.value=="succeeded"?(a(),s(i,{key:1},[e[1]||(e[1]=o("p",{class:"my-4"},"Thank you for submitting your payment, you will receive an email shortly confirming receipt.",-1)),e[2]||(e[2]=o("p",{class:"my-4"},"The main dashboard will shortly update showing your payment.",-1))],64)):n.value=="processing"?(a(),s(i,{key:2},[e[3]||(e[3]=o("p",{class:"my-4"},"Thank you for submitting your payment, the payment is currently being processed.",-1)),e[4]||(e[4]=o("p",{class:"my-4"}," If the payment processing is successful the main dashboard will shortly update showing your payment. You will also receive an email confirming receipt. ",-1))],64)):n.value=="requires_payment_method"?(a(),s(i,{key:3},[e[6]||(e[6]=o("p",{class:"my-4"},"Thank you for submitting your payment, however the payment has failed.",-1)),e[7]||(e[7]=o("p",{class:"my-4"},[t(" Please try again and check your payment details, if the payment has been blocked you may need to contact your bank. If you continue to experience problems please email "),o("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),t(" for additional support and provide the ID below. ")],-1)),y.value?(a(),s("p",R,[e[5]||(e[5]=o("strong",null,"Payment ID:",-1)),t(" RPM-"+k(y.value),1)])):v("",!0)],64)):(a(),s(i,{key:4},[e[9]||(e[9]=o("p",{class:"my-4"},"Thank you for submitting your payment, however the payment has failed.",-1)),e[10]||(e[10]=o("p",{class:"my-4"},[t(" Please try again and check your payment details, if the payment has been blocked you may need to contact your bank. If you continue to experience problems please email "),o("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),t(" for additional support and provide the ID below. ")],-1)),y.value?(a(),s("p",q,[e[8]||(e[8]=o("strong",null,"Payment ID:",-1)),t(" GE-"+k(y.value),1)])):v("",!0)],64))]),default:r(()=>[m(P,null,{default:r(()=>[m(b,{class:"text-center"},{default:r(()=>[m(B,{onClick:d,variant:"flat",color:"success"},{default:r(()=>e[11]||(e[11]=[t("Okay")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{L as default};
