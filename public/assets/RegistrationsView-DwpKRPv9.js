import{i as xe,M as $e,N as We,r as P,n as A,D as z,q as H,v as m,H as ue,Q as Ne,f as s,x as se,y as ae,A as oe,E as Ca,P as Mt,G as le,F as x,a2 as Li,m as nr,k as Oa,w as Ge,Z as ma,c as Qt,O as ka,a3 as Fi,a4 as Ni,T as xi,R as rr,a5 as ji,b as or,z as Ot,o as ir,a6 as Yi,a7 as Bi,a8 as Hi,a9 as Gi,Y as Wi,a0 as qi,C as Fn,V as Qe,U as zi}from"./index-IGHK8Qq6.js";import{_ as Ji,D as Ki,a as Qi,b as Xi,c as Zi,d as el,e as tl,f as al,g as nl,h as rl,L as rn,M as on,U as ln,i as _t,A as dt,u as Xa,j as ol,P as il,k as Nn,l as me,m as ll,n as Me}from"./runner-Dc-mz71d.js";import{a as lr,b as sl}from"./FormRenderer.vue_vue_type_style_index_0_lang-erlXbi-H.js";import{F as Ce,a as ul}from"./form-Cqw16b_M.js";import{b as dl,c as sr,d as xn,S as cl}from"./submission-DAi9v6uc.js";import{C as ml}from"./canManageGlobalUsers-Cs-bWTln.js";import{_ as Ma}from"./ModelDialog.vue_vue_type_script_setup_true_lang-PbbOcdo8.js";import{a as ea,c as ur,V as sn,b as fl}from"./VList-BWTocK-a.js";import{V as ve,d as un,e as lt}from"./VContainer-DVyMZYok.js";import{V as dr,b as vl}from"./forwardRefs-UD7MkBSD.js";import{s as pl}from"./sortSubmissions-BLiX_qgz.js";import{u as yl}from"./useStoreAPI-RKpdRCqI.js";import{u as cr}from"./useModel-Do0SD5SC.js";import{a as mr,V as fr,d as $t,e as vr}from"./VTabs-DFWpad6C.js";import{u as gl,P as hl}from"./useDisplayTransactions-D106rFBm.js";import{C as pr,G as yr}from"./canDo-Cz1vMJNL.js";import{G as Va}from"./userData-BHcshso-.js";import{a as dn,V as cn,c as Pa,e as fa,d as Ul}from"./VCard-DysSp6rR.js";import{V as ge,a as B}from"./VRow-DKLm3-CI.js";import{_ as gr}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Za,a as Tl}from"./SaveButton.vue_vue_type_script_setup_true_lang-o_da8H1G.js";import{V as he}from"./VSelect-DldCXGiZ.js";import{_ as hr,a as en,u as bl}from"./useLinkedFields-BJVjJ2xW.js";import{V as _l,a as Sl}from"./VAlert-CdGa_2QL.js";import{V as da}from"./VCheckbox-C5WzD4mM.js";import{S as Dl}from"./setupLogin-U3uipI7t.js";import{V as Al,u as El}from"./debounce-NAsMJ1cW.js";import{b as Il}from"./sorted-PYsDa1V2.js";import{_ as wl}from"./SelectGroups.vue_vue_type_script_setup_true_lang-CQVwEnoj.js";import{_ as Cl}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-BqqK3gtm.js";import{v as St}from"./v4-CtRu48qb.js";import{u as Ol}from"./useAdvancedMode-BCHuQFGS.js";import{V as Ve}from"./VTextField--8gTq0jP.js";import{V as Ur,a as tn,b as an,c as nn}from"./VExpansionPanels-F7v-alt_.js";import{V as Tr}from"./VDialog-DHWHT_bI.js";import{c as kl}from"./copyToClipboard-BtcEYe2-.js";import{u as Rl}from"./useAvatar-DeqzoI6l.js";import{i as Ml}from"./index.esm-D-fKxIYi.js";import{V as Ea}from"./scopeId-SfFrtoCY.js";import{a as Vl}from"./VDataTable-B9l4cNlf.js";import{u as Pl}from"./useConventionSlug-D2aMVGI6.js";import{V as jn}from"./VSheet-BBey2emD.js";import{V as Yn,a as $l}from"./VToolbar-jW1ePQJ_.js";import"./date-DgbCHIwC.js";import"./canEditRegistrations-Ca4lAoBJ.js";import"./ticket-DqurB3v3.js";import"./targetType-BYfQr9gB.js";import"./Editor-DXExq_8_.js";import"./VAutocomplete-CC4yWXc4.js";import"./filter-BCebrfcB.js";import"./form-B9-UAC5v.js";import"./VChip-Dsp3EZed.js";import"./VDivider-iB9h9uO_.js";import"./VTextarea-BSnNJezW.js";import"./VForm-BFA4BECe.js";import"./VNavigationDrawer-DP86tU4u.js";import"./index-fwfMqYug.js";import"./VTooltip-CqjsnrGm.js";import"./VFileInput-Bgm4D7FR.js";import"./createSimpleFunctional-U7UJ07yh.js";import"./VToolbarItems-Dp4wPbVO.js";import"./VTable-QIuEyEQp.js";const Ll=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Fl(a){return typeof a=="string"&&Ll.test(a)}const Nl=()=>({ID:0,UserUUID:"",DisplayName:"",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]}),xl=xe({__name:"DataTableItemPanel",props:$e({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:$e(["openActions","showForm"],["update:modelValue"]),setup(a,{emit:o}){const n=Ca.getInstance(),l=o,c=We(a,"modelValue"),p=P(),y=Mt(),u=P(),d=P(!1),f=C=>{const $={AdminLayoutUUID:C.AdminLayoutUUID,Limit:1,RegistrationUUID:c.value.RegistrationUUID};y.searchConventionRegistrations(c.value.ConventionUUID,$).then(M=>{M&&M.Total>0&&(p.value=M.Registrations[0],u.value=C,d.value=!0)})},g=C=>{l("openActions",C)},D=(C,$,M)=>{l("showForm",C,$,M)};return n.on("checkin-saved",()=>{d.value=!1}),(C,$)=>(A(),z("div",null,[C.layouts?(A(),H(sn,{key:0},{default:m(()=>[(A(!0),z(ue,null,Ne(C.layouts,M=>(A(),H(ea,{key:M.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:m(()=>[s(ur,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:m(()=>[s(ve,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:j=>f(M)},{default:m(()=>[se(ae(M.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):oe("",!0),d.value&&u.value&&p.value?(A(),H(Ma,{key:1,modelValue:d.value,"onUpdate:modelValue":$[2]||($[2]=M=>d.value=M),"hide-extension":!0,fullscreen:!0,title:`#${p.value.Reference} ${p.value.User.DisplayName} - ${u.value.Name} `,scrollable:!0,"card-class":"pa-0"},{default:m(()=>[s(Ji,{accommodations:C.accommodations,convention:C.convention,extras:C.extras,forms:C.forms,interests:C.interests,tickets:C.tickets,venues:C.venues,layout:u.value,"onUpdate:layout":$[0]||($[0]=M=>u.value=M),modelValue:p.value,"onUpdate:modelValue":$[1]||($[1]=M=>p.value=M),onOpenActions:g,onShowForm:D},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):oe("",!0)]))}}),jl={class:"text-grey-lighten-1"},Yl={key:0,class:"mb-2"},Bl={key:1,class:"mb-2"},Hl={key:0,class:"text-blue text-center"},Gl={key:1,class:"text-red text-center"},Wl={key:2,class:"text-orange text-center"},ql={key:3,class:"text-orange text-center"},zl={key:4,class:"text-orange text-center"},Jl={key:5,class:"text-orange text-center"},Kl={key:6,class:"text-green text-center"},Ql={key:0},Xl={key:0},Zl=xe({__name:"RegListRow",props:$e({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:$e(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(a,{emit:o}){const n=o,l=We(a,"modelValue"),c=(u,d)=>{n("showForm",{registration:u,form:d})},p=u=>{n("openActions",u)},y=u=>{n("switchUser",u)};return(u,d)=>u.header.type==="ACCOMMODATION"&&u.accommodations.length>0&&u.item.raw[u.header.key]?(A(),H(Ki,{key:0,value:u.item.raw[u.header.key].Data,accommodations:u.accommodations,convention:u.convention,forms:u.forms,tickets:u.tickets,venues:u.venues,registration:u.item.raw[u.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):u.header.type==="EXTRAS"&&u.extras.length>0?(A(),H(Qi,{key:1,value:u.item.raw[u.header.key],extras:u.extras},null,8,["value","extras"])):u.header.type==="INTERESTS"&&u.interests.length>0?(A(),H(Xi,{key:2,value:u.item.raw[u.header.key],interests:u.interests},null,8,["value","interests"])):u.header.type==="TICKET"&&u.tickets.length>0?(A(),H(Zi,{key:3,value:u.item.raw[u.header.key],tickets:u.tickets},null,8,["value","tickets"])):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(A(),H(el,{key:4,convention:u.convention,"show-controls":!1,modelValue:u.item.raw.registration,"onUpdate:modelValue":d[0]||(d[0]=f=>u.item.raw.registration=f)},null,8,["convention","modelValue"])):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADDITIONAL_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(A(),z(ue,{key:5},[le("ul",null,[(A(!0),z(ue,null,Ne(u.forms.filter(f=>f.Type===x(Ce).FORM_TYPE_ADMIN&&u.item.raw[u.header.key].findIndex(g=>g.Form.ID===f.ID)<0),f=>(A(),z("li",{key:f.Heading},[le("strong",jl,ae(f.Heading),1),s(ve,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:g=>c(u.item.raw.registration,f)},null,8,["onClick"])]))),128))]),le("ul",null,[(A(!0),z(ue,null,Ne(u.item.raw[u.header.key],f=>(A(),z("li",{key:f.Heading},[le("strong",null,[se(ae(f.Heading),1),f.Form.Type!==x(Ce).FORM_TYPE_ADMIN?(A(),z(ue,{key:0},[se(": ")],64)):oe("",!0)]),f.Form.Type!==x(Ce).FORM_TYPE_ADMIN?(A(),z("span",{key:0,class:Li(x(dl)(f.Submission.Status))},ae(x(sr)(f.Submission.Status)),3)):oe("",!0),s(ve,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:g=>c(f.Registration,f.Form)},null,8,["onClick"])]))),128))])],64)):u.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(A(),H(dr,{key:6,class:"rounded-circle",src:u.item.raw[u.header.key],height:"32",width:"32"},null,8,["src"])):u.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_CONTACTS"?(A(),z(ue,{key:7},[u.item.raw[u.header.key].email?(A(),z("p",Yl,[d[4]||(d[4]=le("strong",null,"Email",-1)),d[5]||(d[5]=le("br",null,null,-1)),se(ae(u.item.raw[u.header.key].email),1)])):oe("",!0),u.item.raw[u.header.key].telegram?(A(),z("p",Bl,[d[6]||(d[6]=le("strong",null,"Telegram",-1)),d[7]||(d[7]=le("br",null,null,-1)),se(ae(u.item.raw[u.header.key].telegram),1)])):oe("",!0)],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(A(),z(ue,{key:8},[u.item.raw[u.header.key]=="NOT_REQUIRED"?(A(),z("div",Hl,"No Payment Requested")):u.item.raw[u.header.key]=="MISSING_REQUIRED"?(A(),z("div",Gl,"Partner Payment Not Requested")):u.item.raw[u.header.key]=="AWAITING_PARTNER"?(A(),z("div",Wl,"Awaiting Partner Payment")):u.item.raw[u.header.key]=="ALL_REQUIRED"?(A(),z("div",ql,"Awaiting Payments")):u.item.raw[u.header.key]=="REQUIRED"?(A(),z("div",zl,"Awaiting Payment")):u.item.raw[u.header.key]=="ADDITIONAL_REQUIRED"?(A(),z("div",Jl,"Awaiting Additional Payments")):(A(),z("div",Kl,"Completed"))],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(A(),z(ue,{key:9},[s(ve,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:d[1]||(d[1]=f=>p(u.item.raw[u.header.key]))}),x(ml)(u.user)?(A(),H(ve,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:d[2]||(d[2]=f=>y(u.item.raw[u.header.key]))})):oe("",!0)],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(A(),z(ue,{key:10},[u.item.raw[u.header.key].length===1?(A(),z("em",Ql," Not in a group ")):(A(),z(ue,{key:1},[le("ul",null,[(A(!0),z(ue,null,Ne(u.item.raw[u.header.key],f=>(A(),z("li",{key:f.UUID,class:"ml-0"},[se(" #"+ae(f.Reference)+" : "+ae(f.Name)+" ",1),f.IsLeader?(A(),z("strong",Xl,"(Leader)")):oe("",!0)]))),128))]),d[8]||(d[8]=le("strong",null,"Total:",-1)),se(" "+ae(u.item.raw[u.header.key].length),1)],64))],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(A(),z(ue,{key:11},[l.value.registration?(A(),H(xl,{key:0,accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,tickets:u.tickets,venues:u.venues,layouts:u.item.raw[u.header.key].Layouts,modelValue:l.value.registration,"onUpdate:modelValue":d[3]||(d[3]=f=>l.value.registration=f),onOpenActions:p,onShowForm:c},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):oe("",!0)],64)):(A(),z(ue,{key:12},[se(ae(u.item.raw[u.header.key]),1)],64))}}),Bn=xe({__name:"RegistrationActionTabs",props:$e({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=a,n=We(a,"modelValue");return(l,c)=>(A(),H(mr,nr({modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=p=>n.value=p)},o),{default:m(()=>[(A(!0),z(ue,null,Ne(l.tabs,p=>(A(),H(fr,{value:p.value,key:p.value},{default:m(()=>[se(ae(p.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),es=(a=void 0,o)=>a===void 0?!1:pr(a,yr.GROUP_TYPE_CONVENTION,o.ConventionUUID,o).EditPaymentTransactions,ts={class:"mb-4"},as={class:"v-row"},ns={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},rs={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},os={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},is={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},ls={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},ss={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},us={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},ds={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},cs=xe({__name:"PaymentActions",props:$e({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=P(!1),n=P(),l=P([]),c=P(new Date().getTime()),p=P(!1),y=We(a,"modelValue"),u=P(Oa(y.value));Ge(y,()=>{u.value=Oa(y.value)});const d=Mt();d.getConvention(y.value.ConventionUUID).then(C=>{C&&(p.value=es(Va(),C))});const f=()=>{d.generateRegistrationCharges(y.value.RegistrationUUID,!1).then(C=>{C&&(l.value=C.PaymentTransactions,n.value=C.Registration,c.value=new Date().getTime())}).catch(()=>{})};f();const g=()=>{d.generateRegistrationCharges(y.value.RegistrationUUID,!0).then(C=>{C&&(l.value=C.PaymentTransactions,n.value=C.Registration,c.value=new Date().getTime())})},{totalCharges:D}=gl();return(C,$)=>(A(),H(fa,null,{default:m(()=>[s(cn,null,{default:m(()=>[s(dn,null,{default:m(()=>[se(" Payments (#"+ae(y.value.Reference)+" "+ae(y.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),s(Pa,null,{default:m(()=>[n.value?(A(),z(ue,{key:0},[le("h3",ts,"#"+ae(n.value.Reference)+" "+ae(n.value.User.DisplayName),1),le("dl",as,[(A(!0),z(ue,null,Ne(l.value,M=>(A(),z(ue,{key:M.PaymentTransactionUUID},[M.Type===x(hl).PAYMENT_TRANSACTION_TYPE_CHARGE?(A(),z("dt",ns,[le("div",rs,ae(M.Description.split(":")[0])+": ",1),le("div",os,ae(M.Description.split(":")[1]),1)])):oe("",!0),le("dd",is," £"+ae(M.Amount),1)],64))),128)),$[2]||($[2]=le("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),le("dd",ls," £"+ae(x(D)(l.value)),1),$[3]||($[3]=le("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),le("dd",ss," £"+ae(n.value.Total),1),$[4]||($[4]=le("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),le("dd",us," £"+ae(n.value.Paid),1),$[5]||($[5]=le("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),le("dd",ds," £"+ae(n.value.Total-n.value.Paid),1)]),s(ge,{class:"flex-row-reverse"},{default:m(()=>[s(B,{class:"text-right"},{default:m(()=>[s(ve,{color:"primary",onClick:g},{default:m(()=>$[6]||($[6]=[se("Apply Charges")])),_:1})]),_:1}),!o.value&&p.value?(A(),H(B,{key:0},{default:m(()=>[s(ve,{color:"secondary",onClick:$[0]||($[0]=M=>o.value=!0)},{default:m(()=>$[7]||($[7]=[se("Transaction Entry")])),_:1})]),_:1})):oe("",!0)]),_:1})],64)):oe("",!0),s(tl,{"can-edit":p.value,registration:y.value,"show-editor":o.value,onCloseEditor:$[1]||($[1]=M=>o.value=!1),updated:c.value,onChange:f},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),ms=gr(cs,[["__scopeId","data-v-861debd5"]]),fs=xe({__name:"RegistrationFormStatus",props:$e({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=Mt(),n=We(a,"modelValue"),l=(c,p)=>{const y=n.value.Submissions.find(u=>u.SubmissionUUID==p);if(!y){c&&c("Submission not found");return}o.setSubmissionStatus(p,y.Status).then(u=>{u?(n.value.Submissions.forEach((d,f)=>{n.value.Submissions[f].Status=d.Status}),c&&c("Status Saved")):c&&c("Status not saved")}).catch(()=>{c&&c("Status not saved")})};return(c,p)=>(A(),H(fa,null,{default:m(()=>[s(cn,null,{default:m(()=>[s(dn,null,{default:m(()=>[se("Status (#"+ae(n.value.Reference)+" "+ae(n.value.User.DisplayName)+")",1)]),_:1})]),_:1}),s(Pa,null,{default:m(()=>[s(sn,null,{default:m(()=>[(A(!0),z(ue,null,Ne(n.value.Submissions,y=>(A(),H(ea,{key:y.SubmissionUUID,class:"pa-0"},{default:m(()=>[s(ge,{class:"py-2 align-center"},{default:m(()=>[s(B,{cols:"9",sm:"10",md:"10",lg:"9"},{default:m(()=>{var u;return[s(he,{modelValue:y.Status,"onUpdate:modelValue":d=>y.Status=d,items:x(xn),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((u=c.forms.find(d=>d.FormUUID==y.FormUUID))==null?void 0:u.Name)||""},{selection:m(()=>[s(un,{class:"mr-4 d-none d-sm-inline"},{default:m(()=>{var d;return[se(ae((d=x(xn).find(f=>f.value===y.Status))==null?void 0:d.icon),1)]}),_:2},1024),se(" "+ae(x(sr)(y.Status)),1)]),item:m(({item:d,props:{onClick:f}})=>[s(ea,{title:d.title,"prepend-icon":d.raw.icon,onClick:f},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),s(B,{cols:"3",sm:"2",md:"2",lg:"1"},{default:m(()=>[s(Za,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:u=>l(u.callback,y.SubmissionUUID)},null,8,["onClick"]),s(Za,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:u=>l(u.callback,y.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),vs={class:"mb-4"},ps=xe({__name:"RegistrationTags",props:$e({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=Mt(),n=We(a,"modelValue"),l=P(Oa(n.value)),c=P(!1),p=P(l.value.Tags);Ge(n,()=>{l.value=Oa(n.value)});const y=({callback:u})=>{const d=[],f=[];l.value.Tags.forEach(g=>{p.value.find(C=>C.TagUUID===g.TagUUID)||d.push(g.TagUUID)}),p.value.forEach(g=>{l.value.Tags.find(C=>g.TagUUID===C.TagUUID)||f.push(g.TagUUID)}),o.updateRegistrationTags(d,f,l.value.RegistrationUUID).then(g=>{g?u&&(u("Tags Saved"),n.value.Tags=g.Tags):u&&u("Error Saving Tags")}).catch(()=>{u&&u("Error Saving Tags")})};return(u,d)=>(A(),H(fa,null,{default:m(()=>[s(cn,null,{default:m(()=>[s(dn,null,{default:m(()=>[se("Tags (#"+ae(l.value.Reference)+" "+ae(l.value.User.DisplayName)+")",1)]),_:1})]),_:1}),s(Pa,null,{default:m(()=>[s(_l,{class:"my-4"},{default:m(()=>[s(Sl,null,{default:m(()=>d[2]||(d[2]=[se("Caution")])),_:1}),d[3]||(d[3]=le("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1))]),_:1}),le("h3",vs,"#"+ae(l.value.Reference)+" "+ae(l.value.User.DisplayName),1),s(hr,{modelValue:l.value.Tags,"onUpdate:modelValue":d[0]||(d[0]=f=>l.value.Tags=f),convention:l.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":c.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),s(Ul,{class:"px-4 align-start"},{default:m(()=>[s(da,{label:"Show UUID",modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=f=>c.value=f)},null,8,["modelValue"]),s(Za,{onClick:y,variant:"flat"})]),_:1})]),_:1}))}}),ys=gr(ps,[["__scopeId","data-v-a4024c39"]]),Hn=xe({__name:"RegistrationActionWindows",props:$e({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:$e(["update:registration"],["update:modelValue"]),setup(a,{emit:o}){const n=a,l=We(a,"modelValue"),p=cr(n,o,void 0,void 0,"registration");return(y,u)=>(A(),H(vr,{modelValue:l.value,"onUpdate:modelValue":u[3]||(u[3]=d=>l.value=d),disabled:!0,touch:!1},{default:m(()=>[s($t,{value:"badges"},{default:m(()=>[l.value=="badges"?(A(),H(lt,{key:0,class:"pa-0 mx-0",fluid:!0},{default:m(()=>[s(al,{convention:y.convention,registration:x(p)},null,8,["convention","registration"])]),_:1})):oe("",!0)]),_:1}),s($t,{value:"emails"},{default:m(()=>[l.value=="emails"?(A(),H(lt,{key:0,class:"pa-0 mx-0",fluid:!0},{default:m(()=>[s(nl,{registration:x(p)},null,8,["registration"])]),_:1})):oe("",!0)]),_:1}),s($t,{value:"notes"},{default:m(()=>[l.value=="notes"?(A(),H(lt,{key:0,class:"pa-0 mx-0",fluid:!0},{default:m(()=>[s(rl,{convention:y.convention,expanded:!1,registration:x(p)},null,8,["convention","registration"])]),_:1})):oe("",!0)]),_:1}),s($t,{value:"payments"},{default:m(()=>[l.value=="payments"?(A(),H(lt,{key:0,class:"pa-0 mx-0",fluid:!0},{default:m(()=>[s(ms,{modelValue:x(p),"onUpdate:modelValue":u[0]||(u[0]=d=>ma(p)?p.value=d:null),forms:y.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):oe("",!0)]),_:1}),s($t,{value:"status"},{default:m(()=>[l.value=="status"?(A(),H(lt,{key:0,class:"pa-0 mx-0",fluid:!0},{default:m(()=>[s(fs,{modelValue:x(p),"onUpdate:modelValue":u[1]||(u[1]=d=>ma(p)?p.value=d:null),forms:y.forms},null,8,["modelValue","forms"])]),_:1})):oe("",!0)]),_:1}),s($t,{value:"tags"},{default:m(()=>[l.value=="tags"?(A(),H(lt,{key:0,class:"pa-0 mx-0",fluid:!0},{default:m(()=>[s(ys,{modelValue:x(p),"onUpdate:modelValue":u[2]||(u[2]=d=>ma(p)?p.value=d:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):oe("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),gs=(a,o)=>a===void 0?!1:pr(a,yr.GROUP_TYPE_CONVENTION,o.ConventionUUID,o).ViewPaymentTransactions,hs={key:0},Us={key:1},Gn=xe({__name:"RegistrationActions",props:$e({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:$e(["update:registration"],["update:modelValue"]),setup(a,{emit:o}){const n=a,l=We(a,"modelValue"),p=cr(n,o,void 0,void 0,"registration"),y=P("notes"),u=Va(),d=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return gs(u,n.convention)&&d.splice(2,0,{label:"Payments",value:"payments"}),(f,g)=>f.useDialog?(A(),z("div",hs,[s(Ma,{modelValue:l.value,"onUpdate:modelValue":g[3]||(g[3]=D=>l.value=D),title:f.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:m(()=>[s(Bn,{modelValue:y.value,"onUpdate:modelValue":g[0]||(g[0]=D=>y.value=D),tabs:d,"show-arrows":!0},null,8,["modelValue"])]),default:m(()=>[s(Hn,{modelValue:y.value,"onUpdate:modelValue":g[1]||(g[1]=D=>y.value=D),registration:x(p),"onUpdate:registration":g[2]||(g[2]=D=>ma(p)?p.value=D:null),accommodations:f.accommodations,convention:f.convention,extras:f.extras,forms:f.forms,interests:f.interests,tabs:d,tickets:f.tickets,venues:f.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(A(),z("div",Us,[s(Bn,{modelValue:y.value,"onUpdate:modelValue":g[4]||(g[4]=D=>y.value=D),tabs:d,"show-arrows":!0},null,8,["modelValue"]),s(Hn,{modelValue:y.value,"onUpdate:modelValue":g[5]||(g[5]=D=>y.value=D),registration:x(p),"onUpdate:registration":g[6]||(g[6]=D=>ma(p)?p.value=D:null),accommodations:f.accommodations,convention:f.convention,extras:f.extras,forms:f.forms,interests:f.interests,tabs:d,tickets:f.tickets,venues:f.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),br=(a,o)=>{a.forEach(n=>{n.Items.forEach(l=>{(l.SectionField==null||l.SectionField.Field==null)&&o.find(c=>{c.Sections.find(p=>{if(p.Fields){const y=p.Fields.find(u=>u.SectionFieldUUID===l.SectionFieldUUID);if(y)return l.SectionField=y,!0}})})})})},Ts={base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"},bs={base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"},_s={base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"},Ss={base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"},Ds={base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"},As={base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"},Es={base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"},Is={base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"},ws={base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"},Cs={base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"},Os={base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"},ks={base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"},Rs={base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"},Ms={base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"},Vs={base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"},Ps={base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"},$s={base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"},Ls={base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"},Fs={base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"},Ns={black:"#000000",white:"#ffffff",transparent:"#ffffff00"},xs={red:Ts,pink:bs,purple:_s,deepPurple:Ss,indigo:Ds,blue:As,lightBlue:Es,cyan:Is,teal:ws,green:Cs,lightGreen:Os,lime:ks,yellow:Rs,amber:Ms,orange:Vs,deepOrange:Ps,brown:$s,blueGrey:Ls,grey:Fs,shades:Ns},js=xe({__name:"EditAdminLayoutSearch",props:$e({formOptions:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=a,n=We(a,"modelValue");n.value.Search||(n.value.Search=[]);const l=P(o.formOptions),c=()=>{n.value.Search.push({ID:0,LayoutItemUUID:St(),LayoutPanelID:n.value.AdminLayoutID,LayoutPanelUUID:n.value.AdminLayoutUUID,Label:"",SourceType:_t.LAYOUT_ITEM_SOURCE_FORM,Align:"",Order:n.value.Search.length,DefaultSort:!1,Meta:{}})},p=u=>{const d=n.value.Search.findIndex(f=>f.LayoutItemUUID===u.LayoutItemUUID);d!=-1&&n.value.Search.splice(d,1)},y=u=>{const d=l.value.find(f=>f.value===u.SectionFieldUUID);d&&(u.SectionFieldID=d.object.ID,u.SectionField=d.object)};return(u,d)=>(A(),z(ue,null,[(A(!0),z(ue,null,Ne(n.value.Search,f=>(A(),H(ge,{key:f.LayoutItemUUID},{default:m(()=>[s(B,{cols:"12",sm:"6"},{default:m(()=>[s(he,{modelValue:f.SourceType,"onUpdate:modelValue":g=>f.SourceType=g,label:"Source Type",items:x(rn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,null,{default:m(()=>[f.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(A(),H(he,{key:0,modelValue:f.SectionFieldUUID,"onUpdate:modelValue":g=>f.SectionFieldUUID=g,label:"Form Data",items:l.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:g=>y(f)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):f.SourceType==="LAYOUT_ITEM_SOURCE_META"?(A(),H(he,{key:1,modelValue:f.MetaField,"onUpdate:modelValue":g=>f.MetaField=g,label:"Miscellaneous Data",items:x(on),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):f.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(A(),H(he,{key:2,modelValue:f.UserField,"onUpdate:modelValue":g=>f.UserField=g,label:"User Profile Data",items:x(ln),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):oe("",!0)]),_:2},1024),s(B,null,{default:m(()=>[s(ve,{icon:"mdi:mdi-delete",onClick:g=>p(f)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),s(ve,{onClick:c,color:"primary"},{default:m(()=>d[0]||(d[0]=[se(" Add Search Item ")])),_:1})],64))}}),Ys=xe({__name:"EditAdminLayoutFilter",props:$e({formOptions:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=a,n=We(a,"modelValue");n.value.Filter||(n.value.Filter=[]);const l=P(o.formOptions),c=()=>{n.value.Filter.push({ID:0,LayoutItemUUID:St(),LayoutPanelID:n.value.AdminLayoutID,LayoutPanelUUID:n.value.AdminLayoutUUID,Label:"",SourceType:_t.LAYOUT_ITEM_SOURCE_FORM,Align:"",Order:n.value.Filter.length,DefaultSort:!1,Meta:{}})},p=u=>{const d=n.value.Filter.findIndex(f=>f.LayoutItemUUID===u.LayoutItemUUID);d!=-1&&n.value.Filter.splice(d,1)},y=u=>{const d=l.value.find(f=>f.value===u.SectionFieldUUID);d&&(u.SectionFieldID=d.object.ID,u.SectionField=d.object)};return(u,d)=>(A(),z(ue,null,[(A(!0),z(ue,null,Ne(n.value.Filter,f=>(A(),H(ge,{key:f.LayoutItemUUID},{default:m(()=>[s(B,{cols:"12",sm:"6"},{default:m(()=>[s(he,{modelValue:f.SourceType,"onUpdate:modelValue":g=>f.SourceType=g,label:"Source Type",items:x(rn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,null,{default:m(()=>[f.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(A(),H(he,{key:0,modelValue:f.SectionFieldUUID,"onUpdate:modelValue":g=>f.SectionFieldUUID=g,label:"Form Data",items:l.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:g=>y(f)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):f.SourceType==="LAYOUT_ITEM_SOURCE_META"?(A(),H(he,{key:1,modelValue:f.MetaField,"onUpdate:modelValue":g=>f.MetaField=g,label:"Miscellaneous Data",items:x(on),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):f.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(A(),H(he,{key:2,modelValue:f.UserField,"onUpdate:modelValue":g=>f.UserField=g,label:"User Profile Data",items:x(ln),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):oe("",!0)]),_:2},1024),s(B,null,{default:m(()=>[s(ve,{icon:"mdi:mdi-delete",onClick:g=>p(f)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),s(ve,{onClick:c,color:"primary"},{default:m(()=>d[0]||(d[0]=[se(" Add Filter Item ")])),_:1})],64))}}),Bs={key:0,class:"text-warning text-right pl-1"},Hs=xe({__name:"EditAdminLayout",props:$e({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:$e(["change","delete"],["update:modelValue"]),setup(a,{emit:o}){const n=Ol(),l=We(a,"modelValue"),c=P([]),p=Mt(),y=o,u=P(Object.assign({},...a.layouts.map(q=>q.Panels.map(G=>G.Items.map(k=>{if(!k.Meta)return{};const Y={};return Object.entries(k.Meta).forEach(b=>{Array.isArray(b[1])?(Y[`${k.LayoutItemUUID}.${b[0]}`]=[],b[1].forEach(ce=>{Y[`${k.LayoutItemUUID}.${b[0]}`].push(ce.toString())})):b[1]!==void 0&&b[1]!==null&&(Y[`${k.LayoutItemUUID}.${b[0]}`]=[b[1].toString()])}),Y}))).flat(2))),d=P(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),f=P(!1),g=P([]);p.getConventionTags(a.convention.ConventionUUID).then(q=>{q&&(g.value=q)}).catch(()=>{});const D=()=>({ID:0,LayoutPanelUUID:St(),AdminLayoutID:l.value.ID,AdminLayoutUUID:l.value.AdminLayoutUUID,Name:"",Order:l.value.Panels.length+1,Items:[],Search:[],Filter:[],PanelStyle:Nn.PANEL_STYLE_FLEX,RequiredFormType:Ce.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),C=q=>()=>({ID:0,LayoutItemUUID:St(),LayoutPanelID:q.ID,LayoutPanelUUID:q.LayoutPanelUUID,Label:"",SourceType:_t.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:q.Items.length+1,DefaultSort:!1,Meta:{}}),$=(q,G)=>{q.Meta[G]=u.value[`${q.LayoutItemUUID}.${G}`]},M=q=>{const G=c.value.find(k=>k.value===q.SectionFieldUUID);G&&(q.SectionFieldID=G.object.ID,q.SectionField=G.object)};p.getConventionForms(l.value.ConventionUUID).then(q=>{q&&(q.forEach(G=>G.Sections.forEach(k=>k.Fields&&c.value.push(...k.Fields.map(Y=>{var ce;return{title:`${G.Name} - ${k.Name} - ${(ce=Y.Field)==null?void 0:ce.Name}`,value:Y.SectionFieldUUID,object:Y}})))),c.value.sort(Il("title")),br(l.value.Panels,q))});const j=Qt(()=>{switch(l.value.Type){case dt.ADMIN_LAYOUT_PANELS:return"Panels";case dt.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});Ge(l,()=>{y("change")},{deep:!0});const Q=Qt(()=>{const q=/([a-zA-Z]+)(\d+)/;return Object.entries(xs).map(([G,k])=>Object.entries(k).map(([Y,b])=>{const ce=q.exec(Y);return!ce||ce.length<3?void 0:{Title:`${Xa(G).split(/(?=[A-Z])/).join(" ")} ${Xa(ce[1])} ${Xa(ce[2])}`,CSSName:`${G}-${ce[1]}-${ce[2]}`,Value:b}})).flat().filter(G=>!!G).sort((G,k)=>G.Title>k.Title?1:G.Title==k.Title?0:-1)});return(q,G)=>(A(),H(lt,{class:"px-0 mx-0",fluid:!0},{default:m(()=>[s(ge,null,{default:m(()=>[s(B,{cols:"12",sm:"6"},{default:m(()=>[s(Ve,{modelValue:l.value.Name,"onUpdate:modelValue":G[0]||(G[0]=k=>l.value.Name=k),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),s(B,{cols:"12",sm:"6"},{default:m(()=>[s(he,{modelValue:l.value.Type,"onUpdate:modelValue":G[1]||(G[1]=k=>l.value.Type=k),label:"Layout Type",items:x(ol),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),l.value.Type==x(dt).ADMIN_LAYOUT_PANELS?(A(),H(B,{key:0,cols:"12",sm:"6"},{default:m(()=>[s(he,{modelValue:l.value.RunnerLayoutUUID,"onUpdate:modelValue":G[2]||(G[2]=k=>l.value.RunnerLayoutUUID=k),clearable:!0,items:q.layouts.filter(k=>k.Type===x(dt).ADMIN_LAYOUT_PANELS)||[],multiple:!1,label:"Runner Display (Optional)","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})):oe("",!0)]),_:1}),s(ge,null,{default:m(()=>[s(B,null,{default:m(()=>[s(en,{modelValue:l.value.Panels,"onUpdate:modelValue":G[3]||(G[3]=k=>l.value.Panels=k),"new-item":D,closeable:!1,title:j.value,label:"Name","slot-name-prefix":"panel"},ka({_:2},[Ne(l.value.Panels,(k,Y)=>({name:`panel_${Y}`,fn:m(()=>[s(lt,{class:"px-0 mx-0",fluid:!0},{default:m(()=>[s(ge,null,{default:m(()=>[s(B,{cols:"12",sm:"6"},{default:m(()=>[s(Ve,{modelValue:k.Name,"onUpdate:modelValue":b=>k.Name=b,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l.value.Type===x(dt).ADMIN_LAYOUT_PANELS?(A(),H(B,{key:0,cols:"12",sm:"6"},{default:m(()=>[s(he,{modelValue:k.PanelStyle,"onUpdate:modelValue":b=>k.PanelStyle=b,items:x(il),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):oe("",!0),s(B,{cols:"12",sm:"6"},{default:m(()=>[s(he,{modelValue:k.RequiredFormType,"onUpdate:modelValue":b=>k.RequiredFormType=b,items:x(ul),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,{cols:"12",sm:"6"},{default:m(()=>[s(wl,{label:"Required Groups",variant:"outlined",modelValue:k.RequiredGroupMemberships,"onUpdate:modelValue":b=>k.RequiredGroupMemberships=b,convention:l.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),s(B,{cols:"12",sm:"6"},{default:m(()=>[s(hr,{label:"Registration Tags",variant:"outlined",modelValue:k.RequiredRegistrationTags,"onUpdate:modelValue":b=>k.RequiredRegistrationTags=b,convention:l.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),x(n)?(A(),H(ge,{key:0},{default:m(()=>[s(B,null,{default:m(()=>[s(Ur,{variant:"accordion"},{default:m(()=>[s(tn,null,{default:m(()=>[s(an,null,{default:m(()=>G[7]||(G[7]=[se(" Filters ")])),_:1}),s(nn,null,{default:m(()=>[G[8]||(G[8]=le("p",null," Fixed search settings to pre-filter results by ",-1)),s(Ys,{modelValue:l.value.Panels[Y],"onUpdate:modelValue":b=>l.value.Panels[Y]=b,"form-options":c.value},null,8,["modelValue","onUpdate:modelValue","form-options"])]),_:2},1024)]),_:2},1024),s(tn,null,{default:m(()=>[s(an,null,{default:m(()=>G[9]||(G[9]=[se(" Search Options ")])),_:1}),s(nn,null,{default:m(()=>[G[10]||(G[10]=le("p",null," Dynamic search options ",-1)),s(js,{modelValue:l.value.Panels[Y],"onUpdate:modelValue":b=>l.value.Panels[Y]=b,"form-options":c.value},null,8,["modelValue","onUpdate:modelValue","form-options"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):oe("",!0),l.value.Type===x(dt).ADMIN_LAYOUT_PANELS&&k.PanelStyle===x(Nn).PANEL_STYLE_FLEX?(A(),H(ge,{key:1},{default:m(()=>[s(B,{cols:"12",class:"py-0 my-0"},{default:m(()=>G[11]||(G[11]=[le("h4",null,"Grid Size (Max 12)",-1)])),_:1}),s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(Ve,{modelValue:k.Meta.cols,"onUpdate:modelValue":b=>k.Meta.cols=b,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(Ve,{modelValue:k.Meta.cols_xs,"onUpdate:modelValue":b=>k.Meta.cols_xs=b,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(Ve,{modelValue:k.Meta.cols_sm,"onUpdate:modelValue":b=>k.Meta.cols_sm=b,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(Ve,{modelValue:k.Meta.cols_md,"onUpdate:modelValue":b=>k.Meta.cols_md=b,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(Ve,{modelValue:k.Meta.cols_lg,"onUpdate:modelValue":b=>k.Meta.cols_lg=b,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(Ve,{modelValue:k.Meta.cols_xl,"onUpdate:modelValue":b=>k.Meta.cols_xl=b,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):oe("",!0)]),_:2},1024),s(en,{modelValue:k.Items,"onUpdate:modelValue":b=>k.Items=b,"new-item":C(k),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},ka({_:2},[Ne(k.Items,(b,ce)=>({name:`item_${ce}`,fn:m(()=>[s(lt,{class:"px-0 mx-0",fluid:!0},{default:m(()=>{var be,L;return[s(ge,null,{default:m(()=>[s(B,{cols:"12",sm:"6"},{default:m(()=>[s(Ve,{modelValue:b.Label,"onUpdate:modelValue":E=>b.Label=E,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),s(ge,null,{default:m(()=>[s(B,{cols:"12",sm:"6"},{default:m(()=>[s(he,{modelValue:b.SourceType,"onUpdate:modelValue":E=>b.SourceType=E,label:"Source Type",items:x(rn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,{cols:"12",sm:"6"},{default:m(()=>[b.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(A(),H(he,{key:0,modelValue:b.SectionFieldUUID,"onUpdate:modelValue":E=>b.SectionFieldUUID=E,label:"Form Data",items:c.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:E=>M(b)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):b.SourceType==="LAYOUT_ITEM_SOURCE_META"?(A(),H(he,{key:1,modelValue:b.MetaField,"onUpdate:modelValue":E=>b.MetaField=E,label:"Miscellaneous Data",items:x(on),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):b.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(A(),H(he,{key:2,modelValue:b.UserField,"onUpdate:modelValue":E=>b.UserField=E,label:"User Profile Data",items:x(ln),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):oe("",!0)]),_:2},1024)]),_:2},1024),q.layouts&&b.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((L=(be=b.SectionField)==null?void 0:be.Field)==null?void 0:L.Type)===x(lr).TEXT?(A(),H(ge,{key:0},{default:m(()=>[s(B,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:m(()=>[s(da,{modelValue:b.Meta.DirectEdit,"onUpdate:modelValue":E=>b.Meta.DirectEdit=E,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:m(()=>[s(he,{modelValue:b.Meta.DirectEditPermission,"onUpdate:modelValue":E=>b.Meta.DirectEditPermission=E,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):oe("",!0),q.layouts&&b.SourceType==="LAYOUT_ITEM_SOURCE_META"&&b.MetaField===x(me).META_DATA_SOURCE_BADGE_DISPLAY?(A(),H(ge,{key:1},{default:m(()=>[s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(da,{modelValue:b.Meta.HideDownloadButton,"onUpdate:modelValue":E=>b.Meta.HideDownloadButton=E,label:"Hide Download Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(da,{modelValue:b.Meta.HideNFCButton,"onUpdate:modelValue":E=>b.Meta.HideNFCButton=E,label:"Hide NFC Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):oe("",!0),q.layouts&&b.SourceType==="LAYOUT_ITEM_SOURCE_META"&&b.MetaField===x(me).META_DATA_SOURCE_DATA_LAYOUT?(A(),H(ge,{key:2},{default:m(()=>[s(B,{cols:"6",sm:"4",lg:"2"},{default:m(()=>[s(he,{modelValue:u.value[`${b.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[E=>u.value[`${b.LayoutItemUUID}.LayoutUUID`]=E,E=>$(b,"LayoutUUID")],clearable:!0,items:q.layouts.filter(E=>E.Type===x(dt).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):oe("",!0),q.layouts&&b.SourceType==="LAYOUT_ITEM_SOURCE_META"&&b.MetaField===x(me).META_DATA_SOURCE_TAGS?(A(),H(ge,{key:3},{default:m(()=>[s(B,{cols:"6",sm:"6",md:"6",lg:"6"},{default:m(()=>[s(he,{modelValue:u.value[`${b.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[E=>u.value[`${b.LayoutItemUUID}.Tags`]=E,E=>$(b,"Tags")],clearable:!0,items:g.value||[],multiple:!0,chips:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!u.value[b.LayoutItemUUID]||u.value[b.LayoutItemUUID].length===0?(A(),z("small",Bs," Will show all tags ")):oe("",!0)]),_:2},1024),s(B,{cols:"6"},{default:m(()=>[s(he,{modelValue:b.Meta.TagColour,"onUpdate:modelValue":E=>b.Meta.TagColour=E,items:Q.value,label:"Colour","item-title":"Title","item-value":"Value",variant:"outlined","hide-details":""},{selection:m(({item:E})=>[s(ve,{size:"x-small",color:E.raw.Value,class:"mr-2"},null,8,["color"]),se(" "+ae(E.title),1)]),item:m(({props:E,item:F})=>[s(ea,Fi(Ni(E)),{prepend:m(()=>[s(ve,{size:"x-small",color:F.raw.Value,class:"mr-2"},null,8,["color"])]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):oe("",!0),l.value.Type===x(dt).ADMIN_LAYOUT_TABLE&&(b.SourceType!==x(_t).LAYOUT_ITEM_SOURCE_META||b.MetaField!==x(me).META_DATA_SOURCE_DATA_LAYOUT)?(A(),H(ge,{key:4},{default:m(()=>[s(B,null,{default:m(()=>[s(da,{modelValue:b.DefaultSort,"onUpdate:modelValue":E=>b.DefaultSort=E,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):oe("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),s(ge,null,{default:m(()=>[s(B,null,{default:m(()=>[s(ve,{onClick:G[4]||(G[4]=k=>f.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:m(()=>G[12]||(G[12]=[se("Delete Layout")])),_:1})]),_:1})]),_:1}),f.value?(A(),H(Cl,{key:0,modelValue:f.value,"onUpdate:modelValue":G[5]||(G[5]=k=>f.value=k),message:d.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:G[6]||(G[6]=k=>y("delete"))},null,8,["modelValue","message"])):oe("",!0)]),_:1}))}}),Gs=xe({__name:"EditAdminLayouts",props:$e({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:$e(["save"],["update:modelValue"]),setup(a,{emit:o}){const n=We(a,"modelValue"),l=o,c=P([]),p=P([]),y=P([]),u=Mt(),d=()=>({ID:0,AdminLayoutUUID:St(),ConventionID:a.convention.ID,ConventionUUID:a.convention.ConventionUUID,Name:"New Layout",Type:dt.ADMIN_LAYOUT_PANELS,Panels:[]}),f=()=>{let D=!1;[...new Set(y.value)].forEach($=>{const M=c.value.findIndex(j=>j.AdminLayoutUUID===$);M<0||M>=c.value.length||(u.saveAdminLayout(c.value[M]).then(j=>{j&&c.value.splice(M,1,j)}).catch(()=>{}),D=!0)}),p.value.forEach($=>{u.deleteAdminLayout($).catch(()=>{})}),p.value=[],y.value=[],D&&l("save")},g=D=>{const C=c.value.findIndex($=>$.AdminLayoutUUID===D.AdminLayoutUUID);C<0||C>=c.value.length||(c.value[C].ID>0&&p.value.push(D.AdminLayoutUUID),c.value.splice(C,1))};return u.getConventionAdminLayouts(a.convention.ConventionUUID).then(D=>{D&&(c.value=D)}).catch(()=>[]),(D,C)=>(A(),H(Tr,{modelValue:n.value,"onUpdate:modelValue":C[2]||(C[2]=$=>n.value=$),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:m(()=>[s(en,{modelValue:c.value,"onUpdate:modelValue":C[0]||(C[0]=$=>c.value=$),"new-item":d,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:D.title,label:"Name","slot-name-prefix":"panel",onClose:C[1]||(C[1]=$=>n.value=!1),onSave:f},ka({_:2},[Ne(c.value,($,M)=>({name:`panel_${M}`,fn:m(()=>[s(lt,{class:"px-0 mx-0",fluid:!0},{default:m(()=>[s(ge,null,{default:m(()=>[s(B,{cols:"12"},{default:m(()=>[s(Hs,{modelValue:c.value[M],"onUpdate:modelValue":j=>c.value[M]=j,convention:D.convention,layouts:c.value,onChange:j=>y.value.push($.AdminLayoutUUID),onDelete:j=>g($)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}}),Ws=["href","onClick"],qs=xe({__name:"OperatorSocket",setup(a){const o=Mt(),n=Ca.getInstance(),l=Va(),c=Rl(),p=P(!1),y=ll({mode:"host",wsUri:o.getRunnerSocketURL()}),u=xi.getInstance(),d=P(!1),f=P(!1),g=P([]),D=rr(),C=P("Connecting"),$=P([{title:"- Select Duration -",value:-1},{title:"No Expiry",value:0},{title:"5 Minutes",value:5*60*1e3},{title:"30 Minutes",value:30*60*1e3},{title:"1 Hour",value:60*60*1e3},{title:"1.5 Hours",value:90*60*1e3},{title:"2 Hours",value:120*60*1e3},{title:"3 Hours",value:180*60*1e3},{title:"4 Hours",value:240*60*1e3},{title:"5 Hours",value:300*60*1e3},{title:"6 Hours",value:360*60*1e3}]),M=L=>{if(L.editing=!1,L.timer&&clearTimeout(L.timer),!L.selectedDuration){L.expires=void 0,L.timer=void 0;return}const E=new Date;E.setTime(new Date().getTime()+L.selectedDuration),L.expires=E,j(L),Y()},j=L=>{if(L.expires){if(L.timer&&clearTimeout(L.timer),typeof L.expires=="number"){const E=new Date;E.setTime(L.expires),L.expires=E}L.expires&&"getTime"in L.expires&&(L.timer=setTimeout(()=>{L.timer&&clearTimeout(L.timer),G(L)},L.expires.getTime()-Date.now()))}};y.on("authenticated",()=>{d.value=!0;const L={Key:"",Mode:"host",UserUUID:(l==null?void 0:l.UserUUID)||""},E={Command:"SET_MODE",Params:new Map,Data:JSON.stringify(L)};y.JSON(E)}),y.on("auth_failed",()=>{d.value=!1,C.value="Access Denied"}),y.on("badge_serial_update",L=>{n.emit("badge_serial_update",L)}),y.on("close",()=>{C.value="Disconnected"}),y.on("open",()=>{const L=u.getTokenByService("GrazeAPI");C.value="Authenticating",y.send(`AUTH ${L==null?void 0:L.AccessToken}`)}),y.on("runner_connected",L=>{const E=L,F=g.value.find(de=>de.key==E.Key);if(!F){Q(E.Key,E.UserUUID);return}const ne=Nl();ne.DisplayName=E.DisplayName,ne.UserUUID=E.UserUUID,F.users.find(de=>de.UserUUID==ne.UserUUID)||F.users.push(ne)}),y.on("runner_disconnected",L=>{const E=L,F=g.value.find(de=>de.key==E.Key);if(!F)return;const ne=F.users.findIndex(de=>de.UserUUID==E.UserUUID);ne<0||F.users.splice(ne,1)}),y.on("started",()=>{g.value.forEach(L=>{const E={Key:L.key},F={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify(E)};y.JSON(F)}),C.value="Connected"}),ji(()=>{k(),Ca.getInstance().on("layout_opened",E=>{const F=E;if(!y||!d.value||!F||!F.AdminLayoutUUID||!F.RegistrationUUID)return;const ne={Command:"OPEN_LAYOUT",Params:new Map,Data:JSON.stringify(F)};y.JSON(ne)})}),or(()=>{y.destroy()});const Q=(L,E)=>{const ne={Command:"KICK_RUNNER",Params:new Map,Data:JSON.stringify({DisplayName:"",Key:L,UserUUID:E})};y.JSON(ne)},q=()=>{const L=St(),F={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify({Key:L})};y.JSON(F),g.value.push({key:L,name:"New Session",users:[]}),Y()},G=L=>{const E=g.value.findIndex(de=>de==L);if(E<0)return;const F={Key:L.key},ne={Command:"REMOVE_KEY",Params:new Map,Data:JSON.stringify(F)};y.JSON(ne),g.value.splice(E,1),Y()},k=()=>{const L=sessionStorage.getItem("collaboration.sessions");L&&(g.value=JSON.parse(L),g.value.forEach(E=>{typeof E.expires!="number"&&(E.expires=0),j(E)}))},Y=()=>{const L=[];g.value.forEach(E=>{L.push({name:E.name,expires:typeof E.expires=="number"?E.expires:E.expires?E.expires.getTime():0,key:E.key,users:[]})}),sessionStorage.setItem("collaboration.sessions",JSON.stringify(L))},b=L=>{const E=D.resolve({name:"RunnerView",params:{user:l==null?void 0:l.UserUUID,session:L.key}}),F=new URL(location.href);return F.pathname=E.href,F.toString()},ce=L=>{const E=b(L);return kl(E),f.value=!0,E},be=L=>{if(typeof L=="number"){const de=new Date;de.setTime(L),L=de}const E=L.getTime()-Date.now(),F=Math.floor(E/(1e3*60*60)),ne=Math.floor(E%(1e3*60*60)/(1e3*60));return F==0&&ne==0?`${Math.floor(E%6e4/1e3)}s`:`${F}hr${F!=1?"s":""} ${ne}min${ne!=1?"s":""}`};return(L,E)=>d.value?(A(),z(ue,{key:0},[s(ve,{icon:"mdi:mdi-link-variant",onClick:E[0]||(E[0]=F=>p.value=!0)}),s(Ma,{modelValue:p.value,"onUpdate:modelValue":E[4]||(E[4]=F=>p.value=F),"hide-extension":!0,"show-save-action":!1,"show-delete-action":!1,"show-reset-action":!1,title:"Collaboration",subtitle:`Connection Status: ${C.value}`},{actions:m(()=>[s(Ea),s(ve,{color:"primary",variant:"flat","prepend-icon":"mdi:mdi-link-variant-plus",onClick:q},{default:m(()=>E[5]||(E[5]=[se(" Create Session ")])),_:1})]),default:m(()=>[s(sn,null,{default:m(()=>[(A(!0),z(ue,null,Ne(g.value,F=>(A(),z(ue,{key:F.key},[s(fl,{value:F.key},{activator:m(({props:ne})=>[s(ea,nr({ref_for:!0},ne),{default:m(()=>[s(ur,null,{default:m(()=>[s(ge,null,{default:m(()=>[s(B,{style:{"max-width":"84px"}},{default:m(()=>[le("a",{href:ce(F),onClick:Ot(de=>ce(F),["prevent","stop"]),class:"text-white text-decoration-none"},[s(ve,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant",color:"success",class:"mr-2",title:"Copy Link"})],8,Ws),s(ve,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant-remove",color:"error",class:"mr-2",title:"Terminate",onClick:Ot(de=>G(F),["stop"])},null,8,["onClick"])]),_:2},1024),s(B,null,{default:m(()=>[s(Ve,{modelValue:F.name,"onUpdate:modelValue":de=>F.name=de,"hide-details":"",variant:"plain",density:"compact",onChange:Y,onClick:E[1]||(E[1]=Ot(()=>{},["stop"])),onKeydown:E[2]||(E[2]=Ot(()=>{},["stop"]))},{append:m(()=>[se(ae(F.users.length),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),default:m(()=>[F.editing?(A(),H(he,{key:0,label:"Duration",items:$.value,density:"compact","hide-details":!0,modelValue:F.selectedDuration,"onUpdate:modelValue":[ne=>F.selectedDuration=ne,ne=>M(F)],modelModifiers:{number:!0}},null,8,["items","modelValue","onUpdate:modelValue"])):F.expires?(A(),z(ue,{key:1},[le("small",null,[E[6]||(E[6]=le("strong",null,"Expires:",-1)),se(" "+ae(be(F.expires)),1)]),s(ve,{onClick:ne=>{F.selectedDuration=-1,F.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:m(()=>E[7]||(E[7]=[se(" (Change Expiry) ")])),_:2},1032,["onClick"])],64)):(A(),H(ve,{key:2,onClick:ne=>{F.selectedDuration=-1,F.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:m(()=>E[8]||(E[8]=[se(" (Set Expiry) ")])),_:2},1032,["onClick"])),(A(!0),z(ue,null,Ne(F.users,ne=>(A(),H(ea,{key:`${F.key}.${ne.UserUUID}`},{append:m(()=>[s(ve,{variant:"flat",size:"small",icon:"mdi:mdi-account-network-off",title:"Disconnect User",onClick:de=>Q(F.key,ne.UserUUID)},null,8,["onClick"])]),prepend:m(()=>[s(dr,{src:x(c)(ne.UserUUID),class:"rounded-circle mr-2 pt-4 d-inline-block",height:"32",width:"32"},null,8,["src"])]),default:m(()=>[se(" "+ae(ne.DisplayName),1)]),_:2},1024))),128))]),_:2},1032,["value"]),s(x(Ml),{value:ce(F),width:"200"},null,8,["value"])],64))),128))]),_:1}),s(Tl,{modelValue:f.value,"onUpdate:modelValue":E[3]||(E[3]=F=>f.value=F),message:"Invite Link Copied",timeout:2e3},null,8,["modelValue"])]),_:1},8,["modelValue","subtitle"])],64)):oe("",!0)}}),zs={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Js=xe({__name:"Paginator",props:$e({itemTotal:{}},{currentPage:{required:!0},currentPageModifiers:{},itemsPerPage:{required:!0},itemsPerPageModifiers:{}}),emits:["update:currentPage","update:itemsPerPage"],setup(a){const o=We(a,"currentPage"),n=We(a,"itemsPerPage");return(l,c)=>(A(),H(lt,{fluid:!0},{default:m(()=>[s(ge,{class:"align-center"},{default:m(()=>[s(B,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:m(()=>[s(Vl,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=p=>o.value=p),modelModifiers:{number:!0},length:Math.ceil(l.itemTotal/n.value)},null,8,["modelValue","length"])]),_:1}),s(B,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:m(()=>[s(he,{modelValue:n.value,"onUpdate:modelValue":c[1]||(c[1]=p=>n.value=p),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),s(B,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:m(()=>[s(Ve,{modelValue:o.value,"onUpdate:modelValue":c[2]||(c[2]=p=>o.value=p),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(l.itemTotal/n.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),s(B,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:m(()=>[le("span",zs,[n.value===-1?(A(),z(ue,{key:0},[se(" 1-"+ae(l.itemTotal)+" of "+ae(l.itemTotal),1)],64)):(A(),z(ue,{key:1},[se(ae((o.value-1)*n.value+1)+" - "+ae(o.value*n.value>=l.itemTotal?l.itemTotal:o.value*n.value)+" of "+ae(l.itemTotal),1)],64))])]),_:1})]),_:1})]),_:1}))}});var _r=(a,o,n)=>{if(!o.has(a))throw TypeError("Cannot "+n)},Wn=(a,o,n)=>(_r(a,o,"read from private field"),n?n.call(a):o.get(a)),Ks=(a,o,n)=>{if(o.has(a))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(a):o.set(a,n)},Qs=(a,o,n,l)=>(_r(a,o,"write to private field"),o.set(a,n),n);const Sr=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"]],Xs=[...Sr,["unknown"]].map(a=>a[0]),Ia=new Map(Sr);function Zs(a){for(const[o,n]of Ia)if(a===n)return o;return"unknown"}function eu(a){if(Dr(a))return{width:a.naturalWidth,height:a.naturalHeight};if(Ar(a))return{width:a.width.baseVal.value,height:a.height.baseVal.value};if(Er(a))return{width:a.videoWidth,height:a.videoHeight};if(wr(a))return{width:a.width,height:a.height};if(Or(a))return{width:a.displayWidth,height:a.displayHeight};if(Ir(a))return{width:a.width,height:a.height};if(Cr(a))return{width:a.width,height:a.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function Dr(a){try{return a instanceof HTMLImageElement}catch{return!1}}function Ar(a){try{return a instanceof SVGImageElement}catch{return!1}}function Er(a){try{return a instanceof HTMLVideoElement}catch{return!1}}function Ir(a){try{return a instanceof HTMLCanvasElement}catch{return!1}}function wr(a){try{return a instanceof ImageBitmap}catch{return!1}}function Cr(a){try{return a instanceof OffscreenCanvas}catch{return!1}}function Or(a){try{return a instanceof VideoFrame}catch{return!1}}function kr(a){try{return a instanceof Blob}catch{return!1}}function tu(a){try{return a instanceof ImageData}catch{return!1}}function au(a,o){try{const n=new OffscreenCanvas(a,o);if(n.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return n;throw void 0}catch{const l=document.createElement("canvas");return l.width=a,l.height=o,l}}async function Rr(a){if(Dr(a)&&!await iu(a))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(Ar(a)&&!await lu(a))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(Or(a)&&su(a))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(Er(a)&&(a.readyState===0||a.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(wr(a)&&du(a))throw new DOMException("The image source is detached.","InvalidStateError");const{width:o,height:n}=eu(a);if(o===0||n===0)return null;const l=au(o,n).getContext("2d");l.drawImage(a,0,0);try{return l.getImageData(0,0,o,n)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function nu(a){let o;try{if(globalThis.createImageBitmap)o=await createImageBitmap(a);else if(globalThis.Image){o=new Image;let n="";try{n=URL.createObjectURL(a),o.src=n,await o.decode()}finally{URL.revokeObjectURL(n)}}else return a}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}return await Rr(o)}function ru(a){const{width:o,height:n}=a;if(o===0||n===0)return null;const l=a.getContext("2d");try{return l.getImageData(0,0,o,n)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function ou(a){if(kr(a))return await nu(a);if(tu(a)){if(uu(a))throw new DOMException("The image data has been detached.","InvalidStateError");return a}return Ir(a)||Cr(a)?ru(a):await Rr(a)}async function iu(a){try{return await a.decode(),!0}catch{return!1}}async function lu(a){var o;try{return await((o=a.decode)==null?void 0:o.call(a)),!0}catch{return!1}}function su(a){return a.format===null}function uu(a){return a.data.buffer.byteLength===0}function du(a){return a.width===0&&a.height===0}function qn(a,o){return a instanceof DOMException?new DOMException(`${o}: ${a.message}`,a.name):a instanceof Error?new a.constructor(`${o}: ${a.message}`):new Error(`${o}: ${a}`)}const zn=["Aztec","Codabar","Code128","Code39","Code93","DataBar","DataBarExpanded","DataMatrix","DXFilmEdge","EAN-13","EAN-8","ITF","Linear-Codes","Matrix-Codes","MaxiCode","MicroQRCode","None","PDF417","QRCode","rMQRCode","UPC-A","UPC-E"];function cu(a){return a.join("|")}function mu(a){const o=Jn(a);let n=0,l=zn.length-1;for(;n<=l;){const c=Math.floor((n+l)/2),p=zn[c],y=Jn(p);if(y===o)return p;y<o?n=c+1:l=c-1}return"None"}function Jn(a){return a.toLowerCase().replace(/_-\[\]/g,"")}function fu(a,o){return a.Binarizer[o]}function vu(a,o){return a.CharacterSet[o]}const pu=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function yu(a){return pu[a.value]}function gu(a,o){return a.EanAddOnSymbol[o]}function hu(a,o){return a.TextMode[o]}const ta={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!1,validateCode39CheckSum:!1,validateITFCheckSum:!1,returnCodabarStartEnd:!1,returnErrors:!1,eanAddOnSymbol:"Read",textMode:"Plain",characterSet:"Unknown"};function Mr(a,o){return{...o,formats:cu(o.formats),binarizer:fu(a,o.binarizer),eanAddOnSymbol:gu(a,o.eanAddOnSymbol),textMode:hu(a,o.textMode),characterSet:vu(a,o.characterSet)}}function Vr(a){return{...a,format:mu(a.format),eccLevel:a.eccLevel,contentType:yu(a.contentType)}}const Uu={locateFile:(a,o)=>{const n=a.match(/_(.+?)\.wasm$/);return n?`https://fastly.jsdelivr.net/npm/zxing-wasm@1.1.3/dist/${n[1]}/${a}`:o+a}};let Kn=new WeakMap;function mn(a,o){var n;const l=Kn.get(a);if(l!=null&&l.modulePromise&&o===void 0)return l.modulePromise;const c=(n=l==null?void 0:l.moduleOverrides)!=null?n:Uu,p=a({...c});return Kn.set(a,{moduleOverrides:c,modulePromise:p}),p}async function Tu(a,o,n=ta){const l={...ta,...n},c=await mn(a),{size:p}=o,y=new Uint8Array(await o.arrayBuffer()),u=c._malloc(p);c.HEAPU8.set(y,u);const d=c.readBarcodesFromImage(u,p,Mr(c,l));c._free(u);const f=[];for(let g=0;g<d.size();++g)f.push(Vr(d.get(g)));return f}async function bu(a,o,n=ta){const l={...ta,...n},c=await mn(a),{data:p,width:y,height:u,data:{byteLength:d}}=o,f=c._malloc(d);c.HEAPU8.set(p,f);const g=c.readBarcodesFromPixmap(f,y,u,Mr(c,l));c._free(f);const D=[];for(let C=0;C<g.size();++C)D.push(Vr(g.get(C)));return D}({...ta,formats:[...ta.formats]});var fn=(()=>{var a=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(o={}){var n=o,l,c;n.ready=new Promise((e,t)=>{l=e,c=t});var p=Object.assign({},n),y="./this.program",u=typeof window=="object",d=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var f="";function g(e){return n.locateFile?n.locateFile(e,f):f+e}var D;(u||d)&&(d?f=self.location.href:typeof document<"u"&&document.currentScript&&(f=document.currentScript.src),a&&(f=a),f.indexOf("blob:")!==0?f=f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):f="",d&&(D=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)})),n.print||console.log.bind(console);var C=n.printErr||console.error.bind(console);Object.assign(n,p),p=null,n.arguments&&n.arguments,n.thisProgram&&(y=n.thisProgram),n.quit&&n.quit;var $;n.wasmBinary&&($=n.wasmBinary),typeof WebAssembly!="object"&&Be("no native wasm support detected");var M,j=!1,Q,q,G,k,Y,b,ce,be;function L(){var e=M.buffer;n.HEAP8=Q=new Int8Array(e),n.HEAP16=G=new Int16Array(e),n.HEAPU8=q=new Uint8Array(e),n.HEAPU16=k=new Uint16Array(e),n.HEAP32=Y=new Int32Array(e),n.HEAPU32=b=new Uint32Array(e),n.HEAPF32=ce=new Float32Array(e),n.HEAPF64=be=new Float64Array(e)}var E=[],F=[],ne=[];function de(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)at(n.preRun.shift());Je(E)}function Dt(){Je(F)}function mt(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)He(n.postRun.shift());Je(ne)}function at(e){E.unshift(e)}function At(e){F.unshift(e)}function He(e){ne.unshift(e)}var Fe=0,Xe=null;function ft(e){var t;Fe++,(t=n.monitorRunDependencies)===null||t===void 0||t.call(n,Fe)}function Ye(e){var t;if(Fe--,(t=n.monitorRunDependencies)===null||t===void 0||t.call(n,Fe),Fe==0&&Xe){var r=Xe;Xe=null,r()}}function Be(e){var t;(t=n.onAbort)===null||t===void 0||t.call(n,e),e="Aborted("+e+")",C(e),j=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw c(r),r}var Et="data:application/octet-stream;base64,",vt=e=>e.startsWith(Et),ze;ze="zxing_reader.wasm",vt(ze)||(ze=g(ze));function pt(e){if(e==ze&&$)return new Uint8Array($);if(D)return D(e);throw"both async and sync fetching of the wasm failed"}function It(e){return!$&&(u||d)&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>pt(e)):Promise.resolve().then(()=>pt(e))}function yt(e,t,r){return It(e).then(i=>WebAssembly.instantiate(i,t)).then(i=>i).then(r,i=>{C(`failed to asynchronously prepare wasm: ${i}`),Be(i)})}function Lt(e,t,r,i){return!e&&typeof WebAssembly.instantiateStreaming=="function"&&!vt(t)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(v=>{var h=WebAssembly.instantiateStreaming(v,r);return h.then(i,function(T){return C(`wasm streaming compile failed: ${T}`),C("falling back to ArrayBuffer instantiation"),yt(t,r,i)})}):yt(t,r,i)}function Ft(){var e={a:pi};function t(i,v){return ke=i.exports,M=ke.ia,L(),gn=ke.ma,At(ke.ja),Ye(),ke}ft();function r(i){t(i.instance)}if(n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(i){C(`Module.instantiateWasm callback failed with error: ${i}`),c(i)}return Lt($,ze,e,r).catch(c),{}}var Je=e=>{for(;e.length>0;)e.shift()(n)};n.noExitRuntime;var Re=[],Ze=0,va=e=>{var t=new xt(e);return t.get_caught()||(t.set_caught(!0),Ze--),t.set_rethrown(!1),Re.push(t),kn(t.excPtr),t.get_exception_ptr()},nt=0,Nt=()=>{_e(0,0);var e=Re.pop();On(e.excPtr),nt=0};function xt(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(t){b[this.ptr+4>>2]=t},this.get_type=function(){return b[this.ptr+4>>2]},this.set_destructor=function(t){b[this.ptr+8>>2]=t},this.get_destructor=function(){return b[this.ptr+8>>2]},this.set_caught=function(t){t=t?1:0,Q[this.ptr+12>>0]=t},this.get_caught=function(){return Q[this.ptr+12>>0]!=0},this.set_rethrown=function(t){t=t?1:0,Q[this.ptr+13>>0]=t},this.get_rethrown=function(){return Q[this.ptr+13>>0]!=0},this.init=function(t,r){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(r)},this.set_adjusted_ptr=function(t){b[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return b[this.ptr+16>>2]},this.get_exception_ptr=function(){var t=Mn(this.get_type());if(t)return b[this.excPtr>>2];var r=this.get_adjusted_ptr();return r!==0?r:this.excPtr}}var Vt=e=>{throw nt||(nt=e),nt},st=e=>{var t=nt;if(!t)return ua(0),0;var r=new xt(t);r.set_adjusted_ptr(t);var i=r.get_type();if(!i)return ua(0),t;for(var v in e){var h=e[v];if(h===0||h===i)break;var T=r.ptr+16;if(Rn(h,i,T))return ua(h),t}return ua(i),t},$a=()=>st([]),Ue=e=>st([e]),La=(e,t)=>st([e,t]),jt=()=>{var e=Re.pop();e||Be("no exception to throw");var t=e.excPtr;throw e.get_rethrown()||(Re.push(e),e.set_rethrown(!0),e.set_caught(!1),Ze++),nt=t,nt},Fa=(e,t,r)=>{var i=new xt(e);throw i.init(t,r),nt=e,Ze++,nt},pa=()=>Ze,Yt={},aa=e=>{for(;e.length;){var t=e.pop(),r=e.pop();r(t)}};function na(e){return this.fromWireType(Y[e>>2])}var wt={},gt={},Bt={},Ht,Gt=e=>{throw new Ht(e)},ht=(e,t,r)=>{e.forEach(function(_){Bt[_]=t});function i(_){var w=r(_);w.length!==e.length&&Gt("Mismatched type converter count");for(var V=0;V<e.length;++V)R(e[V],w[V])}var v=new Array(t.length),h=[],T=0;t.forEach((_,w)=>{gt.hasOwnProperty(_)?v[w]=gt[_]:(h.push(_),wt.hasOwnProperty(_)||(wt[_]=[]),wt[_].push(()=>{v[w]=gt[_],++T,T===h.length&&i(v)}))}),h.length===0&&i(v)},Na=e=>{var t=Yt[e];delete Yt[e];var r=t.rawConstructor,i=t.rawDestructor,v=t.fields,h=v.map(T=>T.getterReturnType).concat(v.map(T=>T.setterArgumentType));ht([e],h,T=>{var _={};return v.forEach((w,V)=>{var N=w.fieldName,ee=T[V],te=w.getter,re=w.getterContext,Se=T[V+v.length],Ie=w.setter,ye=w.setterContext;_[N]={read:Le=>ee.fromWireType(te(re,Le)),write:(Le,O)=>{var W=[];Ie(ye,Le,Se.toWireType(W,O)),aa(W)}}}),[{name:t.name,fromWireType:w=>{var V={};for(var N in _)V[N]=_[N].read(w);return i(w),V},toWireType:(w,V)=>{for(var N in _)if(!(N in V))throw new TypeError(`Missing field: "${N}"`);var ee=r();for(N in _)_[N].write(ee,V[N]);return w!==null&&w.push(i,ee),ee},argPackAdvance:I,readValueFromPointer:na,destructorFunction:i}]})},xa=(e,t,r,i,v)=>{},Wt=()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ra=e},ra,Oe=e=>{for(var t="",r=e;q[r];)t+=ra[q[r++]];return t},Ut,U=e=>{throw new Ut(e)};function S(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i=t.name;if(e||U(`type "${i}" must have a positive integer typeid pointer`),gt.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;U(`Cannot register type '${i}' twice`)}if(gt[e]=t,delete Bt[e],wt.hasOwnProperty(e)){var v=wt[e];delete wt[e],v.forEach(h=>h())}}function R(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return S(e,t,r)}var I=8,Te=(e,t,r,i)=>{t=Oe(t),R(e,{name:t,fromWireType:function(v){return!!v},toWireType:function(v,h){return h?r:i},argPackAdvance:I,readValueFromPointer:function(v){return this.fromWireType(q[v])},destructorFunction:null})},fe=e=>({count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}),rt=e=>{function t(r){return r.$$.ptrType.registeredClass.name}U(t(e)+" instance already deleted")},pe=!1,qt=e=>{},oa=e=>{e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)},zt=e=>{e.count.value-=1;var t=e.count.value===0;t&&oa(e)},ya=(e,t,r)=>{if(t===r)return e;if(r.baseClass===void 0)return null;var i=ya(e,t,r.baseClass);return i===null?null:r.downcast(i)},X={},Jt=()=>Object.keys(et).length,ot=()=>{var e=[];for(var t in et)et.hasOwnProperty(t)&&e.push(et[t]);return e},ie=[],Ke=()=>{for(;ie.length;){var e=ie.pop();e.$$.deleteScheduled=!1,e.delete()}},K,ga=e=>{K=e,ie.length&&K&&K(Ke)},Pt=()=>{n.getInheritedInstanceCount=Jt,n.getLiveInheritedInstances=ot,n.flushPendingDeletes=Ke,n.setDelayFunction=ga},et={},J=(e,t)=>{for(t===void 0&&U("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t},Z=(e,t)=>(t=J(e,t),et[t]),je=(e,t)=>{(!t.ptrType||!t.ptr)&&Gt("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,i=!!t.smartPtr;return r!==i&&Gt("Both smartPtrType and smartPtr must be specified"),t.count={value:1},ia(Object.create(e,{$$:{value:t,writable:!0}}))};function Kr(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=Z(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var i=r.clone();return this.destructor(e),i}function v(){return this.isSmartPointer?je(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):je(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var h=this.registeredClass.getActualType(t),T=X[h];if(!T)return v.call(this);var _;this.isConst?_=T.constPointerType:_=T.pointerType;var w=ya(t,this.registeredClass,_.registeredClass);return w===null?v.call(this):this.isSmartPointer?je(_.registeredClass.instancePrototype,{ptrType:_,ptr:w,smartPtrType:this,smartPtr:e}):je(_.registeredClass.instancePrototype,{ptrType:_,ptr:w})}var ia=e=>typeof FinalizationRegistry>"u"?(ia=t=>t,e):(pe=new FinalizationRegistry(t=>{zt(t.$$)}),ia=t=>{var r=t.$$,i=!!r.smartPtr;if(i){var v={$$:r};pe.register(t,v,t)}return t},qt=t=>pe.unregister(t),ia(e)),Qr=()=>{Object.assign(ha.prototype,{isAliasOf(e){if(!(this instanceof ha)||!(e instanceof ha))return!1;var t=this.$$.ptrType.registeredClass,r=this.$$.ptr;e.$$=e.$$;for(var i=e.$$.ptrType.registeredClass,v=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;i.baseClass;)v=i.upcast(v),i=i.baseClass;return t===i&&r===v},clone(){if(this.$$.ptr||rt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=ia(Object.create(Object.getPrototypeOf(this),{$$:{value:fe(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e},delete(){this.$$.ptr||rt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&U("Object already scheduled for deletion"),qt(this),zt(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||rt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&U("Object already scheduled for deletion"),ie.push(this),ie.length===1&&K&&K(Ke),this.$$.deleteScheduled=!0,this}})};function ha(){}var la=(e,t)=>Object.defineProperty(t,"name",{value:e}),vn=(e,t,r)=>{if(e[t].overloadTable===void 0){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||U(`Function '${r}' called with an invalid number of arguments (${arguments.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}},ja=(e,t,r)=>{n.hasOwnProperty(e)?((r===void 0||n[e].overloadTable!==void 0&&n[e].overloadTable[r]!==void 0)&&U(`Cannot register public name '${e}' twice`),vn(n,e,e),n.hasOwnProperty(r)&&U(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),n[e].overloadTable[r]=t):(n[e]=t,r!==void 0&&(n[e].numArguments=r))},Xr=48,Zr=57,eo=e=>{if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=Xr&&t<=Zr?`_${e}`:e};function to(e,t,r,i,v,h,T,_){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=i,this.baseClass=v,this.getActualType=h,this.upcast=T,this.downcast=_,this.pureVirtualFunctions=[]}var Ya=(e,t,r)=>{for(;t!==r;)t.upcast||U(`Expected null or instance of ${r.name}, got an instance of ${t.name}`),e=t.upcast(e),t=t.baseClass;return e};function ao(e,t){if(t===null)return this.isReference&&U(`null is not a valid ${this.name}`),0;t.$$||U(`Cannot pass "${qa(t)}" as a ${this.name}`),t.$$.ptr||U(`Cannot pass deleted object as a pointer of type ${this.name}`);var r=t.$$.ptrType.registeredClass,i=Ya(t.$$.ptr,r,this.registeredClass);return i}function no(e,t){var r;if(t===null)return this.isReference&&U(`null is not a valid ${this.name}`),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;(!t||!t.$$)&&U(`Cannot pass "${qa(t)}" as a ${this.name}`),t.$$.ptr||U(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&U(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var i=t.$$.ptrType.registeredClass;if(r=Ya(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&U("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:U(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var v=t.clone();r=this.rawShare(r,Tt.toHandle(()=>v.delete())),e!==null&&e.push(this.rawDestructor,r)}break;default:U("Unsupporting sharing policy")}return r}function ro(e,t){if(t===null)return this.isReference&&U(`null is not a valid ${this.name}`),0;t.$$||U(`Cannot pass "${qa(t)}" as a ${this.name}`),t.$$.ptr||U(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&U(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var r=t.$$.ptrType.registeredClass,i=Ya(t.$$.ptr,r,this.registeredClass);return i}function pn(e){return this.fromWireType(b[e>>2])}var oo=()=>{Object.assign(Ua.prototype,{getPointee(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},destructor(e){var t;(t=this.rawDestructor)===null||t===void 0||t.call(this,e)},argPackAdvance:I,readValueFromPointer:pn,deleteObject(e){e!==null&&e.delete()},fromWireType:Kr})};function Ua(e,t,r,i,v,h,T,_,w,V,N){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=i,this.isSmartPointer=v,this.pointeeType=h,this.sharingPolicy=T,this.rawGetPointee=_,this.rawConstructor=w,this.rawShare=V,this.rawDestructor=N,!v&&t.baseClass===void 0?i?(this.toWireType=ao,this.destructorFunction=null):(this.toWireType=ro,this.destructorFunction=null):this.toWireType=no}var yn=(e,t,r)=>{n.hasOwnProperty(e)||Gt("Replacing nonexistant public symbol"),n[e].overloadTable!==void 0&&r!==void 0?n[e].overloadTable[r]=t:(n[e]=t,n[e].argCount=r)},io=(e,t,r)=>{var i=n["dynCall_"+e];return r&&r.length?i.apply(null,[t].concat(r)):i.call(null,t)},Ta=[],gn,De=e=>{var t=Ta[e];return t||(e>=Ta.length&&(Ta.length=e+1),Ta[e]=t=gn.get(e)),t},lo=(e,t,r)=>{if(e.includes("j"))return io(e,t,r);var i=De(t).apply(null,r);return i},so=(e,t)=>{var r=[];return function(){return r.length=0,Object.assign(r,arguments),lo(e,t,r)}},it=(e,t)=>{e=Oe(e);function r(){return e.includes("j")?so(e,t):De(t)}var i=r();return typeof i!="function"&&U(`unknown function pointer with signature ${e}: ${t}`),i},uo=(e,t)=>{var r=la(t,function(i){this.name=t,this.message=i;var v=new Error(i).stack;v!==void 0&&(this.stack=this.toString()+`
`+v.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},r},hn,Un=e=>{var t=Cn(e),r=Oe(t);return bt(t),r},ba=(e,t)=>{var r=[],i={};function v(h){if(!i[h]&&!gt[h]){if(Bt[h]){Bt[h].forEach(v);return}r.push(h),i[h]=!0}}throw t.forEach(v),new hn(`${e}: `+r.map(Un).join([", "]))},co=(e,t,r,i,v,h,T,_,w,V,N,ee,te)=>{N=Oe(N),h=it(v,h),_&&(_=it(T,_)),V&&(V=it(w,V)),te=it(ee,te);var re=eo(N);ja(re,function(){ba(`Cannot construct ${N} due to unbound types`,[i])}),ht([e,t,r],i?[i]:[],function(Se){Se=Se[0];var Ie,ye;i?(Ie=Se.registeredClass,ye=Ie.instancePrototype):ye=ha.prototype;var Le=la(N,function(){if(Object.getPrototypeOf(this)!==O)throw new Ut("Use 'new' to construct "+N);if(W.constructor_body===void 0)throw new Ut(N+" has no accessible constructor");var Ln=W.constructor_body[arguments.length];if(Ln===void 0)throw new Ut(`Tried to invoke ctor of ${N} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(W.constructor_body).toString()}) parameters instead!`);return Ln.apply(this,arguments)}),O=Object.create(ye,{constructor:{value:Le}});Le.prototype=O;var W=new to(N,Le,O,te,Ie,h,_,V);if(W.baseClass){var we,Pe;(Pe=(we=W.baseClass).__derivedClasses)!==null&&Pe!==void 0||(we.__derivedClasses=[]),W.baseClass.__derivedClasses.push(W)}var Kt=new Ua(N,W,!0,!1,!1),Da=new Ua(N+"*",W,!1,!1,!1),$n=new Ua(N+" const*",W,!1,!0,!1);return X[e]={pointerType:Da,constPointerType:$n},yn(re,Le),[Kt,Da,$n]})},Ba=(e,t)=>{for(var r=[],i=0;i<e;i++)r.push(b[t+i*4>>2]);return r};function mo(e){for(var t=1;t<e.length;++t)if(e[t]!==null&&e[t].destructorFunction===void 0)return!0;return!1}function Ha(e,t,r,i,v,h){var T=t.length;T<2&&U("argTypes array size mismatch! Must at least get return value and 'this' types!");var _=t[1]!==null&&r!==null,w=mo(t),V=t[0].name!=="void",N=T-2,ee=new Array(N),te=[],re=[],Se=function(){arguments.length!==N&&U(`function ${e} called with ${arguments.length} arguments, expected ${N}`),re.length=0;var Ie;te.length=_?2:1,te[0]=v,_&&(Ie=t[1].toWireType(re,this),te[1]=Ie);for(var ye=0;ye<N;++ye)ee[ye]=t[ye+2].toWireType(re,arguments[ye]),te.push(ee[ye]);var Le=i.apply(null,te);function O(W){if(w)aa(re);else for(var we=_?1:2;we<t.length;we++){var Pe=we===1?Ie:ee[we-2];t[we].destructorFunction!==null&&t[we].destructorFunction(Pe)}if(V)return t[0].fromWireType(W)}return O(Le)};return la(e,Se)}var fo=(e,t,r,i,v,h)=>{var T=Ba(t,r);v=it(i,v),ht([],[e],function(_){_=_[0];var w=`constructor ${_.name}`;if(_.registeredClass.constructor_body===void 0&&(_.registeredClass.constructor_body=[]),_.registeredClass.constructor_body[t-1]!==void 0)throw new Ut(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${_.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return _.registeredClass.constructor_body[t-1]=()=>{ba(`Cannot construct ${_.name} due to unbound types`,T)},ht([],T,V=>(V.splice(1,0,null),_.registeredClass.constructor_body[t-1]=Ha(w,V,null,v,h),[])),[]})},Tn=e=>{e=e.trim();const t=e.indexOf("(");return t!==-1?e.substr(0,t):e},vo=(e,t,r,i,v,h,T,_,w)=>{var V=Ba(r,i);t=Oe(t),t=Tn(t),h=it(v,h),ht([],[e],function(N){N=N[0];var ee=`${N.name}.${t}`;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),_&&N.registeredClass.pureVirtualFunctions.push(t);function te(){ba(`Cannot call ${ee} due to unbound types`,V)}var re=N.registeredClass.instancePrototype,Se=re[t];return Se===void 0||Se.overloadTable===void 0&&Se.className!==N.name&&Se.argCount===r-2?(te.argCount=r-2,te.className=N.name,re[t]=te):(vn(re,t,ee),re[t].overloadTable[r-2]=te),ht([],V,function(Ie){var ye=Ha(ee,Ie,N,h,T);return re[t].overloadTable===void 0?(ye.argCount=r-2,re[t]=ye):re[t].overloadTable[r-2]=ye,[]}),[]})};function po(){Object.assign(bn.prototype,{get(e){return this.allocated[e]},has(e){return this.allocated[e]!==void 0},allocate(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},free(e){this.allocated[e]=void 0,this.freelist.push(e)}})}function bn(){this.allocated=[void 0],this.freelist=[]}var tt=new bn,Ga=e=>{e>=tt.reserved&&--tt.get(e).refcount===0&&tt.free(e)},yo=()=>{for(var e=0,t=tt.reserved;t<tt.allocated.length;++t)tt.allocated[t]!==void 0&&++e;return e},go=()=>{tt.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),tt.reserved=tt.allocated.length,n.count_emval_handles=yo},Tt={toValue:e=>(e||U("Cannot use deleted val. handle = "+e),tt.get(e).value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return tt.allocate({refcount:1,value:e})}}},ho=(e,t)=>{t=Oe(t),R(e,{name:t,fromWireType:r=>{var i=Tt.toValue(r);return Ga(r),i},toWireType:(r,i)=>Tt.toHandle(i),argPackAdvance:I,readValueFromPointer:na,destructorFunction:null})},Uo=(e,t,r)=>{switch(t){case 1:return r?function(i){return this.fromWireType(Q[i>>0])}:function(i){return this.fromWireType(q[i>>0])};case 2:return r?function(i){return this.fromWireType(G[i>>1])}:function(i){return this.fromWireType(k[i>>1])};case 4:return r?function(i){return this.fromWireType(Y[i>>2])}:function(i){return this.fromWireType(b[i>>2])};default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},To=(e,t,r,i)=>{t=Oe(t);function v(){}v.values={},R(e,{name:t,constructor:v,fromWireType:function(h){return this.constructor.values[h]},toWireType:(h,T)=>T.value,argPackAdvance:I,readValueFromPointer:Uo(t,r,i),destructorFunction:null}),ja(t,v)},Wa=(e,t)=>{var r=gt[e];return r===void 0&&U(t+" has unknown type "+Un(e)),r},bo=(e,t,r)=>{var i=Wa(e,"enum");t=Oe(t);var v=i.constructor,h=Object.create(i.constructor.prototype,{value:{value:r},constructor:{value:la(`${i.name}_${t}`,function(){})}});v.values[r]=h,v[t]=h},qa=e=>{if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e},_o=(e,t)=>{switch(t){case 4:return function(r){return this.fromWireType(ce[r>>2])};case 8:return function(r){return this.fromWireType(be[r>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},So=(e,t,r)=>{t=Oe(t),R(e,{name:t,fromWireType:i=>i,toWireType:(i,v)=>v,argPackAdvance:I,readValueFromPointer:_o(t,r),destructorFunction:null})},Do=(e,t,r,i,v,h,T)=>{var _=Ba(t,r);e=Oe(e),e=Tn(e),v=it(i,v),ja(e,function(){ba(`Cannot call ${e} due to unbound types`,_)},t-1),ht([],_,function(w){var V=[w[0],null].concat(w.slice(1));return yn(e,Ha(e,V,null,v,h),t-1),[]})},Ao=(e,t,r)=>{switch(t){case 1:return r?i=>Q[i>>0]:i=>q[i>>0];case 2:return r?i=>G[i>>1]:i=>k[i>>1];case 4:return r?i=>Y[i>>2]:i=>b[i>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},Eo=(e,t,r,i,v)=>{t=Oe(t);var h=N=>N;if(i===0){var T=32-8*r;h=N=>N<<T>>>T}var _=t.includes("unsigned"),w=(N,ee)=>{},V;_?V=function(N,ee){return w(ee,this.name),ee>>>0}:V=function(N,ee){return w(ee,this.name),ee},R(e,{name:t,fromWireType:h,toWireType:V,argPackAdvance:I,readValueFromPointer:Ao(t,r,i!==0),destructorFunction:null})},Io=(e,t,r)=>{var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],v=i[t];function h(T){var _=b[T>>2],w=b[T+4>>2];return new v(Q.buffer,w,_)}r=Oe(r),R(e,{name:r,fromWireType:h,argPackAdvance:I,readValueFromPointer:h},{ignoreDuplicateRegistrations:!0})},_n=(e,t,r,i)=>{if(!(i>0))return 0;for(var v=r,h=r+i-1,T=0;T<e.length;++T){var _=e.charCodeAt(T);if(_>=55296&&_<=57343){var w=e.charCodeAt(++T);_=65536+((_&1023)<<10)|w&1023}if(_<=127){if(r>=h)break;t[r++]=_}else if(_<=2047){if(r+1>=h)break;t[r++]=192|_>>6,t[r++]=128|_&63}else if(_<=65535){if(r+2>=h)break;t[r++]=224|_>>12,t[r++]=128|_>>6&63,t[r++]=128|_&63}else{if(r+3>=h)break;t[r++]=240|_>>18,t[r++]=128|_>>12&63,t[r++]=128|_>>6&63,t[r++]=128|_&63}}return t[r]=0,r-v},wo=(e,t,r)=>_n(e,q,t,r),Sn=e=>{for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i<=127?t++:i<=2047?t+=2:i>=55296&&i<=57343?(t+=4,++r):t+=3}return t},Dn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Co=(e,t,r)=>{for(var i=t+r,v=t;e[v]&&!(v>=i);)++v;if(v-t>16&&e.buffer&&Dn)return Dn.decode(e.subarray(t,v));for(var h="";t<v;){var T=e[t++];if(!(T&128)){h+=String.fromCharCode(T);continue}var _=e[t++]&63;if((T&224)==192){h+=String.fromCharCode((T&31)<<6|_);continue}var w=e[t++]&63;if((T&240)==224?T=(T&15)<<12|_<<6|w:T=(T&7)<<18|_<<12|w<<6|e[t++]&63,T<65536)h+=String.fromCharCode(T);else{var V=T-65536;h+=String.fromCharCode(55296|V>>10,56320|V&1023)}}return h},za=(e,t)=>e?Co(q,e,t):"",Oo=(e,t)=>{t=Oe(t);var r=t==="std::string";R(e,{name:t,fromWireType(i){var v=b[i>>2],h=i+4,T;if(r)for(var _=h,w=0;w<=v;++w){var V=h+w;if(w==v||q[V]==0){var N=V-_,ee=za(_,N);T===void 0?T=ee:(T+="\0",T+=ee),_=V+1}}else{for(var te=new Array(v),w=0;w<v;++w)te[w]=String.fromCharCode(q[h+w]);T=te.join("")}return bt(i),T},toWireType(i,v){v instanceof ArrayBuffer&&(v=new Uint8Array(v));var h,T=typeof v=="string";T||v instanceof Uint8Array||v instanceof Uint8ClampedArray||v instanceof Int8Array||U("Cannot pass non-string to std::string"),r&&T?h=Sn(v):h=v.length;var _=Qa(4+h+1),w=_+4;if(b[_>>2]=h,r&&T)wo(v,w,h+1);else if(T)for(var V=0;V<h;++V){var N=v.charCodeAt(V);N>255&&(bt(w),U("String has UTF-16 code units that do not fit in 8 bits")),q[w+V]=N}else for(var V=0;V<h;++V)q[w+V]=v[V];return i!==null&&i.push(bt,_),_},argPackAdvance:I,readValueFromPointer:pn,destructorFunction(i){bt(i)}})},An=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,ko=(e,t)=>{for(var r=e,i=r>>1,v=i+t/2;!(i>=v)&&k[i];)++i;if(r=i<<1,r-e>32&&An)return An.decode(q.subarray(e,r));for(var h="",T=0;!(T>=t/2);++T){var _=G[e+T*2>>1];if(_==0)break;h+=String.fromCharCode(_)}return h},Ro=(e,t,r)=>{var i;if((i=r)!==null&&i!==void 0||(r=2147483647),r<2)return 0;r-=2;for(var v=t,h=r<e.length*2?r/2:e.length,T=0;T<h;++T){var _=e.charCodeAt(T);G[t>>1]=_,t+=2}return G[t>>1]=0,t-v},Mo=e=>e.length*2,Vo=(e,t)=>{for(var r=0,i="";!(r>=t/4);){var v=Y[e+r*4>>2];if(v==0)break;if(++r,v>=65536){var h=v-65536;i+=String.fromCharCode(55296|h>>10,56320|h&1023)}else i+=String.fromCharCode(v)}return i},Po=(e,t,r)=>{var i;if((i=r)!==null&&i!==void 0||(r=2147483647),r<4)return 0;for(var v=t,h=v+r-4,T=0;T<e.length;++T){var _=e.charCodeAt(T);if(_>=55296&&_<=57343){var w=e.charCodeAt(++T);_=65536+((_&1023)<<10)|w&1023}if(Y[t>>2]=_,t+=4,t+4>h)break}return Y[t>>2]=0,t-v},$o=e=>{for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,t+=4}return t},Lo=(e,t,r)=>{r=Oe(r);var i,v,h,T,_;t===2?(i=ko,v=Ro,T=Mo,h=()=>k,_=1):t===4&&(i=Vo,v=Po,T=$o,h=()=>b,_=2),R(e,{name:r,fromWireType:w=>{for(var V=b[w>>2],N=h(),ee,te=w+4,re=0;re<=V;++re){var Se=w+4+re*t;if(re==V||N[Se>>_]==0){var Ie=Se-te,ye=i(te,Ie);ee===void 0?ee=ye:(ee+="\0",ee+=ye),te=Se+t}}return bt(w),ee},toWireType:(w,V)=>{typeof V!="string"&&U(`Cannot pass non-string to C++ string type ${r}`);var N=T(V),ee=Qa(4+N+t);return b[ee>>2]=N>>_,v(V,ee+4,N+t),w!==null&&w.push(bt,ee),ee},argPackAdvance:I,readValueFromPointer:na,destructorFunction(w){bt(w)}})},Fo=(e,t,r,i,v,h)=>{Yt[e]={name:Oe(t),rawConstructor:it(r,i),rawDestructor:it(v,h),fields:[]}},No=(e,t,r,i,v,h,T,_,w,V)=>{Yt[e].fields.push({fieldName:Oe(t),getterReturnType:r,getter:it(i,v),getterContext:h,setterArgumentType:T,setter:it(_,w),setterContext:V})},xo=(e,t)=>{t=Oe(t),R(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:(r,i)=>{}})},Ja=[],jo=(e,t,r,i)=>(e=Ja[e],t=Tt.toValue(t),e(null,t,r,i)),Yo={},Bo=e=>{var t=Yo[e];return t===void 0?Oe(e):t},En=()=>{if(typeof globalThis=="object")return globalThis;function e(t){t.$$$embind_global$$$=t;var r=typeof $$$embind_global$$$=="object"&&t.$$$embind_global$$$==t;return r||delete t.$$$embind_global$$$,r}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&e(global)?$$$embind_global$$$=global:typeof self=="object"&&e(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Ho=e=>e===0?Tt.toHandle(En()):(e=Bo(e),Tt.toHandle(En()[e])),Go=e=>{var t=Ja.length;return Ja.push(e),t},Wo=(e,t)=>{for(var r=new Array(e),i=0;i<e;++i)r[i]=Wa(b[t+i*4>>2],"parameter "+i);return r},qo=Reflect.construct,zo=(e,t,r)=>{var i=[],v=e.toWireType(i,r);return i.length&&(b[t>>2]=Tt.toHandle(i)),v},Jo=(e,t,r)=>{var i=Wo(e,t),v=i.shift();e--;var h=new Array(e),T=(w,V,N,ee)=>{for(var te=0,re=0;re<e;++re)h[re]=i[re].readValueFromPointer(ee+te),te+=i[re].argPackAdvance;for(var Se=r===1?qo(V,h):V.apply(w,h),re=0;re<e;++re){var Ie,ye;(Ie=(ye=i[re]).deleteObject)===null||Ie===void 0||Ie.call(ye,h[re])}return zo(v,N,Se)},_=`methodCaller<(${i.map(w=>w.name).join(", ")}) => ${v.name}>`;return Go(la(_,T))},Ko=e=>{e>4&&(tt.get(e).refcount+=1)},Qo=e=>{var t=Tt.toValue(e);aa(t),Ga(e)},Xo=(e,t)=>{e=Wa(e,"_emval_take_value");var r=e.readValueFromPointer(t);return Tt.toHandle(r)},Zo=()=>{Be("")},ei=(e,t,r)=>q.copyWithin(e,t,t+r),ti=()=>2147483648,ai=e=>{var t=M.buffer,r=(e-t.byteLength+65535)/65536;try{return M.grow(r),L(),1}catch{}},ni=e=>{var t=q.length;e>>>=0;var r=ti();if(e>r)return!1;for(var i=(w,V)=>w+(V-w%V)%V,v=1;v<=4;v*=2){var h=t*(1+.2/v);h=Math.min(h,e+100663296);var T=Math.min(r,i(Math.max(e,h),65536)),_=ai(T);if(_)return!0}return!1},Ka={},ri=()=>y||"./this.program",sa=()=>{if(!sa.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:ri()};for(var r in Ka)Ka[r]===void 0?delete t[r]:t[r]=Ka[r];var i=[];for(var r in t)i.push(`${r}=${t[r]}`);sa.strings=i}return sa.strings},oi=(e,t)=>{for(var r=0;r<e.length;++r)Q[t++>>0]=e.charCodeAt(r);Q[t>>0]=0},ii=(e,t)=>{var r=0;return sa().forEach((i,v)=>{var h=t+r;b[e+v*4>>2]=h,oi(i,h),r+=i.length+1}),0},li=(e,t)=>{var r=sa();b[e>>2]=r.length;var i=0;return r.forEach(v=>i+=v.length+1),b[t>>2]=i,0},si=e=>e,_a=e=>e%4===0&&(e%100!==0||e%400===0),ui=(e,t)=>{for(var r=0,i=0;i<=t;r+=e[i++]);return r},In=[31,29,31,30,31,30,31,31,30,31,30,31],wn=[31,28,31,30,31,30,31,31,30,31,30,31],di=(e,t)=>{for(var r=new Date(e.getTime());t>0;){var i=_a(r.getFullYear()),v=r.getMonth(),h=(i?In:wn)[v];if(t>h-r.getDate())t-=h-r.getDate()+1,r.setDate(1),v<11?r.setMonth(v+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1));else return r.setDate(r.getDate()+t),r}return r};function ci(e,t,r){var i=Sn(e)+1,v=new Array(i);return _n(e,v,0,v.length),v}var mi=(e,t)=>{Q.set(e,t)},fi=(e,t,r,i)=>{var v=b[i+40>>2],h={tm_sec:Y[i>>2],tm_min:Y[i+4>>2],tm_hour:Y[i+8>>2],tm_mday:Y[i+12>>2],tm_mon:Y[i+16>>2],tm_year:Y[i+20>>2],tm_wday:Y[i+24>>2],tm_yday:Y[i+28>>2],tm_isdst:Y[i+32>>2],tm_gmtoff:Y[i+36>>2],tm_zone:v?za(v):""},T=za(r),_={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var w in _)T=T.replace(new RegExp(w,"g"),_[w]);var V=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],N=["January","February","March","April","May","June","July","August","September","October","November","December"];function ee(O,W,we){for(var Pe=typeof O=="number"?O.toString():O||"";Pe.length<W;)Pe=we[0]+Pe;return Pe}function te(O,W){return ee(O,W,"0")}function re(O,W){function we(Kt){return Kt<0?-1:Kt>0?1:0}var Pe;return(Pe=we(O.getFullYear()-W.getFullYear()))===0&&(Pe=we(O.getMonth()-W.getMonth()))===0&&(Pe=we(O.getDate()-W.getDate())),Pe}function Se(O){switch(O.getDay()){case 0:return new Date(O.getFullYear()-1,11,29);case 1:return O;case 2:return new Date(O.getFullYear(),0,3);case 3:return new Date(O.getFullYear(),0,2);case 4:return new Date(O.getFullYear(),0,1);case 5:return new Date(O.getFullYear()-1,11,31);case 6:return new Date(O.getFullYear()-1,11,30)}}function Ie(O){var W=di(new Date(O.tm_year+1900,0,1),O.tm_yday),we=new Date(W.getFullYear(),0,4),Pe=new Date(W.getFullYear()+1,0,4),Kt=Se(we),Da=Se(Pe);return re(Kt,W)<=0?re(Da,W)<=0?W.getFullYear()+1:W.getFullYear():W.getFullYear()-1}var ye={"%a":O=>V[O.tm_wday].substring(0,3),"%A":O=>V[O.tm_wday],"%b":O=>N[O.tm_mon].substring(0,3),"%B":O=>N[O.tm_mon],"%C":O=>{var W=O.tm_year+1900;return te(W/100|0,2)},"%d":O=>te(O.tm_mday,2),"%e":O=>ee(O.tm_mday,2," "),"%g":O=>Ie(O).toString().substring(2),"%G":O=>Ie(O),"%H":O=>te(O.tm_hour,2),"%I":O=>{var W=O.tm_hour;return W==0?W=12:W>12&&(W-=12),te(W,2)},"%j":O=>te(O.tm_mday+ui(_a(O.tm_year+1900)?In:wn,O.tm_mon-1),3),"%m":O=>te(O.tm_mon+1,2),"%M":O=>te(O.tm_min,2),"%n":()=>`
`,"%p":O=>O.tm_hour>=0&&O.tm_hour<12?"AM":"PM","%S":O=>te(O.tm_sec,2),"%t":()=>"	","%u":O=>O.tm_wday||7,"%U":O=>{var W=O.tm_yday+7-O.tm_wday;return te(Math.floor(W/7),2)},"%V":O=>{var W=Math.floor((O.tm_yday+7-(O.tm_wday+6)%7)/7);if((O.tm_wday+371-O.tm_yday-2)%7<=2&&W++,W){if(W==53){var we=(O.tm_wday+371-O.tm_yday)%7;we!=4&&(we!=3||!_a(O.tm_year))&&(W=1)}}else{W=52;var Pe=(O.tm_wday+7-O.tm_yday-1)%7;(Pe==4||Pe==5&&_a(O.tm_year%400-1))&&W++}return te(W,2)},"%w":O=>O.tm_wday,"%W":O=>{var W=O.tm_yday+7-(O.tm_wday+6)%7;return te(Math.floor(W/7),2)},"%y":O=>(O.tm_year+1900).toString().substring(2),"%Y":O=>O.tm_year+1900,"%z":O=>{var W=O.tm_gmtoff,we=W>=0;return W=Math.abs(W)/60,W=W/60*100+W%60,(we?"+":"-")+("0000"+W).slice(-4)},"%Z":O=>O.tm_zone,"%%":()=>"%"};T=T.replace(/%%/g,"\0\0");for(var w in ye)T.includes(w)&&(T=T.replace(new RegExp(w,"g"),ye[w](h)));T=T.replace(/\0\0/g,"%");var Le=ci(T);return Le.length>t?0:(mi(Le,e),Le.length-1)},vi=(e,t,r,i,v)=>fi(e,t,r,i);Ht=n.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Wt(),Ut=n.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},Qr(),Pt(),oo(),hn=n.UnboundTypeError=uo(Error,"UnboundTypeError"),po(),go();var pi={s:va,u:Nt,b:$a,g:Ue,q:La,J:jt,f:Fa,V:pa,d:Vt,da:Na,Q:xa,_:Te,ca:co,ba:fo,w:vo,Y:ho,x:To,h:bo,L:So,M:Do,t:Eo,o:Io,K:Oo,C:Lo,A:Fo,ea:No,$:xo,R:jo,ha:Ga,fa:Ho,Z:Jo,N:Ko,O:Qo,aa:Xo,B:Zo,X:ei,W:ni,T:ii,U:li,E:ki,D:Ti,F:Oi,n:Ri,a:yi,e:_i,m:Ui,k:Di,H:wi,v:Ei,G:Ci,z:Vi,P:$i,l:Si,j:bi,c:hi,p:gi,I:Ii,r:Mi,i:Ai,y:Pi,ga:si,S:vi},ke=Ft(),bt=n._free=e=>(bt=n._free=ke.ka)(e),Qa=n._malloc=e=>(Qa=n._malloc=ke.la)(e),Cn=e=>(Cn=ke.na)(e),_e=(e,t)=>(_e=ke.oa)(e,t),ua=e=>(ua=ke.pa)(e),Ae=()=>(Ae=ke.qa)(),Ee=e=>(Ee=ke.ra)(e),On=e=>(On=ke.sa)(e),kn=e=>(kn=ke.ta)(e),Rn=(e,t,r)=>(Rn=ke.ua)(e,t,r),Mn=e=>(Mn=ke.va)(e);n.dynCall_viijii=(e,t,r,i,v,h,T)=>(n.dynCall_viijii=ke.wa)(e,t,r,i,v,h,T);var Vn=n.dynCall_jiiii=(e,t,r,i,v)=>(Vn=n.dynCall_jiiii=ke.xa)(e,t,r,i,v);n.dynCall_iiiiij=(e,t,r,i,v,h,T)=>(n.dynCall_iiiiij=ke.ya)(e,t,r,i,v,h,T),n.dynCall_iiiiijj=(e,t,r,i,v,h,T,_,w)=>(n.dynCall_iiiiijj=ke.za)(e,t,r,i,v,h,T,_,w),n.dynCall_iiiiiijj=(e,t,r,i,v,h,T,_,w,V)=>(n.dynCall_iiiiiijj=ke.Aa)(e,t,r,i,v,h,T,_,w,V);function yi(e,t){var r=Ae();try{return De(e)(t)}catch(i){if(Ee(r),i!==i+0)throw i;_e(1,0)}}function gi(e,t,r,i){var v=Ae();try{De(e)(t,r,i)}catch(h){if(Ee(v),h!==h+0)throw h;_e(1,0)}}function hi(e,t,r){var i=Ae();try{De(e)(t,r)}catch(v){if(Ee(i),v!==v+0)throw v;_e(1,0)}}function Ui(e,t,r,i){var v=Ae();try{return De(e)(t,r,i)}catch(h){if(Ee(v),h!==h+0)throw h;_e(1,0)}}function Ti(e,t,r,i,v){var h=Ae();try{return De(e)(t,r,i,v)}catch(T){if(Ee(h),T!==T+0)throw T;_e(1,0)}}function bi(e,t){var r=Ae();try{De(e)(t)}catch(i){if(Ee(r),i!==i+0)throw i;_e(1,0)}}function _i(e,t,r){var i=Ae();try{return De(e)(t,r)}catch(v){if(Ee(i),v!==v+0)throw v;_e(1,0)}}function Si(e){var t=Ae();try{De(e)()}catch(r){if(Ee(t),r!==r+0)throw r;_e(1,0)}}function Di(e,t,r,i,v){var h=Ae();try{return De(e)(t,r,i,v)}catch(T){if(Ee(h),T!==T+0)throw T;_e(1,0)}}function Ai(e,t,r,i,v,h,T,_,w,V,N){var ee=Ae();try{De(e)(t,r,i,v,h,T,_,w,V,N)}catch(te){if(Ee(ee),te!==te+0)throw te;_e(1,0)}}function Ei(e,t,r,i,v,h,T){var _=Ae();try{return De(e)(t,r,i,v,h,T)}catch(w){if(Ee(_),w!==w+0)throw w;_e(1,0)}}function Ii(e,t,r,i,v){var h=Ae();try{De(e)(t,r,i,v)}catch(T){if(Ee(h),T!==T+0)throw T;_e(1,0)}}function wi(e,t,r,i,v,h){var T=Ae();try{return De(e)(t,r,i,v,h)}catch(_){if(Ee(T),_!==_+0)throw _;_e(1,0)}}function Ci(e,t,r,i,v,h,T,_){var w=Ae();try{return De(e)(t,r,i,v,h,T,_)}catch(V){if(Ee(w),V!==V+0)throw V;_e(1,0)}}function Oi(e,t,r,i){var v=Ae();try{return De(e)(t,r,i)}catch(h){if(Ee(v),h!==h+0)throw h;_e(1,0)}}function ki(e,t,r,i){var v=Ae();try{return De(e)(t,r,i)}catch(h){if(Ee(v),h!==h+0)throw h;_e(1,0)}}function Ri(e){var t=Ae();try{return De(e)()}catch(r){if(Ee(t),r!==r+0)throw r;_e(1,0)}}function Mi(e,t,r,i,v,h,T,_){var w=Ae();try{De(e)(t,r,i,v,h,T,_)}catch(V){if(Ee(w),V!==V+0)throw V;_e(1,0)}}function Vi(e,t,r,i,v,h,T,_,w,V,N,ee){var te=Ae();try{return De(e)(t,r,i,v,h,T,_,w,V,N,ee)}catch(re){if(Ee(te),re!==re+0)throw re;_e(1,0)}}function Pi(e,t,r,i,v,h,T,_,w,V,N,ee,te,re,Se,Ie){var ye=Ae();try{De(e)(t,r,i,v,h,T,_,w,V,N,ee,te,re,Se,Ie)}catch(Le){if(Ee(ye),Le!==Le+0)throw Le;_e(1,0)}}function $i(e,t,r,i,v){var h=Ae();try{return Vn(e,t,r,i,v)}catch(T){if(Ee(h),T!==T+0)throw T;_e(1,0)}}var Sa;Xe=function e(){Sa||Pn(),Sa||(Xe=e)};function Pn(){if(Fe>0||(de(),Fe>0))return;function e(){Sa||(Sa=!0,n.calledRun=!0,!j&&(Dt(),l(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),mt()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),e()},1)):e()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Pn(),o.ready}})();function _u(a){return mn(fn,a)}async function Su(a,o){return Tu(fn,a,o)}async function Du(a,o){return bu(fn,a,o)}var ca;class Qn extends EventTarget{constructor(o={}){var n;super(),Ks(this,ca,void 0);try{const l=(n=o==null?void 0:o.formats)==null?void 0:n.filter(c=>c!=="unknown");if((l==null?void 0:l.length)===0)throw new TypeError("Hint option provided, but is empty.");l==null||l.forEach(c=>{if(!Ia.has(c))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${c}' is not a valid enum value of type BarcodeFormat.`)}),Qs(this,ca,l??[]),_u().then(c=>{this.dispatchEvent(new CustomEvent("load",{detail:c}))}).catch(c=>{this.dispatchEvent(new CustomEvent("error",{detail:c}))})}catch(l){throw qn(l,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return Xs.filter(o=>o!=="unknown")}async detect(o){try{const n=await ou(o);if(n===null)return[];let l;try{kr(n)?l=await Su(n,{tryHarder:!0,formats:Wn(this,ca).map(c=>Ia.get(c))}):l=await Du(n,{tryHarder:!0,formats:Wn(this,ca).map(c=>Ia.get(c))})}catch(c){throw console.error(c),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return l.map(c=>{const{topLeft:{x:p,y},topRight:{x:u,y:d},bottomLeft:{x:f,y:g},bottomRight:{x:D,y:C}}=c.position,$=Math.min(p,u,f,D),M=Math.min(y,d,g,C),j=Math.max(p,u,f,D),Q=Math.max(y,d,g,C);return{boundingBox:new DOMRectReadOnly($,M,j-$,Q-M),rawValue:c.text,format:Zs(c.format),cornerPoints:[{x:p,y},{x:u,y:d},{x:D,y:C},{x:f,y:g}]}})}catch(n){throw qn(n,"Failed to execute 'detect' on 'BarcodeDetector'")}}}ca=new WeakMap;const Pr=(a,o,n="error")=>{let l,c;const p=new Promise((y,u)=>{l=y,c=u,a.addEventListener(o,l),a.addEventListener(n,c)});return p.finally(()=>{a.removeEventListener(o,l),a.removeEventListener(n,c)}),p},Xn=a=>new Promise(o=>setTimeout(o,a));class $r extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class Au extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}class Eu extends Error{constructor(){super("Loading camera stream timed out after 6 seconds. If you are on iOS in PWA mode, this is a known issue (see https://github.com/gruhn/vue-qrcode-reader/issues/298)"),this.name="StreamLoadTimeoutError"}}let Lr;async function Iu(a){if(window.BarcodeDetector===void 0)return console.debug("[vue-qrcode-reader] Native BarcodeDetector not supported. Will use polyfill."),new Qn({formats:a});const o=await window.BarcodeDetector.getSupportedFormats(),n=a.filter(l=>!o.includes(l));return n.length>0?(console.debug(`[vue-qrcode-reader] Native BarcodeDetector does not support formats ${JSON.stringify(n)}. Will use polyfill.`),new Qn({formats:a})):(console.debug("[vue-qrcode-reader] Will use native BarcodeDetector."),new window.BarcodeDetector({formats:a}))}async function Fr(a){Lr=await Iu(a)}const wu=async(a,{detectHandler:o,locateHandler:n,minDelay:l,formats:c})=>{console.debug("[vue-qrcode-reader] start scanning"),await Fr(c);const p=y=>async u=>{if(a.readyState===0)console.debug("[vue-qrcode-reader] stop scanning: video element readyState is 0");else{const{lastScanned:d,contentBefore:f,lastScanHadContent:g}=y;if(u-d<l)window.requestAnimationFrame(p(y));else{const D=await Lr.detect(a),C=D.some(j=>!f.includes(j.rawValue));C&&o(D);const $=D.length>0;$&&n(D),!$&&g&&n(D);const M={lastScanned:u,lastScanHadContent:$,contentBefore:C?D.map(j=>j.rawValue):f};window.requestAnimationFrame(p(M))}}};p({lastScanned:performance.now(),contentBefore:[],lastScanHadContent:!1})(performance.now())};var Nr={},qe={};Object.defineProperty(qe,"__esModule",{value:!0});qe.compactObject=Yr;qe.deprecated=Lu;var Cu=qe.detectBrowser=Fu;qe.disableLog=Vu;qe.disableWarnings=Pu;qe.extractVersion=wa;qe.filterStats=Nu;qe.log=$u;qe.walkStats=Ra;qe.wrapPeerConnectionEvent=Mu;function Ou(a,o,n){return o=ku(o),o in a?Object.defineProperty(a,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[o]=n,a}function ku(a){var o=Ru(a,"string");return kt(o)==="symbol"?o:String(o)}function Ru(a,o){if(kt(a)!=="object"||a===null)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var l=n.call(a,o||"default");if(kt(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(a)}function kt(a){"@babel/helpers - typeof";return kt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},kt(a)}var xr=!0,jr=!0;function wa(a,o,n){var l=a.match(o);return l&&l.length>=n&&parseInt(l[n],10)}function Mu(a,o,n){if(a.RTCPeerConnection){var l=a.RTCPeerConnection.prototype,c=l.addEventListener;l.addEventListener=function(y,u){if(y!==o)return c.apply(this,arguments);var d=function(f){var g=n(f);g&&(u.handleEvent?u.handleEvent(g):u(g))};return this._eventMap=this._eventMap||{},this._eventMap[o]||(this._eventMap[o]=new Map),this._eventMap[o].set(u,d),c.apply(this,[y,d])};var p=l.removeEventListener;l.removeEventListener=function(y,u){if(y!==o||!this._eventMap||!this._eventMap[o])return p.apply(this,arguments);if(!this._eventMap[o].has(u))return p.apply(this,arguments);var d=this._eventMap[o].get(u);return this._eventMap[o].delete(u),this._eventMap[o].size===0&&delete this._eventMap[o],Object.keys(this._eventMap).length===0&&delete this._eventMap,p.apply(this,[y,d])},Object.defineProperty(l,"on"+o,{get:function(){return this["_on"+o]},set:function(y){this["_on"+o]&&(this.removeEventListener(o,this["_on"+o]),delete this["_on"+o]),y&&this.addEventListener(o,this["_on"+o]=y)},enumerable:!0,configurable:!0})}}function Vu(a){return typeof a!="boolean"?new Error("Argument type: "+kt(a)+". Please use a boolean."):(xr=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function Pu(a){return typeof a!="boolean"?new Error("Argument type: "+kt(a)+". Please use a boolean."):(jr=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function $u(){if((typeof window>"u"?"undefined":kt(window))==="object"){if(xr)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Lu(a,o){jr&&console.warn(a+" is deprecated, please use "+o+" instead.")}function Fu(a){var o={browser:null,version:null};if(typeof a>"u"||!a.navigator||!a.navigator.userAgent)return o.browser="Not a browser.",o;var n=a.navigator;if(n.mozGetUserMedia)o.browser="firefox",o.version=wa(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)o.browser="chrome",o.version=wa(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(a.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))o.browser="safari",o.version=wa(n.userAgent,/AppleWebKit\/(\d+)\./,1),o.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype;else return o.browser="Not a supported browser.",o;return o}function Zn(a){return Object.prototype.toString.call(a)==="[object Object]"}function Yr(a){return Zn(a)?Object.keys(a).reduce(function(o,n){var l=Zn(a[n]),c=l?Yr(a[n]):a[n],p=l&&!Object.keys(c).length;return c===void 0||p?o:Object.assign(o,Ou({},n,c))},{}):a}function Ra(a,o,n){!o||n.has(o.id)||(n.set(o.id,o),Object.keys(o).forEach(function(l){l.endsWith("Id")?Ra(a,a.get(o[l]),n):l.endsWith("Ids")&&o[l].forEach(function(c){Ra(a,a.get(c),n)})}))}function Nu(a,o,n){var l=n?"outbound-rtp":"inbound-rtp",c=new Map;if(o===null)return c;var p=[];return a.forEach(function(y){y.type==="track"&&y.trackIdentifier===o.id&&p.push(y)}),p.forEach(function(y){a.forEach(function(u){u.type===l&&u.trackId===y.id&&Ra(a,u,c)})}),c}Object.defineProperty(Nr,"__esModule",{value:!0});var xu=Nr.shimGetUserMedia=Bu,ju=Yu(qe);function Br(a){if(typeof WeakMap!="function")return null;var o=new WeakMap,n=new WeakMap;return(Br=function(l){return l?n:o})(a)}function Yu(a,o){if(a.__esModule)return a;if(a===null||Ct(a)!=="object"&&typeof a!="function")return{default:a};var n=Br(o);if(n&&n.has(a))return n.get(a);var l={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in a)if(p!=="default"&&Object.prototype.hasOwnProperty.call(a,p)){var y=c?Object.getOwnPropertyDescriptor(a,p):null;y&&(y.get||y.set)?Object.defineProperty(l,p,y):l[p]=a[p]}return l.default=a,n&&n.set(a,l),l}function Ct(a){"@babel/helpers - typeof";return Ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Ct(a)}var er=ju.log;function Bu(a,o){var n=a&&a.navigator;if(n.mediaDevices){var l=function(d){if(Ct(d)!=="object"||d.mandatory||d.optional)return d;var f={};return Object.keys(d).forEach(function(g){if(!(g==="require"||g==="advanced"||g==="mediaSource")){var D=Ct(d[g])==="object"?d[g]:{ideal:d[g]};D.exact!==void 0&&typeof D.exact=="number"&&(D.min=D.max=D.exact);var C=function(M,j){return M?M+j.charAt(0).toUpperCase()+j.slice(1):j==="deviceId"?"sourceId":j};if(D.ideal!==void 0){f.optional=f.optional||[];var $={};typeof D.ideal=="number"?($[C("min",g)]=D.ideal,f.optional.push($),$={},$[C("max",g)]=D.ideal,f.optional.push($)):($[C("",g)]=D.ideal,f.optional.push($))}D.exact!==void 0&&typeof D.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[C("",g)]=D.exact):["min","max"].forEach(function(M){D[M]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[C(M,g)]=D[M])})}}),d.advanced&&(f.optional=(f.optional||[]).concat(d.advanced)),f},c=function(d,f){if(o.version>=61)return f(d);if(d=JSON.parse(JSON.stringify(d)),d&&Ct(d.audio)==="object"){var g=function(M,j,Q){j in M&&!(Q in M)&&(M[Q]=M[j],delete M[j])};d=JSON.parse(JSON.stringify(d)),g(d.audio,"autoGainControl","googAutoGainControl"),g(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=l(d.audio)}if(d&&Ct(d.video)==="object"){var D=d.video.facingMode;D=D&&(Ct(D)==="object"?D:{ideal:D});var C=o.version<66;if(D&&(D.exact==="user"||D.exact==="environment"||D.ideal==="user"||D.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!C)){delete d.video.facingMode;var $;if(D.exact==="environment"||D.ideal==="environment"?$=["back","rear"]:(D.exact==="user"||D.ideal==="user")&&($=["front"]),$)return n.mediaDevices.enumerateDevices().then(function(M){M=M.filter(function(Q){return Q.kind==="videoinput"});var j=M.find(function(Q){return $.some(function(q){return Q.label.toLowerCase().includes(q)})});return!j&&M.length&&$.includes("back")&&(j=M[M.length-1]),j&&(d.video.deviceId=D.exact?{exact:j.deviceId}:{ideal:j.deviceId}),d.video=l(d.video),er("chrome: "+JSON.stringify(d)),f(d)})}d.video=l(d.video)}return er("chrome: "+JSON.stringify(d)),f(d)},p=function(d){return o.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},y=function(d,f,g){c(d,function(D){n.webkitGetUserMedia(D,f,function(C){g&&g(p(C))})})};if(n.getUserMedia=y.bind(n),n.mediaDevices.getUserMedia){var u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(d){return c(d,function(f){return u(f).then(function(g){if(f.audio&&!g.getAudioTracks().length||f.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(function(D){D.stop()}),new DOMException("","NotFoundError");return g},function(g){return Promise.reject(p(g))})})}}}}var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});var Hu=Hr.shimGetUserMedia=qu,Gu=Wu(qe);function Gr(a){if(typeof WeakMap!="function")return null;var o=new WeakMap,n=new WeakMap;return(Gr=function(l){return l?n:o})(a)}function Wu(a,o){if(a.__esModule)return a;if(a===null||Xt(a)!=="object"&&typeof a!="function")return{default:a};var n=Gr(o);if(n&&n.has(a))return n.get(a);var l={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in a)if(p!=="default"&&Object.prototype.hasOwnProperty.call(a,p)){var y=c?Object.getOwnPropertyDescriptor(a,p):null;y&&(y.get||y.set)?Object.defineProperty(l,p,y):l[p]=a[p]}return l.default=a,n&&n.set(a,l),l}function Xt(a){"@babel/helpers - typeof";return Xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Xt(a)}function qu(a,o){var n=a&&a.navigator,l=a&&a.MediaStreamTrack;if(n.getUserMedia=function(d,f,g){Gu.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(d).then(f,g)},!(o.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var c=function(d,f,g){f in d&&!(g in d)&&(d[g]=d[f],delete d[f])},p=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(d){return Xt(d)==="object"&&Xt(d.audio)==="object"&&(d=JSON.parse(JSON.stringify(d)),c(d.audio,"autoGainControl","mozAutoGainControl"),c(d.audio,"noiseSuppression","mozNoiseSuppression")),p(d)},l&&l.prototype.getSettings){var y=l.prototype.getSettings;l.prototype.getSettings=function(){var d=y.apply(this,arguments);return c(d,"mozAutoGainControl","autoGainControl"),c(d,"mozNoiseSuppression","noiseSuppression"),d}}if(l&&l.prototype.applyConstraints){var u=l.prototype.applyConstraints;l.prototype.applyConstraints=function(d){return this.kind==="audio"&&Xt(d)==="object"&&(d=JSON.parse(JSON.stringify(d)),c(d,"autoGainControl","mozAutoGainControl"),c(d,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[d])}}}}var ct={};Object.defineProperty(ct,"__esModule",{value:!0});ct.shimAudioContext=nd;ct.shimCallbacksAPI=Xu;ct.shimConstraints=zr;ct.shimCreateOfferLegacy=ad;var zu=ct.shimGetUserMedia=Zu;ct.shimLocalStreamsAPI=Ku;ct.shimRTCIceServerUrls=ed;ct.shimRemoteStreamsAPI=Qu;ct.shimTrackEventTransceiver=td;var Wr=Ju(qe);function qr(a){if(typeof WeakMap!="function")return null;var o=new WeakMap,n=new WeakMap;return(qr=function(l){return l?n:o})(a)}function Ju(a,o){if(a.__esModule)return a;if(a===null||Rt(a)!=="object"&&typeof a!="function")return{default:a};var n=qr(o);if(n&&n.has(a))return n.get(a);var l={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in a)if(p!=="default"&&Object.prototype.hasOwnProperty.call(a,p)){var y=c?Object.getOwnPropertyDescriptor(a,p):null;y&&(y.get||y.set)?Object.defineProperty(l,p,y):l[p]=a[p]}return l.default=a,n&&n.set(a,l),l}function Rt(a){"@babel/helpers - typeof";return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Rt(a)}function Ku(a){if(!(Rt(a)!=="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){var o=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(n){var l=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(function(c){return o.call(l,c,n)}),n.getVideoTracks().forEach(function(c){return o.call(l,c,n)})},a.RTCPeerConnection.prototype.addTrack=function(n){for(var l=this,c=arguments.length,p=new Array(c>1?c-1:0),y=1;y<c;y++)p[y-1]=arguments[y];return p&&p.forEach(function(u){l._localStreams?l._localStreams.includes(u)||l._localStreams.push(u):l._localStreams=[u]}),o.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(n){var l=this;this._localStreams||(this._localStreams=[]);var c=this._localStreams.indexOf(n);if(c!==-1){this._localStreams.splice(c,1);var p=n.getTracks();this.getSenders().forEach(function(y){p.includes(y.track)&&l.removeTrack(y)})}})}}function Qu(a){if(!(Rt(a)!=="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(n){var l=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(function(p){if(l._remoteStreams||(l._remoteStreams=[]),!l._remoteStreams.includes(p)){l._remoteStreams.push(p);var y=new Event("addstream");y.stream=p,l.dispatchEvent(y)}})})}});var o=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(function(c){if(n._remoteStreams||(n._remoteStreams=[]),!(n._remoteStreams.indexOf(c)>=0)){n._remoteStreams.push(c);var p=new Event("addstream");p.stream=c,n.dispatchEvent(p)}})}),o.apply(n,arguments)}}}function Xu(a){if(!(Rt(a)!=="object"||!a.RTCPeerConnection)){var o=a.RTCPeerConnection.prototype,n=o.createOffer,l=o.createAnswer,c=o.setLocalDescription,p=o.setRemoteDescription,y=o.addIceCandidate;o.createOffer=function(d,f){var g=arguments.length>=2?arguments[2]:arguments[0],D=n.apply(this,[g]);return f?(D.then(d,f),Promise.resolve()):D},o.createAnswer=function(d,f){var g=arguments.length>=2?arguments[2]:arguments[0],D=l.apply(this,[g]);return f?(D.then(d,f),Promise.resolve()):D};var u=function(d,f,g){var D=c.apply(this,[d]);return g?(D.then(f,g),Promise.resolve()):D};o.setLocalDescription=u,u=function(d,f,g){var D=p.apply(this,[d]);return g?(D.then(f,g),Promise.resolve()):D},o.setRemoteDescription=u,u=function(d,f,g){var D=y.apply(this,[d]);return g?(D.then(f,g),Promise.resolve()):D},o.addIceCandidate=u}}function Zu(a){var o=a&&a.navigator;if(o.mediaDevices&&o.mediaDevices.getUserMedia){var n=o.mediaDevices,l=n.getUserMedia.bind(n);o.mediaDevices.getUserMedia=function(c){return l(zr(c))}}!o.getUserMedia&&o.mediaDevices&&o.mediaDevices.getUserMedia&&(o.getUserMedia=(function(c,p,y){o.mediaDevices.getUserMedia(c).then(p,y)}).bind(o))}function zr(a){return a&&a.video!==void 0?Object.assign({},a,{video:Wr.compactObject(a.video)}):a}function ed(a){if(a.RTCPeerConnection){var o=a.RTCPeerConnection;a.RTCPeerConnection=function(n,l){if(n&&n.iceServers){for(var c=[],p=0;p<n.iceServers.length;p++){var y=n.iceServers[p];y.urls===void 0&&y.url?(Wr.deprecated("RTCIceServer.url","RTCIceServer.urls"),y=JSON.parse(JSON.stringify(y)),y.urls=y.url,delete y.url,c.push(y)):c.push(n.iceServers[p])}n.iceServers=c}return new o(n,l)},a.RTCPeerConnection.prototype=o.prototype,"generateCertificate"in o&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return o.generateCertificate}})}}function td(a){Rt(a)==="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function ad(a){var o=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);var l=this.getTransceivers().find(function(p){return p.receiver.track.kind==="audio"});n.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):n.offerToReceiveAudio===!0&&!l&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);var c=this.getTransceivers().find(function(p){return p.receiver.track.kind==="video"});n.offerToReceiveVideo===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):n.offerToReceiveVideo===!0&&!c&&this.addTransceiver("video",{direction:"recvonly"})}return o.apply(this,arguments)}}function nd(a){Rt(a)!=="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}const rd=a=>{let o=!1,n;return(...l)=>(o||(n=a(l),o=!0),n)};function ut(a,o){if(a===!1)throw new Error(o??"assertion failure")}function tr(a){throw new Error("this code should be unreachable")}const od=rd(()=>{const a=Cu(window);switch(a.browser){case"chrome":xu(window,a);break;case"firefox":Hu(window,a);break;case"safari":zu(window,a);break;default:throw new $r}});let Zt=Promise.resolve({type:"stop",data:{}});async function ar(a,o,n){var l,c,p;if(console.debug("[vue-qrcode-reader] starting camera with constraints: ",JSON.stringify(o)),window.isSecureContext!==!0)throw new Au;if(((l=navigator==null?void 0:navigator.mediaDevices)==null?void 0:l.getUserMedia)===void 0)throw new $r;od(),console.debug("[vue-qrcode-reader] calling getUserMedia");const y=await navigator.mediaDevices.getUserMedia({audio:!1,video:o});a.srcObject!==void 0?a.srcObject=y:a.mozSrcObject!==void 0?a.mozSrcObject=y:window.URL.createObjectURL?a.src=window.URL.createObjectURL(y):window.webkitURL?a.src=window.webkitURL.createObjectURL(y):a.src=y.id,a.play(),console.debug("[vue-qrcode-reader] waiting for video element to load"),await Promise.race([Pr(a,"loadeddata"),Xn(6e3).then(()=>{throw new Eu})]),console.debug("[vue-qrcode-reader] video element loaded"),await Xn(500);const[u]=y.getVideoTracks(),d=(p=(c=u==null?void 0:u.getCapabilities)==null?void 0:c.call(u))!=null?p:{};let f=!1;return n&&d.torch&&(await u.applyConstraints({advanced:[{torch:!0}]}),f=!0),console.debug("[vue-qrcode-reader] camera ready"),{type:"start",data:{videoEl:a,stream:y,capabilities:d,constraints:o,isTorchOn:f}}}async function id(a,{constraints:o,torch:n,restart:l=!1}){Zt=Zt.then(p=>{if(p.type==="start"){const{data:{videoEl:y,stream:u,constraints:d,isTorchOn:f}}=p;return!l&&a===y&&o===d&&n===f?p:Jr(y,u,f).then(()=>ar(a,o,n))}else if(p.type==="stop"||p.type==="failed")return ar(a,o,n);tr()}).catch(p=>(console.debug(`[vue-qrcode-reader] starting camera failed with "${p}"`),{type:"failed",error:p}));const c=await Zt;if(c.type==="stop")throw new Error("Something went wrong with the camera task queue (start task).");if(c.type==="failed")throw c.error;if(c.type==="start")return c.data.capabilities;tr()}async function Jr(a,o,n){console.debug("[vue-qrcode-reader] stopping camera"),a.src="",a.srcObject=null,a.load(),await Pr(a,"error");for(const l of o.getTracks())n!=null||await l.applyConstraints({advanced:[{torch:!1}]}),o.removeTrack(l),l.stop();return{type:"stop",data:{}}}async function Aa(){if(Zt=Zt.then(a=>{if(a.type==="stop"||a.type==="failed")return a;const{data:{videoEl:o,stream:n,isTorchOn:l}}=a;return Jr(o,n,l)}),(await Zt).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")}const ld=xe({__name:"QrcodeStream",props:{constraints:{default:()=>({facingMode:"environment"})},formats:{default:()=>["qr_code"]},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function,default:void 0}},emits:["detect","camera-on","camera-off","error"],setup(a,{emit:o}){const n=a,l=o,c=P(n.constraints),p=P(n.formats);Ge(()=>n.constraints,(k,Y)=>{JSON.stringify(k)!==JSON.stringify(Y)&&(c.value=k)},{deep:!0}),Ge(()=>n.formats,(k,Y)=>{JSON.stringify(k)!==JSON.stringify(Y)&&(p.value=k)},{deep:!0});const y=P(),u=P(),d=P(),f=P(!1),g=P(!1);ir(()=>{g.value=!0}),Yi(()=>{Aa()});const D=Qt(()=>({torch:n.torch,constraints:c.value,shouldStream:g.value&&!n.paused}));Ge(D,async k=>{const Y=d.value;ut(Y!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus video element should always be defined.");const b=y.value;ut(b!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus canvas should always be defined.");const ce=b.getContext("2d");if(ut(ce!==null,"if cavnas is defined, canvas 2d context should also be non-null"),k.shouldStream){Aa(),f.value=!1;try{const be=await id(Y,k);g.value?(f.value=!0,l("camera-on",be)):await Aa()}catch(be){l("error",be)}}else b.width=Y.videoWidth,b.height=Y.videoHeight,ce.drawImage(Y,0,0,Y.videoWidth,Y.videoHeight),Aa(),f.value=!1,l("camera-off")},{deep:!0}),Ge(p,async k=>{g.value&&await Fr(k)});const C=Qt(()=>D.value.shouldStream&&f.value);Ge(C,k=>{if(k){ut(y.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus pause frame canvas is defined"),$(y.value),ut(u.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus tracking canvas is defined"),$(u.value);const Y=()=>n.track===void 0?500:40;ut(d.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus video element is defined"),wu(d.value,{detectHandler:b=>l("detect",b),formats:p.value,locateHandler:M,minDelay:Y()})}});const $=k=>{const Y=k.getContext("2d");ut(Y!==null,"canvas 2d context should always be non-null"),Y.clearRect(0,0,k.width,k.height)},M=k=>{const Y=u.value;ut(Y!==void 0,"onLocate handler should only be called when component is mounted. Thus tracking canvas is always defined.");const b=d.value;if(ut(b!==void 0,"onLocate handler should only be called when component is mounted. Thus video element is always defined."),k.length===0||n.track===void 0)$(Y);else{const ce=b.offsetWidth,be=b.offsetHeight,L=b.videoWidth,E=b.videoHeight,F=Math.max(ce/L,be/E),ne=L*F,de=E*F,Dt=ne/L,mt=de/E,at=(ce-ne)/2,At=(be-de)/2,He=({x:Ye,y:Be})=>({x:Math.floor(Ye*Dt),y:Math.floor(Be*mt)}),Fe=({x:Ye,y:Be})=>({x:Math.floor(Ye+at),y:Math.floor(Be+At)}),Xe=k.map(Ye=>{const{boundingBox:Be,cornerPoints:Et}=Ye,{x:vt,y:ze}=Fe(He({x:Be.x,y:Be.y})),{x:pt,y:It}=He({x:Be.width,y:Be.height});return{...Ye,cornerPoints:Et.map(yt=>Fe(He(yt))),boundingBox:DOMRectReadOnly.fromRect({x:vt,y:ze,width:pt,height:It})}});Y.width=b.offsetWidth,Y.height=b.offsetHeight;const ft=Y.getContext("2d");ut(ft!==null,"canvas 2d context should always be non-null"),n.track(Xe,ft)}},j={width:"100%",height:"100%",position:"relative","z-index":"0"},Q={width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},q={width:"100%",height:"100%","object-fit":"cover"},G=Qt(()=>C.value?q:{...q,visibility:"hidden",position:"absolute"});return(k,Y)=>(A(),z("div",{style:j},[le("video",{ref_key:"videoRef",ref:d,style:Bi(G.value),autoplay:"",muted:"",playsinline:""},null,4),Hi(le("canvas",{id:"qrcode-stream-pause-frame",ref_key:"pauseFrameRef",ref:y,style:q},null,512),[[Gi,!C.value]]),le("canvas",{id:"qrcode-stream-tracking-layer",ref_key:"trackingLayerRef",ref:u,style:Q},null,512),le("div",{style:Q},[Wi(k.$slots,"default")])]))}}),sd=xe({__name:"QRCodeReader",emits:["scan"],setup(a,{emit:o}){const n=o,l=qi("inputBox"),c=P("keyboard"),p=P({facingMode:"environment"}),y=[{label:"Rear Camera",constraints:{facingMode:"environment"}},{label:"Front Camera",constraints:{facingMode:"user"}}],u=P(y),d=P({aztec:!0,code_128:!0,code_39:!0,code_93:!0,codabar:!0,databar:!0,databar_expanded:!0,data_matrix:!0,dx_film_edge:!0,ean_13:!0,ean_8:!0,itf:!0,maxi_code:!0,micro_qr_code:!0,pdf417:!0,qr_code:!0,rm_qr_code:!0,upc_a:!0,upc_e:!0,linear_codes:!0,matrix_codes:!0}),f=M=>{M.length>=1&&n("scan",M[0].rawValue)},g=async()=>{const j=(await navigator.mediaDevices.enumerateDevices()).filter(({kind:Q})=>Q==="videoinput");u.value=[...y,...j.map(({deviceId:Q,label:q})=>({label:`${q}`,constraints:{deviceId:Q}}))]},D=Qt(()=>Object.keys(d.value).filter(M=>d.value[M])),C=P(""),$=M=>{M.key==="Enter"?(n("scan",C.value),C.value=""):M.key.length===1&&(C.value+=M.key)};return or(()=>{window.removeEventListener("keydown",$)}),window.addEventListener("keydown",$),ir(()=>{l.value&&l.value.focus()}),(M,j)=>c.value==="keyboard"?(A(),z(ue,{key:0},[le("input",{ref_key:"inputBox",ref:l,type:"text",class:"opacity-0 w-0 h-0"},null,512),s(ge,null,{default:m(()=>[s(B,{class:"text-center"},{default:m(()=>[s(un,{icon:"mdi:mdi-qrcode-scan",size:"150"})]),_:1})]),_:1}),s(ge,null,{default:m(()=>[C.value?(A(),H(B,{key:0,class:"text-center"},{default:m(()=>[se(ae(C.value),1)]),_:1})):(A(),H(B,{key:1,class:"text-center"},{default:m(()=>j[3]||(j[3]=[le("small",null,"(Awaiting Input)",-1)])),_:1}))]),_:1}),s(ge,null,{default:m(()=>[s(B,{class:"text-center"},{default:m(()=>[s(ve,{onClick:j[0]||(j[0]=Q=>c.value="camera"),color:"primary"},{default:m(()=>j[4]||(j[4]=[se(" Use Camera ")])),_:1})]),_:1})]),_:1})],64)):c.value==="camera"?(A(),z(ue,{key:1},[s(ge,null,{default:m(()=>[s(B,{class:"text-center"},{default:m(()=>[s(x(ld),{onDetect:f,onCameraOn:g,constraints:p.value,formats:D.value,style:{"max-width":"400px"}},null,8,["constraints","formats"])]),_:1})]),_:1}),s(ge,null,{default:m(()=>[s(B,null,{default:m(()=>[s(he,{modelValue:p.value,"onUpdate:modelValue":j[1]||(j[1]=Q=>p.value=Q),items:u.value,"item-title":"label","item-value":"constraints",label:"Select Camera","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1}),s(ge,null,{default:m(()=>[s(B,{class:"text-center"},{default:m(()=>[s(ve,{onClick:j[2]||(j[2]=Q=>c.value="keyboard"),color:"primary"},{default:m(()=>j[5]||(j[5]=[se(" Cancel ")])),_:1})]),_:1})]),_:1})],64)):oe("",!0)}}),ud=["colspan"],hc=xe({__name:"RegistrationsView",emits:["pageTitle"],async setup(a,{emit:o}){var ra,Oe,Ut;let n,l;const c=yl();o("pageTitle","Registration Manager");const y=zi(),u=rr(),d=P(!0);let f=((ra=y.params.convention)==null?void 0:ra.toString())||"";const g=P();g.value=([n,l]=Fn(()=>Pl()),n=await n,l(),n);const D=Mt(),C=Ca.getInstance(),{getLinkedFields:$}=bl(),M=P([]),j=P({ID:0,AdminLayoutUUID:St(),ConventionID:((Oe=g.value)==null?void 0:Oe.ID)||0,ConventionUUID:((Ut=g.value)==null?void 0:Ut.ConventionUUID)||Qe,Name:"Registration Table",RunnerLayoutUUID:Qe,Type:dt.ADMIN_LAYOUT_TABLE,Panels:[]}),Q=P([]),q=P([]),G=P([]),k=P([]),Y=P([]),b=P([]),ce=P(1),be=P(10),L=P([]),E=P(0),F=P(!1),ne=P(!1),de=P(""),Dt=P(""),mt=P(""),at=P(""),At=P(""),He=([n,l]=Fn(()=>{var U;return $(((U=g.value)==null?void 0:U.ConventionUUID)||Qe)}),n=await n,l(),n),Fe=P({FieldUUID:He.badge_name||Qe,Value:""}),Xe=P({FieldUUID:He.forename||Qe,Value:""}),ft=P({FieldUUID:He.surname||Qe,Value:""}),Ye=P({FieldUUID:He.dob||Qe,Value:""}),Be=P(new Map([[He.badge_name||Qe,Fe.value],[He.forename||Qe,Xe.value],[He.surname||Qe,ft.value],[He.dob||Qe,Ye.value]])),Et=P(""),vt=P(""),ze=P([]),pt=P([]),It=P([]),yt=P([]),Lt=P([]),Ft=P([]),Je=P(0),Re=P(),Ze=P(!1),va=P(!1),nt=P(!1),Nt=P(),xt=P(),Vt=P(),st=P(!1),$a=Va(),Ue=El(()=>{Dt.value=Date.now().toString()});Ge(de,U=>{const S=b.value.find(R=>R.uuid===U);if(S){const R=S.headers.find(I=>I.defaultSort===!0);R&&(L.value=[{key:R.key,order:"asc"}],ze.value=[{key:R.key,order:"asc"}])}jt({page:1,itemsPerPage:be.value,sortBy:ze.value})}),Ge(Je,U=>{U===8&&pa()}),Ge(Et,()=>{Ue()}),Ge(vt,()=>{Ue()});const La=()=>{if(Q.value=[],G.value=[],k.value=[],b.value=[],!!g.value){try{D.getConventionAdminLayoutByName(g.value.ConventionUUID,"Registration Table").then(U=>{if(Je.value+=1,U)j.value=U;else{if(!g.value)return;j.value.ConventionID=g.value.ID,j.value.ConventionUUID=g.value.ConventionUUID}})}catch{j.value.ConventionID=g.value.ID,j.value.ConventionUUID=g.value.ConventionUUID}try{D.getConventionAdminLayouts(g.value.ConventionUUID).then(U=>{Je.value+=1,U&&(U.forEach(S=>{S.Panels.sort((R,I)=>R.Order>I.Order?1:R.Order===I.Order?0:-1),S.Panels.forEach(R=>{R.Items.sort((I,Te)=>I.Order>Te.Order?1:I.Order===Te.Order?0:-1)})}),G.value=U)})}catch{}try{D.getConventionForms(g.value.ConventionUUID).then(U=>{Je.value+=1,U&&(Q.value=U)})}catch{}try{D.getConventionAccommodation(g.value.ConventionUUID).then(U=>{Je.value+=1,U&&(pt.value=U)})}catch{}try{D.getConventionVenues(g.value.ConventionUUID).then(U=>{Je.value+=1,U&&(Ft.value=U)})}catch{}try{D.getConventionExtras(g.value.ConventionUUID).then(U=>{Je.value+=1,U&&(It.value=U)})}catch{}try{D.getConventionInterests(g.value.ConventionUUID).then(U=>{Je.value+=1,U&&(yt.value=U)})}catch{}try{D.getConventionTickets(g.value.ConventionUUID).then(U=>{Je.value+=1,U&&(Lt.value=U)})}catch{}try{D.getConventionGroups(g.value.ConventionUUID).then(U=>{U&&(q.value=U.sort((S,R)=>S.Name.localeCompare(R.Name)))})}catch{}try{D.getConventionTags(g.value.ConventionUUID).then(U=>{U&&(Y.value=U.sort((S,R)=>S.Title.localeCompare(R.Title)).map(S=>(S.Title=`${S.Title} [${S.Key}]`,S)))})}catch{}}},jt=({page:U,itemsPerPage:S,sortBy:R})=>{if(!g.value)return;d.value=!0,ce.value=U,L.value=R;const I=b.value.find(pe=>pe.uuid==de.value),Te=I==null?void 0:I.layout.Items;let fe="",rt="";if(R&&Te&&R.length>=1){const pe=Te.find(qt=>qt.LayoutItemUUID==R[0].key);switch(rt=R[0].order||"asc",pe==null?void 0:pe.MetaField){case me.META_DATA_SOURCE_ACCOMMODATION_FORM:fe="submission.status";break;case me.META_DATA_SOURCE_ADDITIONAL_FORM:fe="submission.status";break;case me.META_DATA_SOURCE_ADMIN_FORM:fe="submission.status";break;case me.META_DATA_SOURCE_BADGE_FORM:fe="submission.status";break;case me.META_DATA_SOURCE_DEALER_FORM:fe="submission.status";break;case me.META_DATA_SOURCE_REGISTRATION_FORM:fe="submission.status";break;case me.META_DATA_SOURCE_REGISTRATION_REFERENCE:fe="reference";break;case me.META_DATA_SOURCE_SUBMISSION_DATE:fe="created";break;case me.META_DATA_SOURCE_SUBMISSION_STATUS:fe="submission.status";break}switch(pe==null?void 0:pe.UserField){case Me.USER_DATA_SOURCE_DISPLAY_NAME:fe="user.display_name";break;case Me.USER_DATA_SOURCE_EMAIL:fe="user.email";break;case Me.USER_DATA_SOURCE_FIRST_NAME:fe="user.firstname";break;case Me.USER_DATA_SOURCE_HANDLE:fe="user.handle";break;case Me.USER_DATA_SOURCE_LAST_NAME:fe="user.lastname";break}}try{const pe={Direction:rt,Limit:S,Offset:(U-1)*S,Order:fe};I&&(pe.PanelUUID=I==null?void 0:I.layout.LayoutPanelUUID),(I==null?void 0:I.layout.RequiredFormType)===Ce.FORM_TYPE_ADDITIONAL&&(pe.Additional=!0),(I==null?void 0:I.layout.RequiredFormType)===Ce.FORM_TYPE_ADMIN&&(pe.AdminForm=!0),(I==null?void 0:I.layout.RequiredFormType)===Ce.FORM_TYPE_ACCOMMODATION&&(pe.Accommodation=!0),(I==null?void 0:I.layout.RequiredFormType)===Ce.FORM_TYPE_BADGE&&(pe.Badge=!0),(I==null?void 0:I.layout.RequiredFormType)===Ce.FORM_TYPE_DEALER&&(pe.Dealer=!0),(I==null?void 0:I.layout.RequiredFormType)===Ce.FORM_TYPE_REGISTRATION&&(pe.Registration=!0),pe.GroupUUID=Et.value||Qe,pe.TagUUID=vt.value||Qe,pe.Email=At.value,pe.Reference=at.value,mt.value&&(pe.RegistrationUUID=mt.value),pe.FieldValues=Array.from(Be.value.values()),mt.value="";const qt=Dt.value;D.searchConventionRegistrations(g.value.ConventionUUID,pe).then(oa=>{oa&&qt===Dt.value&&(E.value=oa.Total,k.value=oa.Registrations,b.value.forEach(zt=>{const ya=zt.layout;zt.items=k.value.map(X=>{const Jt=[];let ot;X.Leader?ot=X:ot=X.Primary,Jt.push({Name:ot.User.DisplayName,UUID:ot.UserUUID,UserUUID:ot.User.UserUUID,IsLeader:!0,Reference:ot.Reference,Paid:ot.Paid,Total:ot.Total}),Jt.push(...ot.Members.map(Ke=>({Name:Ke.User.DisplayName,UUID:Ke.UserUUID,UserUUID:Ke.User.UserUUID,IsLeader:!1,Reference:Ke.Reference,Paid:Ke.Paid,Total:Ke.Total})));const ie={};return zt.headers.forEach(Ke=>{var ga;const K=ya.Items.find(Pt=>Pt.LayoutItemUUID===Ke.key);if(K){if(K.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&K.SectionField)X.Submissions.forEach(Pt=>{const et=Pt.Data.find(J=>J.SectionFieldUUID===K.SectionFieldUUID);if(et){Ke.type===lr.ACCOMMODATION?ie[K.LayoutItemUUID]={Data:et.Data,Registration:X}:ie[K.LayoutItemUUID]=et.Data;return}});else if(K.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&K.UserField)switch(K.UserField){case Me.USER_DATA_SOURCE_AVATAR:ie[K.LayoutItemUUID]=c.GetProfileImageURL(X.UserUUID);break;case Me.USER_DATA_SOURCE_CONTACTS:ie[K.LayoutItemUUID]={},X.User.Generated&&X.User.Generated.telegram_handle&&(ie[K.LayoutItemUUID].telegram=`@${X.User.Generated.telegram_handle}`),ie[K.LayoutItemUUID].email=X.User.Additional.Email;break;case Me.USER_DATA_SOURCE_DISPLAY_NAME:ie[K.LayoutItemUUID]=X.User.DisplayName;break;case Me.USER_DATA_SOURCE_EMAIL:ie[K.LayoutItemUUID]=X.User.Additional.Email;break;case Me.USER_DATA_SOURCE_HANDLE:ie[K.LayoutItemUUID]=X.User.Handle;break;case Me.USER_DATA_SOURCE_DATE_OF_BIRTH:ie[K.LayoutItemUUID]=X.User.Additional.DOB;break;case Me.USER_DATA_SOURCE_FIRST_NAME:ie[K.LayoutItemUUID]=X.User.Additional.FirstName;break;case Me.USER_DATA_SOURCE_LAST_NAME:ie[K.LayoutItemUUID]=X.User.Additional.LastName;break;case Me.USER_DATA_SOURCE_TELEGRAM:X.User.Generated&&X.User.Generated.telegram_handle?ie[K.LayoutItemUUID]=`@${X.User.Generated.telegram_handle}`:ie[K.LayoutItemUUID]="";break}else if(K.SourceType==="LAYOUT_ITEM_SOURCE_META"&&K.MetaField){const Pt=(ga=Q.value.find(J=>J.Type===Ce.FORM_TYPE_REGISTRATION))==null?void 0:ga.FormUUID,et=X.Submissions.find(J=>J.FormUUID===Pt);switch(K.MetaField){case me.META_DATA_SOURCE_REGISTRATION_ACTIONS:ie[K.LayoutItemUUID]=X;break;case me.META_DATA_SOURCE_REGISTRATION_GROUP:ie[K.LayoutItemUUID]=Jt;break;case me.META_DATA_SOURCE_REGISTRATION_REFERENCE:ie[K.LayoutItemUUID]=X.Reference;break;case me.META_DATA_SOURCE_SUBMISSION_DATE:if(et){const J=new Date(et.CreatedAt||"");ie[K.LayoutItemUUID]=`${J.getFullYear()}-${(J.getMonth()+1).toString().padStart(2,"0")}-${J.getDate().toString().padStart(2,"0")} ${J.getHours().toString().padStart(2,"0")}:${J.getMinutes().toString().padStart(2,"0")}:${J.getSeconds().toString().padStart(2,"0")}`}else{const J=new Date(X.CreatedAt||"");ie[K.LayoutItemUUID]=`${J.getFullYear()}-${(J.getMonth()+1).toString().padStart(2,"0")}-${J.getDate().toString().padStart(2,"0")} ${J.getHours().toString().padStart(2,"0")}:${J.getMinutes().toString().padStart(2,"0")}:${J.getSeconds().toString().padStart(2,"0")}`}break;case me.META_DATA_SOURCE_ACCOMMODATION_FORM:ie[K.LayoutItemUUID]=X.Submissions.map(J=>{const Z=Q.value.find(je=>je.FormUUID===J.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:J,Registration:X}}).filter(J=>{var Z;return((Z=J.Form)==null?void 0:Z.Type)===Ce.FORM_TYPE_ACCOMMODATION});break;case me.META_DATA_SOURCE_ADMIN_FORM:ie[K.LayoutItemUUID]=X.Submissions.map(J=>{const Z=Q.value.find(je=>je.FormUUID===J.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:J,Registration:X}}).filter(J=>{var Z;return((Z=J.Form)==null?void 0:Z.Type)===Ce.FORM_TYPE_ADMIN});break;case me.META_DATA_SOURCE_ADDITIONAL_FORM:ie[K.LayoutItemUUID]=X.Submissions.map(J=>{const Z=Q.value.find(je=>je.FormUUID===J.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:J,Registration:X}}).filter(J=>{var Z;return((Z=J.Form)==null?void 0:Z.Type)===Ce.FORM_TYPE_ADDITIONAL});break;case me.META_DATA_SOURCE_BADGE_FORM:ie[K.LayoutItemUUID]=X.Submissions.map(J=>{const Z=Q.value.find(je=>je.FormUUID===J.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:J,Registration:X}}).filter(J=>{var Z;return((Z=J.Form)==null?void 0:Z.Type)===Ce.FORM_TYPE_BADGE});break;case me.META_DATA_SOURCE_DEALER_FORM:ie[K.LayoutItemUUID]=X.Submissions.map(J=>{const Z=Q.value.find(je=>je.FormUUID===J.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:J,Registration:X}}).filter(J=>{var Z;return((Z=J.Form)==null?void 0:Z.Type)===Ce.FORM_TYPE_DEALER});break;case me.META_DATA_SOURCE_PAYMENT_STATUS:if(X.Paid===0&&X.Total)ie[K.LayoutItemUUID]="REQUIRED";else if(X.Total>X.Paid)ie[K.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const J=Jt.find(Z=>Z.Paid===0&&(Z.Total||0)>0);if(J){X.Total===0&&J.Total===0?ie[K.LayoutItemUUID]="NOT_REQUIRED":X.Total>0&&J.Total===0?ie[K.LayoutItemUUID]="MISSING_REQUIRED":X.Paid>=X.Total?ie[K.LayoutItemUUID]="AWAITING_PARTNER":ie[K.LayoutItemUUID]="ALL_REQUIRED";break}else X.Total===0?ie[K.LayoutItemUUID]="NOT_REQUIRED":ie[K.LayoutItemUUID]="COMPLETE"}break;case me.META_DATA_SOURCE_SUBMISSION_STATUS:pl(X.Submissions,Q.value),ie[K.LayoutItemUUID]=X.Submissions.map(J=>{const Z=Q.value.find(je=>je.FormUUID===J.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:J,Registration:X}});break;case me.META_DATA_SOURCE_DATA_LAYOUT:ie[K.LayoutItemUUID]={Registration:X,Layouts:G.value.filter(J=>{if(K.Meta&&K.Meta.LayoutUUID&&Array.isArray(K.Meta.LayoutUUID))return K.Meta.LayoutUUID.includes(J.AdminLayoutUUID)})};break}}}}),{key:X.RegistrationUUID,registration:X,...ie}})}),d.value=!1)})}catch{}},Fa=U=>{F.value=!1,U&&(j.value=U,pa())},pa=()=>{br(j.value.Panels,Q.value),j.value.Panels.length>0&&(b.value=[],j.value.Panels.forEach(U=>{const S={uuid:St(),order:U.Order,name:U.Name,headers:[],items:[],layout:U};U.Items.sort((R,I)=>R.Order>I.Order?1:R.Order==I.Order?0:-1),S.headers=U.Items.filter(R=>R.SourceType!=_t.LAYOUT_ITEM_SOURCE_META||R.MetaField!=me.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP).map(R=>{var I,Te;return{key:R.LayoutItemUUID,title:R.Label||((Te=(I=R.SectionField)==null?void 0:I.Field)==null?void 0:Te.Label)||"",align:R.Align==="end"?"end":"start",sortable:na(R),type:Yt(R),defaultSort:R.DefaultSort,meta:R.Meta}}),b.value.push(S)}),b.value=b.value.sort((U,S)=>U.order>S.order?1:U.order==S.order?0:-1)),(de.value==null||de.value=="")&&b.value.length>0&&(de.value=b.value[0].uuid)};f?D.getConvention(f).then(U=>{U&&(g.value=U,j.value.ConventionID=g.value.ID,j.value.ConventionUUID=g.value.ConventionUUID,La())}).catch(()=>{u.push("/")}):u.push("/");const Yt=U=>{var S,R;if(U.SourceType===_t.LAYOUT_ITEM_SOURCE_META)return`${U.SourceType}.${U.MetaField}`;if(U.SourceType===_t.LAYOUT_ITEM_SOURCE_FORM)return(R=(S=U.SectionField)==null?void 0:S.Field)==null?void 0:R.Type;if(U.SourceType===_t.LAYOUT_ITEM_SOURCE_USER)return`${U.SourceType}.${U.UserField}`},aa=()=>{const U=b.value.find(S=>S.uuid===de.value);return U?!!U.layout.Items.find(S=>S.SourceType==_t.LAYOUT_ITEM_SOURCE_META&&S.MetaField==me.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP):!1},na=U=>{const S=[me.META_DATA_SOURCE_ACCOMMODATION_FORM,me.META_DATA_SOURCE_BADGE_FORM,me.META_DATA_SOURCE_DEALER_FORM,me.META_DATA_SOURCE_REGISTRATION_FORM,me.META_DATA_SOURCE_REGISTRATION_REFERENCE,me.META_DATA_SOURCE_SUBMISSION_DATE,me.META_DATA_SOURCE_SUBMISSION_STATUS],R=[Me.USER_DATA_SOURCE_DISPLAY_NAME,Me.USER_DATA_SOURCE_EMAIL,Me.USER_DATA_SOURCE_HANDLE,Me.USER_DATA_SOURCE_DATE_OF_BIRTH,Me.USER_DATA_SOURCE_FIRST_NAME,Me.USER_DATA_SOURCE_LAST_NAME];return S.includes(U.MetaField)||R.includes(U.UserField)},wt=U=>{Re.value=U,Ze.value=!0},gt=U=>{Re.value=U,va.value=!0},Bt=U=>{Re.value=U,nt.value=!0};Ge(Ze,U=>{U||(Re.value=void 0)}),Ge(va,U=>{U||(Re.value=void 0)});const Ht=async(U="")=>{xt.value=await D.getRegistrationGroup(U)},Gt=({registration:U,form:S})=>{const R={FormUUID:S.FormUUID,Limit:1,RegistrationUUID:U.RegistrationUUID};switch(S.Type){case Ce.FORM_TYPE_ACCOMMODATION:R.Accommodation=!0;break;case Ce.FORM_TYPE_ADDITIONAL:R.Additional=!0;break;case Ce.FORM_TYPE_ADMIN:R.AdminForm=!0;break;case Ce.FORM_TYPE_BADGE:R.Badge=!0;break;case Ce.FORM_TYPE_DEALER:R.Dealer=!0;break;case Ce.FORM_TYPE_REGISTRATION:R.Registration=!0;break}D.searchConventionRegistrations(U.ConventionUUID,R).then(I=>{if(I&&I.Total>0){if(Re.value=I.Registrations[0],!Re.value)return;Ht(U.RegistrationUUID).then(()=>{var Te,fe;Re.value&&((Te=Re.value)!=null&&Te.Submissions)&&(Vt.value=(fe=Re.value)==null?void 0:fe.Submissions.find(rt=>rt.FormUUID===S.FormUUID)),Vt.value||(Vt.value=ht(S,U)),Nt.value=S,st.value=!0})}})},ht=(U,S)=>({ID:0,SubmissionUUID:St(),FormID:U.ID,FormUUID:U.FormUUID,Form:U,UserID:S.UserID,UserUUID:S.UserUUID,RegistrationID:S.ID,RegistrationUUID:S.RegistrationUUID,Registration:S,Data:[],Status:cl.SUBMISSION_STATUS_NULL}),Na=U=>{D.switchUser(U.UserUUID).then(S=>{S&&Dl(S.tokens,S.user,u,!1)}).catch(S=>{console.error(S)})},xa=U=>{Fl(U)?(Wt(),mt.value=U,ne.value=!1,Ue()):isNaN(parseInt(U))||(Wt(),at.value=U,ne.value=!1,Ue())},Wt=()=>{mt.value="",at.value="",Fe.value.Value="",At.value="",Xe.value.Value="",ft.value.Value="",Ye.value.Value=""};return C.on("registration.group.leave",U=>{D.leaveRegistrationGroup(U).then(S=>{S&&Ht(U).then(()=>{C.emit("registration.group.left",S)})})}),C.on("registration.group.remove.member",U=>{D.leaveRegistrationGroup(U).then(S=>{S&&Ht(U).then(()=>{C.emit("registration.group.left",S)})})}),C.on("checkin-saved",()=>{Wt()}),(U,S)=>g.value?(A(),H(jn,{key:0},{default:m(()=>[s(Yn,{color:"blue-darken-4"},{default:m(()=>[s(mr,{modelValue:de.value,"onUpdate:modelValue":S[0]||(S[0]=R=>de.value=R),"show-arrows":""},{default:m(()=>[(A(!0),z(ue,null,Ne(b.value,R=>(A(),H(fr,{key:R.uuid,value:R.uuid},{default:m(()=>[se(ae(R.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(Ea),s(qs),s(ve,{icon:"mdi:mdi-cog-outline",onClick:S[1]||(S[1]=R=>F.value=!0)})]),_:1}),s(vr,{modelValue:de.value,"onUpdate:modelValue":S[25]||(S[25]=R=>de.value=R),disabled:!0,touch:!1},{default:m(()=>[(A(!0),z(ue,null,Ne(b.value,R=>(A(),H($t,{key:R.uuid,value:R.uuid},{default:m(()=>[R.uuid===de.value?(A(),H(fa,{key:0,class:"pa-2"},{default:m(()=>[s(Al,{expanded:M.value,"onUpdate:expanded":S[21]||(S[21]=I=>M.value=I),page:ce.value,"onUpdate:page":S[22]||(S[22]=I=>ce.value=I),"items-per-page":be.value,"onUpdate:itemsPerPage":S[23]||(S[23]=I=>be.value=I),"sort-by":ze.value,"onUpdate:sortBy":S[24]||(S[24]=I=>ze.value=I),headers:R.headers,"items-length":E.value,items:R.items,"item-value":"key",loading:d.value,search:Dt.value,"onUpdate:options":jt,"show-expand":aa()},ka({top:m(()=>[s(Ur,{class:"mb-3"},{default:m(()=>[s(tn,null,{default:m(()=>[s(an,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:m(()=>[s(B,{class:"py-0 pl-0 pr-2 text-left flex-shrink-1 text-no-wrap"},{default:m(()=>[S[34]||(S[34]=se(" Search Criteria ")),s(un,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),s(B,{class:"d-none d-sm-block py-0 px-2",cols:"6",sm:"7",md:"2"},{default:m(()=>[s(Ve,{modelValue:at.value,"onUpdate:modelValue":S[2]||(S[2]=I=>at.value=I),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:S[3]||(S[3]=Ot(()=>{},["stop"])),"onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{class:"d-none d-md-block py-0 px-2",md:"4"},{default:m(()=>[s(Ve,{modelValue:Fe.value.Value,"onUpdate:modelValue":S[4]||(S[4]=I=>Fe.value.Value=I),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:S[5]||(S[5]=Ot(()=>{},["stop"])),"onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{class:"d-none d-md-block py-0 px-2",md:"2"},{default:m(()=>[s(Ve,{modelValue:Ye.value.Value,"onUpdate:modelValue":S[6]||(S[6]=I=>Ye.value.Value=I),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"plain","onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(Ea),s(ve,{icon:"mdi:mdi-eraser",variant:"text",title:"Clear Primary Search Values",onClick:S[7]||(S[7]=Ot(I=>{Wt(),x(Ue)()},["stop"]))}),s(ve,{icon:"mdi:mdi-qrcode-scan",variant:"text",title:"Scan Code",onClick:S[8]||(S[8]=Ot(I=>ne.value=!0,["stop"]))})]),_:1}),s(nn,{class:"pt-2"},{default:m(()=>[s(ge,null,{default:m(()=>[s(B,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:m(()=>[s(Ve,{modelValue:at.value,"onUpdate:modelValue":S[9]||(S[9]=I=>at.value=I),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:m(()=>[s(Ve,{modelValue:Fe.value.Value,"onUpdate:modelValue":S[10]||(S[10]=I=>Fe.value.Value=I),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:m(()=>[s(Ve,{modelValue:At.value,"onUpdate:modelValue":S[11]||(S[11]=I=>At.value=I),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:m(()=>[s(Ve,{modelValue:Xe.value.Value,"onUpdate:modelValue":S[12]||(S[12]=I=>Xe.value.Value=I),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:m(()=>[s(Ve,{modelValue:ft.value.Value,"onUpdate:modelValue":S[13]||(S[13]=I=>ft.value.Value=I),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:m(()=>[s(Ve,{modelValue:Ye.value.Value,"onUpdate:modelValue":S[14]||(S[14]=I=>Ye.value.Value=I),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":x(Ue),onInput:x(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:m(()=>[s(he,{modelValue:Et.value,"onUpdate:modelValue":S[15]||(S[15]=I=>Et.value=I),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:q.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),s(B,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:m(()=>[s(he,{modelValue:vt.value,"onUpdate:modelValue":S[16]||(S[16]=I=>vt.value=I),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:Y.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":m(({columns:I,internalItem:Te})=>[le("tr",null,[le("td",{colspan:I.length},[s(Gn,{modelValue:Ze.value,"onUpdate:modelValue":S[18]||(S[18]=fe=>Ze.value=fe),registration:Te.raw.registration,"onUpdate:registration":fe=>Te.raw.registration=fe,accommodations:pt.value,convention:g.value,extras:It.value,forms:Q.value,interests:yt.value,tickets:Lt.value,title:`Registration Controls (#${Te.raw.registration.Reference} ${Te.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:Ft.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,ud)])]),"item.data-table-expand":m(({internalItem:I})=>[M.value.findIndex(Te=>Te===I.key)>=0?(A(),H(ve,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:Te=>M.value.splice(M.value.findIndex(fe=>fe===I.key),1)},{default:m(()=>[I.raw.registration.Notes&&I.raw.registration.Notes.length>0?(A(),z(ue,{key:0},[se(ae(I.raw.registration.Notes.length),1)],64)):oe("",!0)]),_:2},1032,["onClick"])):(A(),H(ve,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:Te=>M.value.push(I.key)},{default:m(()=>[I.raw.registration.Notes&&I.raw.registration.Notes.length>0?(A(),z(ue,{key:0},[se(ae(I.raw.registration.Notes.length),1)],64)):oe("",!0)]),_:2},1032,["onClick"]))]),bottom:m(()=>[s(Js,{"current-page":ce.value,"onUpdate:currentPage":S[19]||(S[19]=I=>ce.value=I),"items-per-page":be.value,"onUpdate:itemsPerPage":S[20]||(S[20]=I=>be.value=I),"item-total":E.value},null,8,["current-page","items-per-page","item-total"])]),_:2},[Ne(R.headers,I=>({name:`item.${I.key}`,fn:m(({internalItem:Te,index:fe})=>[s(Zl,{header:I,item:Te,accommodations:pt.value,convention:g.value,extras:It.value,forms:Q.value,interests:yt.value,tickets:Lt.value,user:x($a),venues:Ft.value,modelValue:R.items[fe],"onUpdate:modelValue":rt=>R.items[fe]=rt,onOpenActions:wt,onOpenPayments:gt,onOpenTags:Bt,onReload:S[17]||(S[17]=rt=>jt({page:ce.value,itemsPerPage:be.value,sortBy:L.value})),onSwitchUser:Na,onShowForm:Gt},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search","show-expand"])]),_:2},1024)):oe("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),ne.value?(A(),H(Ma,{key:0,modelValue:ne.value,"onUpdate:modelValue":S[26]||(S[26]=R=>ne.value=R),title:"Scan Code",width:"auto","card-class":"px-2 px-sm-6"},{default:m(()=>[s(sd,{onScan:xa})]),_:1},8,["modelValue"])):oe("",!0),F.value?(A(),H(Gs,{key:1,title:"Edit Layouts",modelValue:F.value,"onUpdate:modelValue":S[27]||(S[27]=R=>F.value=R),convention:g.value,onSave:Fa},null,8,["modelValue","convention"])):oe("",!0),Re.value?(A(),z(ue,{key:2},[Ze.value?(A(),H(Gn,{key:0,modelValue:Ze.value,"onUpdate:modelValue":S[28]||(S[28]=R=>Ze.value=R),registration:Re.value,"onUpdate:registration":S[29]||(S[29]=R=>Re.value=R),accommodations:pt.value,convention:g.value,extras:It.value,forms:Q.value,interests:yt.value,tickets:Lt.value,title:`Registration Controls (#${Re.value.Reference} ${Re.value.User.DisplayName})`,"use-dialog":!0,venues:Ft.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):oe("",!0)],64)):oe("",!0),st.value&&Vt.value&&Nt.value?(A(),H(Tr,{key:3,modelValue:st.value,"onUpdate:modelValue":S[33]||(S[33]=R=>st.value=R),scrollable:!0,fullscreen:!0},{default:m(()=>[s(fa,{class:"bg-red-darken-4"},{default:m(()=>[s(Yn,{color:"error"},{default:m(()=>[s($l,null,{default:m(()=>S[35]||(S[35]=[se("Submission Editor - Admin Mode")])),_:1}),s(Ea),s(vl,null,{default:m(()=>[s(ve,{icon:"mdi:mdi-window-close",onClick:S[30]||(S[30]=R=>st.value=!1)})]),_:1})]),_:1}),s(Pa,{class:"pa-0"},{default:m(()=>[s(sl,{modelValue:Nt.value,"onUpdate:modelValue":S[31]||(S[31]=R=>Nt.value=R),admin:!0,convention:g.value,data:Vt.value,editable:!0,"registration-group":xt.value,onClose:S[32]||(S[32]=R=>{st.value=!1,jt({page:ce.value,itemsPerPage:be.value,sortBy:L.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):oe("",!0)]),_:1})):(A(),H(jn,{key:1},{default:m(()=>S[36]||(S[36]=[se(" Convention Not Found ")])),_:1}))}});export{hc as default};
