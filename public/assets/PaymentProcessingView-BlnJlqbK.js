import{i as T,r as p,q as g,v as r,Q as C,P as S,N as D,n as a,f as m,B as s,x as t,F as i,D as o,y as k,A as v}from"./index-C2be9rQA.js";import{l as I}from"./stripe.esm-C9RHaPzS.js";import{e as B,p as R,V as N}from"./VContainer-DsKJp95U.js";import{V as P,a as b}from"./VRow-gKmD3Obl.js";import{V as q}from"./VAlert-C6yN9I_T.js";import"./createSimpleFunctional-DNH0bj_6.js";const A={key:0},E={key:0},O=T({__name:"PaymentProcessingView",emits:["pageTitle"],setup(F,{emit:w}){const h=C(),V=S(),x=D();w("pageTitle","Payment Processing");const c=p(),n=p(""),y=p(""),d=()=>{V.push({name:"Home"})};x.stripePublicKey(h.params.convention.toString()).then(async l=>{l&&(c.value=await I(l),await f(c.value))});async function f(l){if(!l)return;const e=new URLSearchParams(window.location.search).get("payment_intent_client_secret");if(!e)return;const{paymentIntent:u}=await l.retrievePaymentIntent(e);y.value=(u==null?void 0:u.id)||"",n.value=(u==null?void 0:u.status)||"",n.value==="processing"&&setTimeout(()=>{f(l)},2e3)}return(l,e)=>(a(),g(B,null,{default:r(()=>[m(q,{closable:!0,"onClick:close":d},{title:r(()=>[n.value==""?(a(),s(i,{key:0},[t(" Retrieving Payment Status ")],64)):n.value=="succeeded"?(a(),s(i,{key:1},[t(" Payment Succeeded ")],64)):n.value=="processing"?(a(),s(i,{key:2},[t(" Payment Processing ")],64)):n.value=="requires_payment_method"?(a(),s(i,{key:3},[t(" Payment Failed ")],64)):(a(),s(i,{key:4},[t(" Payment Error ")],64))]),text:r(()=>[n.value==""?(a(),g(P,{key:0},{default:r(()=>[m(b,{class:"text-center"},{default:r(()=>[m(R,{color:"primary",indeterminate:"",size:175,width:12,class:"font-weight-bold my-4"},{default:r(()=>e[0]||(e[0]=[t(" Processing"),o("br",null,null,-1),t("Payment ")])),_:1})]),_:1})]),_:1})):n.value=="succeeded"?(a(),s(i,{key:1},[e[1]||(e[1]=o("p",{class:"my-4"},"Thank you for submitting your payment, you will receive an email shortly confirming receipt.",-1)),e[2]||(e[2]=o("p",{class:"my-4"},"The main dashboard will shortly update showing your payment.",-1))],64)):n.value=="processing"?(a(),s(i,{key:2},[e[3]||(e[3]=o("p",{class:"my-4"},"Thank you for submitting your payment, the payment is currently being processed.",-1)),e[4]||(e[4]=o("p",{class:"my-4"}," If the payment processing is successful the main dashboard will shortly update showing your payment. You will also receive an email confirming receipt. ",-1))],64)):n.value=="requires_payment_method"?(a(),s(i,{key:3},[e[6]||(e[6]=o("p",{class:"my-4"},"Thank you for submitting your payment, however the payment has failed.",-1)),e[7]||(e[7]=o("p",{class:"my-4"},[t(" Please try again and check your payment details, if the payment has been blocked you may need to contact your bank. If you continue to experience problems please email "),o("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),t(" for additional support and provide the ID below. ")],-1)),y.value?(a(),s("p",A,[e[5]||(e[5]=o("strong",null,"Payment ID:",-1)),t(" RPM-"+k(y.value),1)])):v("",!0)],64)):(a(),s(i,{key:4},[e[9]||(e[9]=o("p",{class:"my-4"},"Thank you for submitting your payment, however the payment has failed.",-1)),e[10]||(e[10]=o("p",{class:"my-4"},[t(" Please try again and check your payment details, if the payment has been blocked you may need to contact your bank. If you continue to experience problems please email "),o("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),t(" for additional support and provide the ID below. ")],-1)),y.value?(a(),s("p",E,[e[8]||(e[8]=o("strong",null,"Payment ID:",-1)),t(" GE-"+k(y.value),1)])):v("",!0)],64))]),default:r(()=>[m(P,null,{default:r(()=>[m(b,{class:"text-center"},{default:r(()=>[m(N,{onClick:d,variant:"flat",color:"success"},{default:r(()=>e[11]||(e[11]=[t("Okay")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{O as default};
