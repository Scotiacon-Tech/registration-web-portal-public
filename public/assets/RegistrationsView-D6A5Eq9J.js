import{i as je,M as Le,N as qe,r as V,n as A,D as z,q as j,v as c,H as ce,Q as xe,f as s,x as re,y as oe,A as ne,E as Oa,P as Nt,G as se,F,a2 as Ni,m as lr,k as Ra,w as We,Z as pa,c as ea,O as Ma,a3 as xi,a4 as ji,T as Yi,R as sr,a5 as Bi,b as ur,z as vt,o as dr,a6 as Hi,a7 as Gi,a8 as Wi,a9 as qi,Y as zi,a0 as Ji,C as jn,V as Ze,U as Ki}from"./index-C5F_x7d-.js";import{_ as Qi,D as Xi,a as Zi,b as el,c as tl,d as al,e as nl,f as rl,g as ol,h as il,L as un,M as dn,U as cn,i as wt,A as dt,u as tn,j as ll,P as sl,k as Yn,l as ve,m as ul,n as Ve}from"./runner-D5s0Ik76.js";import{a as cr,b as dl}from"./FormRenderer.vue_vue_type_style_index_0_lang-MsWQBbs8.js";import{F as ke,a as cl}from"./form-Cqw16b_M.js";import{b as ml,c as mr,d as Bn,S as fl}from"./submission-DAi9v6uc.js";import{C as vl}from"./canManageGlobalUsers-BTRP6V2K.js";import{_ as Pa}from"./ModelDialog.vue_vue_type_script_setup_true_lang-qUmjGKrv.js";import{a as oa,c as fr,V as mn,b as pl}from"./VList--z7zEgXh.js";import{V as pe,d as fn,e as ct}from"./VContainer-DEcdfxUP.js";import{V as vr,b as yl}from"./forwardRefs-CLtDs_S0.js";import{s as gl}from"./sortSubmissions-BLiX_qgz.js";import{u as hl}from"./useStoreAPI-BG5hR1lz.js";import{u as pr}from"./useModel-DkJ1ermu.js";import{a as yr,V as gr,d as Yt,e as hr}from"./VTabs-DfqNv4CM.js";import{u as Ul,P as Tl}from"./useDisplayTransactions-BHsBtYGe.js";import{C as Ur,G as Tr}from"./canDo-CjTMSBvS.js";import{G as $a}from"./userData-D5KLNgxn.js";import{a as vn,V as La,c as ta,e as aa,d as br,b as bl}from"./VCard-BHO6A6SZ.js";import{V as ge,a as B}from"./VRow-BQ7R8kEv.js";import{_ as _r}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as an,a as _l}from"./SaveButton.vue_vue_type_script_setup_true_lang-BOQA5Sbt.js";import{V as Te}from"./VSelect-CDM--JmF.js";import{_ as Sr,a as nn,u as Sl}from"./useLinkedFields-By2gtLVK.js";import{V as Dl,a as Al}from"./VAlert-BJ70KxuD.js";import{V as Zt}from"./VCheckbox-CjtpP29P.js";import{S as El}from"./setupLogin-D8w_cE0A.js";import{u as Hn,V as Il}from"./debounce-DM8xsnrb.js";import{b as wl}from"./sorted-PYsDa1V2.js";import{_ as Cl}from"./SelectGroups.vue_vue_type_script_setup_true_lang-HX24hqJa.js";import{_ as kl}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-CNnAWIcR.js";import{v as Ct}from"./v4-CtRu48qb.js";import{u as Ol}from"./useAdvancedMode-CwMDot2x.js";import{V as Pe}from"./VTextField-PWtRhNiy.js";import{V as Dr,a as rn,b as on,c as ln}from"./VExpansionPanels-BppyA-lA.js";import{V as sn}from"./VDialog-CVWMWi3E.js";import{c as Rl}from"./copyToClipboard-BtcEYe2-.js";import{u as Ml}from"./useAvatar-Ct3mHvSt.js";import{i as Vl}from"./index.esm-eX7gDwnj.js";import{V as fa}from"./scopeId-CHH5thCG.js";import{a as Pl}from"./VDataTable-C_Kabz5z.js";import{u as $l}from"./useConventionSlug-DaHT3JNJ.js";import{V as Gn}from"./VSheet-CleO6ZYz.js";import{V as Wn,a as Ll}from"./VToolbar-6xLseqwO.js";import{V as Fl}from"./VTextarea-B60IceRn.js";import"./date-DgbCHIwC.js";import"./canEditRegistrations-DQpfa8CN.js";import"./ticket-DqurB3v3.js";import"./targetType-BYfQr9gB.js";import"./Editor-B4kLLxxO.js";import"./VAutocomplete-D2RBxaOl.js";import"./filter-nauonRN6.js";import"./form-a_wvDLmp.js";import"./VChip-svN-R9j9.js";import"./VDivider-BH8m1kyL.js";import"./VForm-DczdjpPx.js";import"./VNavigationDrawer-Drf60t2-.js";import"./index-fwfMqYug.js";import"./VTooltip-CFR2rzcD.js";import"./VFileInput-Bkdr4BHW.js";import"./createSimpleFunctional-BsFIj8wG.js";import"./VToolbarItems-mdrVXu2v.js";import"./useConventionConfig-DUruceu-.js";import"./VTable-zMB8TrHU.js";const Nl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function xl(a){return typeof a=="string"&&Nl.test(a)}const jl=()=>({ID:0,UserUUID:"",DisplayName:"",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]}),Yl=je({__name:"DataTableItemPanel",props:Le({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Le(["openActions","showForm"],["update:modelValue"]),setup(a,{emit:o}){const n=Oa.getInstance(),l=o,m=qe(a,"modelValue"),p=V(),y=Nt(),u=V(),d=V(!1),f=w=>{const P={AdminLayoutUUID:w.AdminLayoutUUID,Limit:1,RegistrationUUID:m.value.RegistrationUUID};y.searchConventionRegistrations(m.value.ConventionUUID,P).then(R=>{R&&R.Total>0&&(p.value=R.Registrations[0],u.value=w,d.value=!0)})},g=w=>{l("openActions",w)},D=(w,P,R)=>{l("showForm",w,P,R)};return n.on("checkin-saved",()=>{d.value=!1}),(w,P)=>(A(),z("div",null,[w.layouts?(A(),j(mn,{key:0},{default:c(()=>[(A(!0),z(ce,null,xe(w.layouts,R=>(A(),j(oa,{key:R.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:c(()=>[s(fr,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:c(()=>[s(pe,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:Y=>f(R)},{default:c(()=>[re(oe(R.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):ne("",!0),d.value&&u.value&&p.value?(A(),j(Pa,{key:1,modelValue:d.value,"onUpdate:modelValue":P[2]||(P[2]=R=>d.value=R),"hide-extension":!0,fullscreen:!0,title:`#${p.value.Reference} ${p.value.User.DisplayName} - ${u.value.Name} `,scrollable:!0,"card-class":"pa-0"},{default:c(()=>[s(Qi,{accommodations:w.accommodations,convention:w.convention,extras:w.extras,forms:w.forms,interests:w.interests,tickets:w.tickets,venues:w.venues,layout:u.value,"onUpdate:layout":P[0]||(P[0]=R=>u.value=R),modelValue:p.value,"onUpdate:modelValue":P[1]||(P[1]=R=>p.value=R),onOpenActions:g,onShowForm:D},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):ne("",!0)]))}}),Bl={class:"text-grey-lighten-1"},Hl={key:0,class:"mb-2"},Gl={key:1,class:"mb-2"},Wl={key:0,class:"text-blue text-center"},ql={key:1,class:"text-red text-center"},zl={key:2,class:"text-orange text-center"},Jl={key:3,class:"text-orange text-center"},Kl={key:4,class:"text-orange text-center"},Ql={key:5,class:"text-orange text-center"},Xl={key:6,class:"text-green text-center"},Zl={key:0},es={key:0},ts=je({__name:"RegListRow",props:Le({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Le(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(a,{emit:o}){const n=o,l=qe(a,"modelValue"),m=(u,d)=>{n("showForm",{registration:u,form:d})},p=u=>{n("openActions",u)},y=u=>{n("switchUser",u)};return(u,d)=>u.header.type==="ACCOMMODATION"&&u.accommodations.length>0&&u.item.raw[u.header.key]?(A(),j(Xi,{key:0,value:u.item.raw[u.header.key].Data,accommodations:u.accommodations,convention:u.convention,forms:u.forms,tickets:u.tickets,venues:u.venues,registration:u.item.raw[u.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):u.header.type==="EXTRAS"&&u.extras.length>0?(A(),j(Zi,{key:1,value:u.item.raw[u.header.key],extras:u.extras},null,8,["value","extras"])):u.header.type==="INTERESTS"&&u.interests.length>0?(A(),j(el,{key:2,value:u.item.raw[u.header.key],interests:u.interests},null,8,["value","interests"])):u.header.type==="TICKET"&&u.tickets.length>0?(A(),j(tl,{key:3,value:u.item.raw[u.header.key],tickets:u.tickets},null,8,["value","tickets"])):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(A(),j(al,{key:4,convention:u.convention,"show-controls":!1,modelValue:u.item.raw.registration,"onUpdate:modelValue":d[0]||(d[0]=f=>u.item.raw.registration=f)},null,8,["convention","modelValue"])):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADDITIONAL_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(A(),z(ce,{key:5},[se("ul",null,[(A(!0),z(ce,null,xe(u.forms.filter(f=>f.Type===F(ke).FORM_TYPE_ADMIN&&u.item.raw[u.header.key].findIndex(g=>g.Form.ID===f.ID)<0),f=>(A(),z("li",{key:f.Heading},[se("strong",Bl,oe(f.Heading),1),s(pe,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:g=>m(u.item.raw.registration,f)},null,8,["onClick"])]))),128))]),se("ul",null,[(A(!0),z(ce,null,xe(u.item.raw[u.header.key],f=>(A(),z("li",{key:f.Heading},[se("strong",null,[re(oe(f.Heading),1),f.Form.Type!==F(ke).FORM_TYPE_ADMIN?(A(),z(ce,{key:0},[re(": ")],64)):ne("",!0)]),f.Form.Type!==F(ke).FORM_TYPE_ADMIN?(A(),z("span",{key:0,class:Ni(F(ml)(f.Submission.Status))},oe(F(mr)(f.Submission.Status)),3)):ne("",!0),s(pe,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:g=>m(f.Registration,f.Form)},null,8,["onClick"])]))),128))])],64)):u.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(A(),j(vr,{key:6,class:"rounded-circle",src:u.item.raw[u.header.key],height:"32",width:"32"},null,8,["src"])):u.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_CONTACTS"?(A(),z(ce,{key:7},[u.item.raw[u.header.key].email?(A(),z("p",Hl,[d[4]||(d[4]=se("strong",null,"Email",-1)),d[5]||(d[5]=se("br",null,null,-1)),re(oe(u.item.raw[u.header.key].email),1)])):ne("",!0),u.item.raw[u.header.key].telegram?(A(),z("p",Gl,[d[6]||(d[6]=se("strong",null,"Telegram",-1)),d[7]||(d[7]=se("br",null,null,-1)),re(oe(u.item.raw[u.header.key].telegram),1)])):ne("",!0)],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(A(),z(ce,{key:8},[u.item.raw[u.header.key]=="NOT_REQUIRED"?(A(),z("div",Wl,"No Payment Requested")):u.item.raw[u.header.key]=="MISSING_REQUIRED"?(A(),z("div",ql,"Partner Payment Not Requested")):u.item.raw[u.header.key]=="AWAITING_PARTNER"?(A(),z("div",zl,"Awaiting Partner Payment")):u.item.raw[u.header.key]=="ALL_REQUIRED"?(A(),z("div",Jl,"Awaiting Payments")):u.item.raw[u.header.key]=="REQUIRED"?(A(),z("div",Kl,"Awaiting Payment")):u.item.raw[u.header.key]=="ADDITIONAL_REQUIRED"?(A(),z("div",Ql,"Awaiting Additional Payments")):(A(),z("div",Xl,"Completed"))],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(A(),z(ce,{key:9},[s(pe,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:d[1]||(d[1]=f=>p(u.item.raw[u.header.key]))}),F(vl)(u.user)?(A(),j(pe,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:d[2]||(d[2]=f=>y(u.item.raw[u.header.key]))})):ne("",!0)],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(A(),z(ce,{key:10},[u.item.raw[u.header.key].length===1?(A(),z("em",Zl," Not in a group ")):(A(),z(ce,{key:1},[se("ul",null,[(A(!0),z(ce,null,xe(u.item.raw[u.header.key],f=>(A(),z("li",{key:f.UUID,class:"ml-0"},[re(" #"+oe(f.Reference)+" : "+oe(f.Name)+" ",1),f.IsLeader?(A(),z("strong",es,"(Leader)")):ne("",!0)]))),128))]),d[8]||(d[8]=se("strong",null,"Total:",-1)),re(" "+oe(u.item.raw[u.header.key].length),1)],64))],64)):u.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(A(),z(ce,{key:11},[l.value.registration?(A(),j(Yl,{key:0,accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,tickets:u.tickets,venues:u.venues,layouts:u.item.raw[u.header.key].Layouts,modelValue:l.value.registration,"onUpdate:modelValue":d[3]||(d[3]=f=>l.value.registration=f),onOpenActions:p,onShowForm:m},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):ne("",!0)],64)):(A(),z(ce,{key:12},[re(oe(u.item.raw[u.header.key]),1)],64))}}),qn=je({__name:"RegistrationActionTabs",props:Le({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=a,n=qe(a,"modelValue");return(l,m)=>(A(),j(yr,lr({modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=p=>n.value=p)},o),{default:c(()=>[(A(!0),z(ce,null,xe(l.tabs,p=>(A(),j(gr,{value:p.value,key:p.value},{default:c(()=>[re(oe(p.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),as=(a=void 0,o)=>a===void 0?!1:Ur(a,Tr.GROUP_TYPE_CONVENTION,o.ConventionUUID,o).EditPaymentTransactions,ns={class:"mb-4"},rs={class:"v-row"},os={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},is={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ls={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},ss={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},us={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},ds={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},cs={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},ms={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},fs=je({__name:"PaymentActions",props:Le({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=V(!1),n=V(),l=V([]),m=V(new Date().getTime()),p=V(!1),y=qe(a,"modelValue"),u=V(Ra(y.value));We(y,()=>{u.value=Ra(y.value)});const d=Nt();d.getConvention(y.value.ConventionUUID).then(w=>{w&&(p.value=as($a(),w))});const f=()=>{d.generateRegistrationCharges(y.value.RegistrationUUID,!1).then(w=>{w&&(l.value=w.PaymentTransactions,n.value=w.Registration,m.value=new Date().getTime())}).catch(()=>{})};f();const g=()=>{d.generateRegistrationCharges(y.value.RegistrationUUID,!0).then(w=>{w&&(l.value=w.PaymentTransactions,n.value=w.Registration,m.value=new Date().getTime())})},{totalCharges:D}=Ul();return(w,P)=>(A(),j(aa,null,{default:c(()=>[s(La,null,{default:c(()=>[s(vn,null,{default:c(()=>[re(" Payments (#"+oe(y.value.Reference)+" "+oe(y.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),s(ta,null,{default:c(()=>[n.value?(A(),z(ce,{key:0},[se("h3",ns,"#"+oe(n.value.Reference)+" "+oe(n.value.User.DisplayName),1),se("dl",rs,[(A(!0),z(ce,null,xe(l.value,R=>(A(),z(ce,{key:R.PaymentTransactionUUID},[R.Type===F(Tl).PAYMENT_TRANSACTION_TYPE_CHARGE?(A(),z("dt",os,[se("div",is,oe(R.Description.split(":")[0])+": ",1),se("div",ls,oe(R.Description.split(":")[1]),1)])):ne("",!0),se("dd",ss," £"+oe(R.Amount),1)],64))),128)),P[2]||(P[2]=se("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),se("dd",us," £"+oe(F(D)(l.value)),1),P[3]||(P[3]=se("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),se("dd",ds," £"+oe(n.value.Total),1),P[4]||(P[4]=se("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),se("dd",cs," £"+oe(n.value.Paid),1),P[5]||(P[5]=se("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),se("dd",ms," £"+oe(n.value.Total-n.value.Paid),1)]),s(ge,{class:"flex-row-reverse"},{default:c(()=>[s(B,{class:"text-right"},{default:c(()=>[s(pe,{color:"primary",onClick:g},{default:c(()=>P[6]||(P[6]=[re("Apply Charges")])),_:1})]),_:1}),!o.value&&p.value?(A(),j(B,{key:0},{default:c(()=>[s(pe,{color:"secondary",onClick:P[0]||(P[0]=R=>o.value=!0)},{default:c(()=>P[7]||(P[7]=[re("Transaction Entry")])),_:1})]),_:1})):ne("",!0)]),_:1})],64)):ne("",!0),s(nl,{"can-edit":p.value,registration:y.value,"show-editor":o.value,onCloseEditor:P[1]||(P[1]=R=>o.value=!1),updated:m.value,onChange:f},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),vs=_r(fs,[["__scopeId","data-v-861debd5"]]),ps=je({__name:"RegistrationFormStatus",props:Le({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=Nt(),n=qe(a,"modelValue"),l=(m,p)=>{const y=n.value.Submissions.find(u=>u.SubmissionUUID==p);if(!y){m&&m("Submission not found");return}o.setSubmissionStatus(p,y.Status).then(u=>{u?(n.value.Submissions.forEach((d,f)=>{n.value.Submissions[f].Status=d.Status}),m&&m("Status Saved")):m&&m("Status not saved")}).catch(()=>{m&&m("Status not saved")})};return(m,p)=>(A(),j(aa,null,{default:c(()=>[s(La,null,{default:c(()=>[s(vn,null,{default:c(()=>[re("Status (#"+oe(n.value.Reference)+" "+oe(n.value.User.DisplayName)+")",1)]),_:1})]),_:1}),s(ta,null,{default:c(()=>[s(mn,null,{default:c(()=>[(A(!0),z(ce,null,xe(n.value.Submissions,y=>(A(),j(oa,{key:y.SubmissionUUID,class:"pa-0"},{default:c(()=>[s(ge,{class:"py-2 align-center"},{default:c(()=>[s(B,{cols:"9",sm:"10",md:"10",lg:"9"},{default:c(()=>{var u;return[s(Te,{modelValue:y.Status,"onUpdate:modelValue":d=>y.Status=d,items:F(Bn),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((u=m.forms.find(d=>d.FormUUID==y.FormUUID))==null?void 0:u.Name)||""},{selection:c(()=>[s(fn,{class:"mr-4 d-none d-sm-inline"},{default:c(()=>{var d;return[re(oe((d=F(Bn).find(f=>f.value===y.Status))==null?void 0:d.icon),1)]}),_:2},1024),re(" "+oe(F(mr)(y.Status)),1)]),item:c(({item:d,props:{onClick:f}})=>[s(oa,{title:d.title,"prepend-icon":d.raw.icon,onClick:f},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),s(B,{cols:"3",sm:"2",md:"2",lg:"1"},{default:c(()=>[s(an,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:u=>l(u.callback,y.SubmissionUUID)},null,8,["onClick"]),s(an,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:u=>l(u.callback,y.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),ys={class:"mb-4"},gs=je({__name:"RegistrationTags",props:Le({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=Nt(),n=qe(a,"modelValue"),l=V(Ra(n.value)),m=V(!1),p=V(l.value.Tags);We(n,()=>{l.value=Ra(n.value)});const y=({callback:u})=>{const d=[],f=[];l.value.Tags.forEach(g=>{p.value.find(w=>w.TagUUID===g.TagUUID)||d.push(g.TagUUID)}),p.value.forEach(g=>{l.value.Tags.find(w=>g.TagUUID===w.TagUUID)||f.push(g.TagUUID)}),o.updateRegistrationTags(d,f,l.value.RegistrationUUID).then(g=>{g?u&&(u("Tags Saved"),n.value.Tags=g.Tags):u&&u("Error Saving Tags")}).catch(()=>{u&&u("Error Saving Tags")})};return(u,d)=>(A(),j(aa,null,{default:c(()=>[s(La,null,{default:c(()=>[s(vn,null,{default:c(()=>[re("Tags (#"+oe(l.value.Reference)+" "+oe(l.value.User.DisplayName)+")",1)]),_:1})]),_:1}),s(ta,null,{default:c(()=>[s(Dl,{class:"my-4"},{default:c(()=>[s(Al,null,{default:c(()=>d[2]||(d[2]=[re("Caution")])),_:1}),d[3]||(d[3]=se("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1))]),_:1}),se("h3",ys,"#"+oe(l.value.Reference)+" "+oe(l.value.User.DisplayName),1),s(Sr,{modelValue:l.value.Tags,"onUpdate:modelValue":d[0]||(d[0]=f=>l.value.Tags=f),convention:l.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":m.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),s(br,{class:"px-4 align-start"},{default:c(()=>[s(Zt,{label:"Show UUID",modelValue:m.value,"onUpdate:modelValue":d[1]||(d[1]=f=>m.value=f)},null,8,["modelValue"]),s(an,{onClick:y,variant:"flat"})]),_:1})]),_:1}))}}),hs=_r(gs,[["__scopeId","data-v-a4024c39"]]),zn=je({__name:"RegistrationActionWindows",props:Le({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Le(["update:registration"],["update:modelValue"]),setup(a,{emit:o}){const n=a,l=qe(a,"modelValue"),p=pr(n,o,void 0,void 0,"registration");return(y,u)=>(A(),j(hr,{modelValue:l.value,"onUpdate:modelValue":u[3]||(u[3]=d=>l.value=d),disabled:!0,touch:!1},{default:c(()=>[s(Yt,{value:"badges"},{default:c(()=>[l.value=="badges"?(A(),j(ct,{key:0,class:"pa-0 mx-0",fluid:!0},{default:c(()=>[s(rl,{convention:y.convention,registration:F(p)},null,8,["convention","registration"])]),_:1})):ne("",!0)]),_:1}),s(Yt,{value:"emails"},{default:c(()=>[l.value=="emails"?(A(),j(ct,{key:0,class:"pa-0 mx-0",fluid:!0},{default:c(()=>[s(ol,{registration:F(p)},null,8,["registration"])]),_:1})):ne("",!0)]),_:1}),s(Yt,{value:"notes"},{default:c(()=>[l.value=="notes"?(A(),j(ct,{key:0,class:"pa-0 mx-0",fluid:!0},{default:c(()=>[s(il,{convention:y.convention,expanded:!1,registration:F(p)},null,8,["convention","registration"])]),_:1})):ne("",!0)]),_:1}),s(Yt,{value:"payments"},{default:c(()=>[l.value=="payments"?(A(),j(ct,{key:0,class:"pa-0 mx-0",fluid:!0},{default:c(()=>[s(vs,{modelValue:F(p),"onUpdate:modelValue":u[0]||(u[0]=d=>pa(p)?p.value=d:null),forms:y.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):ne("",!0)]),_:1}),s(Yt,{value:"status"},{default:c(()=>[l.value=="status"?(A(),j(ct,{key:0,class:"pa-0 mx-0",fluid:!0},{default:c(()=>[s(ps,{modelValue:F(p),"onUpdate:modelValue":u[1]||(u[1]=d=>pa(p)?p.value=d:null),forms:y.forms},null,8,["modelValue","forms"])]),_:1})):ne("",!0)]),_:1}),s(Yt,{value:"tags"},{default:c(()=>[l.value=="tags"?(A(),j(ct,{key:0,class:"pa-0 mx-0",fluid:!0},{default:c(()=>[s(hs,{modelValue:F(p),"onUpdate:modelValue":u[2]||(u[2]=d=>pa(p)?p.value=d:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):ne("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Us=(a,o)=>a===void 0?!1:Ur(a,Tr.GROUP_TYPE_CONVENTION,o.ConventionUUID,o).ViewPaymentTransactions,Ts={key:0},bs={key:1},Jn=je({__name:"RegistrationActions",props:Le({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Le(["update:registration"],["update:modelValue"]),setup(a,{emit:o}){const n=a,l=qe(a,"modelValue"),p=pr(n,o,void 0,void 0,"registration"),y=V("notes"),u=$a(),d=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Us(u,n.convention)&&d.splice(2,0,{label:"Payments",value:"payments"}),(f,g)=>f.useDialog?(A(),z("div",Ts,[s(Pa,{modelValue:l.value,"onUpdate:modelValue":g[3]||(g[3]=D=>l.value=D),title:f.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:c(()=>[s(qn,{modelValue:y.value,"onUpdate:modelValue":g[0]||(g[0]=D=>y.value=D),tabs:d,"show-arrows":!0},null,8,["modelValue"])]),default:c(()=>[s(zn,{modelValue:y.value,"onUpdate:modelValue":g[1]||(g[1]=D=>y.value=D),registration:F(p),"onUpdate:registration":g[2]||(g[2]=D=>pa(p)?p.value=D:null),accommodations:f.accommodations,convention:f.convention,extras:f.extras,forms:f.forms,interests:f.interests,tabs:d,tickets:f.tickets,venues:f.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(A(),z("div",bs,[s(qn,{modelValue:y.value,"onUpdate:modelValue":g[4]||(g[4]=D=>y.value=D),tabs:d,"show-arrows":!0},null,8,["modelValue"]),s(zn,{modelValue:y.value,"onUpdate:modelValue":g[5]||(g[5]=D=>y.value=D),registration:F(p),"onUpdate:registration":g[6]||(g[6]=D=>pa(p)?p.value=D:null),accommodations:f.accommodations,convention:f.convention,extras:f.extras,forms:f.forms,interests:f.interests,tabs:d,tickets:f.tickets,venues:f.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),Ar=(a,o)=>{a.forEach(n=>{n.Items.forEach(l=>{(l.SectionField==null||l.SectionField.Field==null)&&o.find(m=>{m.Sections.find(p=>{if(p.Fields){const y=p.Fields.find(u=>u.SectionFieldUUID===l.SectionFieldUUID);if(y)return l.SectionField=y,!0}})})})})},_s={base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"},Ss={base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"},Ds={base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"},As={base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"},Es={base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"},Is={base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"},ws={base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"},Cs={base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"},ks={base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"},Os={base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"},Rs={base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"},Ms={base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"},Vs={base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"},Ps={base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"},$s={base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"},Ls={base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"},Fs={base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"},Ns={base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"},xs={base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"},js={black:"#000000",white:"#ffffff",transparent:"#ffffff00"},Ys={red:_s,pink:Ss,purple:Ds,deepPurple:As,indigo:Es,blue:Is,lightBlue:ws,cyan:Cs,teal:ks,green:Os,lightGreen:Rs,lime:Ms,yellow:Vs,amber:Ps,orange:$s,deepOrange:Ls,brown:Fs,blueGrey:Ns,grey:xs,shades:js},Bs=je({__name:"EditAdminLayoutSearch",props:Le({formOptions:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=a,n=qe(a,"modelValue");n.value.Search||(n.value.Search=[]);const l=V(o.formOptions),m=()=>{n.value.Search.push({ID:0,LayoutItemUUID:Ct(),LayoutPanelID:n.value.AdminLayoutID,LayoutPanelUUID:n.value.AdminLayoutUUID,Label:"",SourceType:wt.LAYOUT_ITEM_SOURCE_FORM,Align:"",Order:n.value.Search.length,DefaultSort:!1,Meta:{}})},p=u=>{const d=n.value.Search.findIndex(f=>f.LayoutItemUUID===u.LayoutItemUUID);d!=-1&&n.value.Search.splice(d,1)},y=u=>{const d=l.value.find(f=>f.value===u.SectionFieldUUID);d&&(u.SectionFieldID=d.object.ID,u.SectionField=d.object)};return(u,d)=>(A(),z(ce,null,[(A(!0),z(ce,null,xe(n.value.Search,f=>(A(),j(ge,{key:f.LayoutItemUUID},{default:c(()=>[s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Te,{modelValue:f.SourceType,"onUpdate:modelValue":g=>f.SourceType=g,label:"Source Type",items:F(un),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,null,{default:c(()=>[f.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(A(),j(Te,{key:0,modelValue:f.SectionFieldUUID,"onUpdate:modelValue":g=>f.SectionFieldUUID=g,label:"Form Data",items:l.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:g=>y(f)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):f.SourceType==="LAYOUT_ITEM_SOURCE_META"?(A(),j(Te,{key:1,modelValue:f.MetaField,"onUpdate:modelValue":g=>f.MetaField=g,label:"Miscellaneous Data",items:F(dn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):f.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(A(),j(Te,{key:2,modelValue:f.UserField,"onUpdate:modelValue":g=>f.UserField=g,label:"User Profile Data",items:F(cn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):ne("",!0)]),_:2},1024),s(B,null,{default:c(()=>[s(pe,{icon:"mdi:mdi-delete",onClick:g=>p(f)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),s(pe,{onClick:m,color:"primary"},{default:c(()=>d[0]||(d[0]=[re(" Add Search Item ")])),_:1})],64))}}),Hs=je({__name:"EditAdminLayoutFilter",props:Le({formOptions:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=a,n=qe(a,"modelValue");n.value.Filter||(n.value.Filter=[]);const l=V(o.formOptions),m=()=>{n.value.Filter.push({ID:0,LayoutItemUUID:Ct(),LayoutPanelID:n.value.AdminLayoutID,LayoutPanelUUID:n.value.AdminLayoutUUID,Label:"",SourceType:wt.LAYOUT_ITEM_SOURCE_FORM,Align:"",Order:n.value.Filter.length,DefaultSort:!1,Meta:{}})},p=u=>{const d=n.value.Filter.findIndex(f=>f.LayoutItemUUID===u.LayoutItemUUID);d!=-1&&n.value.Filter.splice(d,1)},y=u=>{const d=l.value.find(f=>f.value===u.SectionFieldUUID);d&&(u.SectionFieldID=d.object.ID,u.SectionField=d.object)};return(u,d)=>(A(),z(ce,null,[(A(!0),z(ce,null,xe(n.value.Filter,f=>(A(),j(ge,{key:f.LayoutItemUUID},{default:c(()=>[s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Te,{modelValue:f.SourceType,"onUpdate:modelValue":g=>f.SourceType=g,label:"Source Type",items:F(un),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,null,{default:c(()=>[f.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(A(),j(Te,{key:0,modelValue:f.SectionFieldUUID,"onUpdate:modelValue":g=>f.SectionFieldUUID=g,label:"Form Data",items:l.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:g=>y(f)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):f.SourceType==="LAYOUT_ITEM_SOURCE_META"?(A(),j(Te,{key:1,modelValue:f.MetaField,"onUpdate:modelValue":g=>f.MetaField=g,label:"Miscellaneous Data",items:F(dn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):f.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(A(),j(Te,{key:2,modelValue:f.UserField,"onUpdate:modelValue":g=>f.UserField=g,label:"User Profile Data",items:F(cn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):ne("",!0)]),_:2},1024),s(B,null,{default:c(()=>[s(pe,{icon:"mdi:mdi-delete",onClick:g=>p(f)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),s(pe,{onClick:m,color:"primary"},{default:c(()=>d[0]||(d[0]=[re(" Add Filter Item ")])),_:1})],64))}}),Gs={key:0,class:"text-warning text-right pl-1"},Ws=je({__name:"EditAdminLayout",props:Le({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Le(["change","delete"],["update:modelValue"]),setup(a,{emit:o}){const n=Ol(),l=qe(a,"modelValue"),m=V([]),p=Nt(),y=o,u=V(Object.assign({},...a.layouts.map(q=>q.Panels.map(G=>G.Items.map(C=>{if(!C.Meta)return{};const H={};return Object.entries(C.Meta).forEach(T=>{Array.isArray(T[1])?(H[`${C.LayoutItemUUID}.${T[0]}`]=[],T[1].forEach(fe=>{H[`${C.LayoutItemUUID}.${T[0]}`].push(fe.toString())})):T[1]!==void 0&&T[1]!==null&&(H[`${C.LayoutItemUUID}.${T[0]}`]=[T[1].toString()])}),H}))).flat(2))),d=V(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),f=V(!1),g=V([]);p.getConventionTags(a.convention.ConventionUUID).then(q=>{q&&(g.value=q)}).catch(()=>{});const D=()=>({ID:0,LayoutPanelUUID:Ct(),AdminLayoutID:l.value.ID,AdminLayoutUUID:l.value.AdminLayoutUUID,Name:"",Order:l.value.Panels.length+1,Items:[],Search:[],Filter:[],PanelStyle:Yn.PANEL_STYLE_FLEX,RequiredFormType:ke.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),w=q=>()=>({ID:0,LayoutItemUUID:Ct(),LayoutPanelID:q.ID,LayoutPanelUUID:q.LayoutPanelUUID,Label:"",SourceType:wt.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:q.Items.length+1,DefaultSort:!1,Meta:{}}),P=(q,G)=>{q.Meta[G]=u.value[`${q.LayoutItemUUID}.${G}`]},R=q=>{const G=m.value.find(C=>C.value===q.SectionFieldUUID);G&&(q.SectionFieldID=G.object.ID,q.SectionField=G.object)};p.getConventionForms(l.value.ConventionUUID).then(q=>{q&&(q.forEach(G=>G.Sections.forEach(C=>C.Fields&&m.value.push(...C.Fields.map(H=>{var fe;return{title:`${G.Name} - ${C.Name} - ${(fe=H.Field)==null?void 0:fe.Name}`,value:H.SectionFieldUUID,object:H}})))),m.value.sort(wl("title")),Ar(l.value.Panels,q))});const Y=ea(()=>{switch(l.value.Type){case dt.ADMIN_LAYOUT_PANELS:return"Panels";case dt.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});We(l,()=>{y("change")},{deep:!0});const ee=ea(()=>{const q=/([a-zA-Z]+)(\d+)/;return Object.entries(Ys).map(([G,C])=>Object.entries(C).map(([H,T])=>{const fe=q.exec(H);return!fe||fe.length<3?void 0:{Title:`${tn(G).split(/(?=[A-Z])/).join(" ")} ${tn(fe[1])} ${tn(fe[2])}`,CSSName:`${G}-${fe[1]}-${fe[2]}`,Value:T}})).flat().filter(G=>!!G).sort((G,C)=>G.Title>C.Title?1:G.Title==C.Title?0:-1)});return(q,G)=>(A(),j(ct,{class:"px-0 mx-0",fluid:!0},{default:c(()=>[s(ge,null,{default:c(()=>[s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Pe,{modelValue:l.value.Name,"onUpdate:modelValue":G[0]||(G[0]=C=>l.value.Name=C),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Te,{modelValue:l.value.Type,"onUpdate:modelValue":G[1]||(G[1]=C=>l.value.Type=C),label:"Layout Type",items:F(ll),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),l.value.Type==F(dt).ADMIN_LAYOUT_PANELS?(A(),j(B,{key:0,cols:"12",sm:"6"},{default:c(()=>[s(Te,{modelValue:l.value.RunnerLayoutUUID,"onUpdate:modelValue":G[2]||(G[2]=C=>l.value.RunnerLayoutUUID=C),clearable:!0,items:q.layouts.filter(C=>C.Type===F(dt).ADMIN_LAYOUT_PANELS)||[],multiple:!1,label:"Runner Display (Optional)","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})):ne("",!0)]),_:1}),s(ge,null,{default:c(()=>[s(B,null,{default:c(()=>[s(nn,{modelValue:l.value.Panels,"onUpdate:modelValue":G[3]||(G[3]=C=>l.value.Panels=C),"new-item":D,closeable:!1,title:Y.value,label:"Name","slot-name-prefix":"panel"},Ma({_:2},[xe(l.value.Panels,(C,H)=>({name:`panel_${H}`,fn:c(()=>[s(ct,{class:"px-0 mx-0",fluid:!0},{default:c(()=>[s(ge,null,{default:c(()=>[s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Pe,{modelValue:C.Name,"onUpdate:modelValue":T=>C.Name=T,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l.value.Type===F(dt).ADMIN_LAYOUT_PANELS?(A(),j(B,{key:0,cols:"12",sm:"6"},{default:c(()=>[s(Te,{modelValue:C.PanelStyle,"onUpdate:modelValue":T=>C.PanelStyle=T,items:F(sl),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):ne("",!0),s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Te,{modelValue:C.RequiredFormType,"onUpdate:modelValue":T=>C.RequiredFormType=T,items:F(cl),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Cl,{label:"Required Groups",variant:"outlined",modelValue:C.RequiredGroupMemberships,"onUpdate:modelValue":T=>C.RequiredGroupMemberships=T,convention:l.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Sr,{label:"Registration Tags",variant:"outlined",modelValue:C.RequiredRegistrationTags,"onUpdate:modelValue":T=>C.RequiredRegistrationTags=T,convention:l.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),F(n)?(A(),j(ge,{key:0},{default:c(()=>[s(B,null,{default:c(()=>[s(Dr,{variant:"accordion"},{default:c(()=>[s(rn,null,{default:c(()=>[s(on,null,{default:c(()=>G[7]||(G[7]=[re(" Filters ")])),_:1}),s(ln,null,{default:c(()=>[G[8]||(G[8]=se("p",null," Fixed search settings to pre-filter results by ",-1)),s(Hs,{modelValue:l.value.Panels[H],"onUpdate:modelValue":T=>l.value.Panels[H]=T,"form-options":m.value},null,8,["modelValue","onUpdate:modelValue","form-options"])]),_:2},1024)]),_:2},1024),s(rn,null,{default:c(()=>[s(on,null,{default:c(()=>G[9]||(G[9]=[re(" Search Options ")])),_:1}),s(ln,null,{default:c(()=>[G[10]||(G[10]=se("p",null," Dynamic search options ",-1)),s(Bs,{modelValue:l.value.Panels[H],"onUpdate:modelValue":T=>l.value.Panels[H]=T,"form-options":m.value},null,8,["modelValue","onUpdate:modelValue","form-options"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):ne("",!0),l.value.Type===F(dt).ADMIN_LAYOUT_TABLE?(A(),j(ge,{key:1},{default:c(()=>[s(B,null,{default:c(()=>[s(Zt,{modelValue:C.Meta.challenge,"onUpdate:modelValue":T=>C.Meta.challenge=T,label:"Require challenge on search"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):ne("",!0),l.value.Type===F(dt).ADMIN_LAYOUT_PANELS&&C.PanelStyle===F(Yn).PANEL_STYLE_FLEX?(A(),j(ge,{key:2},{default:c(()=>[s(B,{cols:"12",class:"py-0 my-0"},{default:c(()=>G[11]||(G[11]=[se("h4",null,"Grid Size (Max 12)",-1)])),_:1}),s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Pe,{modelValue:C.Meta.cols,"onUpdate:modelValue":T=>C.Meta.cols=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Pe,{modelValue:C.Meta.cols_xs,"onUpdate:modelValue":T=>C.Meta.cols_xs=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Pe,{modelValue:C.Meta.cols_sm,"onUpdate:modelValue":T=>C.Meta.cols_sm=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Pe,{modelValue:C.Meta.cols_md,"onUpdate:modelValue":T=>C.Meta.cols_md=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Pe,{modelValue:C.Meta.cols_lg,"onUpdate:modelValue":T=>C.Meta.cols_lg=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Pe,{modelValue:C.Meta.cols_xl,"onUpdate:modelValue":T=>C.Meta.cols_xl=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):ne("",!0)]),_:2},1024),s(nn,{modelValue:C.Items,"onUpdate:modelValue":T=>C.Items=T,"new-item":w(C),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Ma({_:2},[xe(C.Items,(T,fe)=>({name:`item_${fe}`,fn:c(()=>[s(ct,{class:"px-0 mx-0",fluid:!0},{default:c(()=>{var _e,L;return[s(ge,null,{default:c(()=>[s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Pe,{modelValue:T.Label,"onUpdate:modelValue":E=>T.Label=E,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),s(ge,null,{default:c(()=>[s(B,{cols:"12",sm:"6"},{default:c(()=>[s(Te,{modelValue:T.SourceType,"onUpdate:modelValue":E=>T.SourceType=E,label:"Source Type",items:F(un),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),s(B,{cols:"12",sm:"6"},{default:c(()=>[T.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(A(),j(Te,{key:0,modelValue:T.SectionFieldUUID,"onUpdate:modelValue":E=>T.SectionFieldUUID=E,label:"Form Data",items:m.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:E=>R(T)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):T.SourceType==="LAYOUT_ITEM_SOURCE_META"?(A(),j(Te,{key:1,modelValue:T.MetaField,"onUpdate:modelValue":E=>T.MetaField=E,label:"Miscellaneous Data",items:F(dn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):T.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(A(),j(Te,{key:2,modelValue:T.UserField,"onUpdate:modelValue":E=>T.UserField=E,label:"User Profile Data",items:F(cn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):ne("",!0)]),_:2},1024)]),_:2},1024),q.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((L=(_e=T.SectionField)==null?void 0:_e.Field)==null?void 0:L.Type)===F(cr).TEXT?(A(),j(ge,{key:0},{default:c(()=>[s(B,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:c(()=>[s(Zt,{modelValue:T.Meta.DirectEdit,"onUpdate:modelValue":E=>T.Meta.DirectEdit=E,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:c(()=>[s(Te,{modelValue:T.Meta.DirectEditPermission,"onUpdate:modelValue":E=>T.Meta.DirectEditPermission=E,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):ne("",!0),q.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_META"&&T.MetaField===F(ve).META_DATA_SOURCE_BADGE_DISPLAY?(A(),j(ge,{key:1},{default:c(()=>[s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Zt,{modelValue:T.Meta.HideDownloadButton,"onUpdate:modelValue":E=>T.Meta.HideDownloadButton=E,label:"Hide Download Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Zt,{modelValue:T.Meta.HideNFCButton,"onUpdate:modelValue":E=>T.Meta.HideNFCButton=E,label:"Hide NFC Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):ne("",!0),q.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_META"&&T.MetaField===F(ve).META_DATA_SOURCE_DATA_LAYOUT?(A(),j(ge,{key:2},{default:c(()=>[s(B,{cols:"6",sm:"4",lg:"2"},{default:c(()=>[s(Te,{modelValue:u.value[`${T.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[E=>u.value[`${T.LayoutItemUUID}.LayoutUUID`]=E,E=>P(T,"LayoutUUID")],clearable:!0,items:q.layouts.filter(E=>E.Type===F(dt).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):ne("",!0),q.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_META"&&T.MetaField===F(ve).META_DATA_SOURCE_TAGS?(A(),j(ge,{key:3},{default:c(()=>[s(B,{cols:"6",sm:"6",md:"6",lg:"6"},{default:c(()=>[s(Te,{modelValue:u.value[`${T.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[E=>u.value[`${T.LayoutItemUUID}.Tags`]=E,E=>P(T,"Tags")],clearable:!0,items:g.value||[],multiple:!0,chips:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!u.value[T.LayoutItemUUID]||u.value[T.LayoutItemUUID].length===0?(A(),z("small",Gs," Will show all tags ")):ne("",!0)]),_:2},1024),s(B,{cols:"6"},{default:c(()=>[s(Te,{modelValue:T.Meta.TagColour,"onUpdate:modelValue":E=>T.Meta.TagColour=E,items:ee.value,label:"Colour","item-title":"Title","item-value":"Value",variant:"outlined","hide-details":""},{selection:c(({item:E})=>[s(pe,{size:"x-small",color:E.raw.Value,class:"mr-2"},null,8,["color"]),re(" "+oe(E.title),1)]),item:c(({props:E,item:N})=>[s(oa,xi(ji(E)),{prepend:c(()=>[s(pe,{size:"x-small",color:N.raw.Value,class:"mr-2"},null,8,["color"])]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):ne("",!0),l.value.Type===F(dt).ADMIN_LAYOUT_TABLE&&(T.SourceType!==F(wt).LAYOUT_ITEM_SOURCE_META||T.MetaField!==F(ve).META_DATA_SOURCE_DATA_LAYOUT)?(A(),j(ge,{key:4},{default:c(()=>[s(B,null,{default:c(()=>[s(Zt,{modelValue:T.DefaultSort,"onUpdate:modelValue":E=>T.DefaultSort=E,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):ne("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),s(ge,null,{default:c(()=>[s(B,null,{default:c(()=>[s(pe,{onClick:G[4]||(G[4]=C=>f.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:c(()=>G[12]||(G[12]=[re("Delete Layout")])),_:1})]),_:1})]),_:1}),f.value?(A(),j(kl,{key:0,modelValue:f.value,"onUpdate:modelValue":G[5]||(G[5]=C=>f.value=C),message:d.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:G[6]||(G[6]=C=>y("delete"))},null,8,["modelValue","message"])):ne("",!0)]),_:1}))}}),qs=je({__name:"EditAdminLayouts",props:Le({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Le(["save"],["update:modelValue"]),setup(a,{emit:o}){const n=qe(a,"modelValue"),l=o,m=V([]),p=V([]),y=V([]),u=Nt(),d=()=>({ID:0,AdminLayoutUUID:Ct(),ConventionID:a.convention.ID,ConventionUUID:a.convention.ConventionUUID,Name:"New Layout",Type:dt.ADMIN_LAYOUT_PANELS,Panels:[]}),f=()=>{let D=!1;[...new Set(y.value)].forEach(P=>{const R=m.value.findIndex(Y=>Y.AdminLayoutUUID===P);R<0||R>=m.value.length||(u.saveAdminLayout(m.value[R]).then(Y=>{Y&&m.value.splice(R,1,Y)}).catch(()=>{}),D=!0)}),p.value.forEach(P=>{u.deleteAdminLayout(P).catch(()=>{})}),p.value=[],y.value=[],D&&l("save")},g=D=>{const w=m.value.findIndex(P=>P.AdminLayoutUUID===D.AdminLayoutUUID);w<0||w>=m.value.length||(m.value[w].ID>0&&p.value.push(D.AdminLayoutUUID),m.value.splice(w,1))};return u.getConventionAdminLayouts(a.convention.ConventionUUID).then(D=>{D&&(m.value=D)}).catch(()=>[]),(D,w)=>(A(),j(sn,{modelValue:n.value,"onUpdate:modelValue":w[2]||(w[2]=P=>n.value=P),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:c(()=>[s(nn,{modelValue:m.value,"onUpdate:modelValue":w[0]||(w[0]=P=>m.value=P),"new-item":d,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:D.title,label:"Name","slot-name-prefix":"panel",onClose:w[1]||(w[1]=P=>n.value=!1),onSave:f},Ma({_:2},[xe(m.value,(P,R)=>({name:`panel_${R}`,fn:c(()=>[s(ct,{class:"px-0 mx-0",fluid:!0},{default:c(()=>[s(ge,null,{default:c(()=>[s(B,{cols:"12"},{default:c(()=>[s(Ws,{modelValue:m.value[R],"onUpdate:modelValue":Y=>m.value[R]=Y,convention:D.convention,layouts:m.value,onChange:Y=>y.value.push(P.AdminLayoutUUID),onDelete:Y=>g(P)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}}),zs=["href","onClick"],Js=je({__name:"OperatorSocket",setup(a){const o=Nt(),n=Oa.getInstance(),l=$a(),m=Ml(),p=V(!1),y=ul({mode:"host",wsUri:o.getRunnerSocketURL()}),u=Yi.getInstance(),d=V(!1),f=V(!1),g=V([]),D=sr(),w=V("Connecting"),P=V([{title:"- Select Duration -",value:-1},{title:"No Expiry",value:0},{title:"5 Minutes",value:5*60*1e3},{title:"30 Minutes",value:30*60*1e3},{title:"1 Hour",value:60*60*1e3},{title:"1.5 Hours",value:90*60*1e3},{title:"2 Hours",value:120*60*1e3},{title:"3 Hours",value:180*60*1e3},{title:"4 Hours",value:240*60*1e3},{title:"5 Hours",value:300*60*1e3},{title:"6 Hours",value:360*60*1e3}]),R=L=>{if(L.editing=!1,L.timer&&clearTimeout(L.timer),!L.selectedDuration){L.expires=void 0,L.timer=void 0;return}const E=new Date;E.setTime(new Date().getTime()+L.selectedDuration),L.expires=E,Y(L),H()},Y=L=>{if(L.expires){if(L.timer&&clearTimeout(L.timer),typeof L.expires=="number"){const E=new Date;E.setTime(L.expires),L.expires=E}L.expires&&"getTime"in L.expires&&(L.timer=setTimeout(()=>{L.timer&&clearTimeout(L.timer),G(L)},L.expires.getTime()-Date.now()))}};y.on("authenticated",()=>{d.value=!0;const L={Key:"",Mode:"host",UserUUID:(l==null?void 0:l.UserUUID)||""},E={Command:"SET_MODE",Params:new Map,Data:JSON.stringify(L)};y.JSON(E)}),y.on("auth_failed",()=>{d.value=!1,w.value="Access Denied"}),y.on("badge_serial_update",L=>{n.emit("badge_serial_update",L)}),y.on("close",()=>{w.value="Disconnected"}),y.on("open",()=>{const L=u.getTokenByService("GrazeAPI");w.value="Authenticating",y.send(`AUTH ${L==null?void 0:L.AccessToken}`)}),y.on("runner_connected",L=>{const E=L,N=g.value.find(ue=>ue.key==E.Key);if(!N){ee(E.Key,E.UserUUID);return}const ie=jl();ie.DisplayName=E.DisplayName,ie.UserUUID=E.UserUUID,N.users.find(ue=>ue.UserUUID==ie.UserUUID)||N.users.push(ie)}),y.on("runner_disconnected",L=>{const E=L,N=g.value.find(ue=>ue.key==E.Key);if(!N)return;const ie=N.users.findIndex(ue=>ue.UserUUID==E.UserUUID);ie<0||N.users.splice(ie,1)}),y.on("started",()=>{g.value.forEach(L=>{const E={Key:L.key},N={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify(E)};y.JSON(N)}),w.value="Connected"}),Bi(()=>{C(),Oa.getInstance().on("layout_opened",E=>{const N=E;if(!y||!d.value||!N||!N.AdminLayoutUUID||!N.RegistrationUUID)return;const ie={Command:"OPEN_LAYOUT",Params:new Map,Data:JSON.stringify(N)};y.JSON(ie)})}),ur(()=>{y.destroy()});const ee=(L,E)=>{const ie={Command:"KICK_RUNNER",Params:new Map,Data:JSON.stringify({DisplayName:"",Key:L,UserUUID:E})};y.JSON(ie)},q=()=>{const L=Ct(),N={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify({Key:L})};y.JSON(N),g.value.push({key:L,name:"New Session",users:[]}),H()},G=L=>{const E=g.value.findIndex(ue=>ue==L);if(E<0)return;const N={Key:L.key},ie={Command:"REMOVE_KEY",Params:new Map,Data:JSON.stringify(N)};y.JSON(ie),g.value.splice(E,1),H()},C=()=>{const L=sessionStorage.getItem("collaboration.sessions");L&&(g.value=JSON.parse(L),g.value.forEach(E=>{typeof E.expires!="number"&&(E.expires=0),Y(E)}))},H=()=>{const L=[];g.value.forEach(E=>{L.push({name:E.name,expires:typeof E.expires=="number"?E.expires:E.expires?E.expires.getTime():0,key:E.key,users:[]})}),sessionStorage.setItem("collaboration.sessions",JSON.stringify(L))},T=L=>{const E=D.resolve({name:"RunnerView",params:{user:l==null?void 0:l.UserUUID,session:L.key}}),N=new URL(location.href);return N.pathname=E.href,N.toString()},fe=L=>{const E=T(L);return Rl(E),f.value=!0,E},_e=L=>{if(typeof L=="number"){const ue=new Date;ue.setTime(L),L=ue}const E=L.getTime()-Date.now(),N=Math.floor(E/(1e3*60*60)),ie=Math.floor(E%(1e3*60*60)/(1e3*60));return N==0&&ie==0?`${Math.floor(E%6e4/1e3)}s`:`${N}hr${N!=1?"s":""} ${ie}min${ie!=1?"s":""}`};return(L,E)=>d.value?(A(),z(ce,{key:0},[s(pe,{icon:"mdi:mdi-link-variant",onClick:E[0]||(E[0]=N=>p.value=!0)}),s(Pa,{modelValue:p.value,"onUpdate:modelValue":E[4]||(E[4]=N=>p.value=N),"hide-extension":!0,"show-save-action":!1,"show-delete-action":!1,"show-reset-action":!1,title:"Collaboration",subtitle:`Connection Status: ${w.value}`},{actions:c(()=>[s(fa),s(pe,{color:"primary",variant:"flat","prepend-icon":"mdi:mdi-link-variant-plus",onClick:q},{default:c(()=>E[5]||(E[5]=[re(" Create Session ")])),_:1})]),default:c(()=>[s(mn,null,{default:c(()=>[(A(!0),z(ce,null,xe(g.value,N=>(A(),z(ce,{key:N.key},[s(pl,{value:N.key},{activator:c(({props:ie})=>[s(oa,lr({ref_for:!0},ie),{default:c(()=>[s(fr,null,{default:c(()=>[s(ge,null,{default:c(()=>[s(B,{style:{"max-width":"84px"}},{default:c(()=>[se("a",{href:fe(N),onClick:vt(ue=>fe(N),["prevent","stop"]),class:"text-white text-decoration-none"},[s(pe,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant",color:"success",class:"mr-2",title:"Copy Link"})],8,zs),s(pe,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant-remove",color:"error",class:"mr-2",title:"Terminate",onClick:vt(ue=>G(N),["stop"])},null,8,["onClick"])]),_:2},1024),s(B,null,{default:c(()=>[s(Pe,{modelValue:N.name,"onUpdate:modelValue":ue=>N.name=ue,"hide-details":"",variant:"plain",density:"compact",onChange:H,onClick:E[1]||(E[1]=vt(()=>{},["stop"])),onKeydown:E[2]||(E[2]=vt(()=>{},["stop"]))},{append:c(()=>[re(oe(N.users.length),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),default:c(()=>[N.editing?(A(),j(Te,{key:0,label:"Duration",items:P.value,density:"compact","hide-details":!0,modelValue:N.selectedDuration,"onUpdate:modelValue":[ie=>N.selectedDuration=ie,ie=>R(N)],modelModifiers:{number:!0}},null,8,["items","modelValue","onUpdate:modelValue"])):N.expires?(A(),z(ce,{key:1},[se("small",null,[E[6]||(E[6]=se("strong",null,"Expires:",-1)),re(" "+oe(_e(N.expires)),1)]),s(pe,{onClick:ie=>{N.selectedDuration=-1,N.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:c(()=>E[7]||(E[7]=[re(" (Change Expiry) ")])),_:2},1032,["onClick"])],64)):(A(),j(pe,{key:2,onClick:ie=>{N.selectedDuration=-1,N.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:c(()=>E[8]||(E[8]=[re(" (Set Expiry) ")])),_:2},1032,["onClick"])),(A(!0),z(ce,null,xe(N.users,ie=>(A(),j(oa,{key:`${N.key}.${ie.UserUUID}`},{append:c(()=>[s(pe,{variant:"flat",size:"small",icon:"mdi:mdi-account-network-off",title:"Disconnect User",onClick:ue=>ee(N.key,ie.UserUUID)},null,8,["onClick"])]),prepend:c(()=>[s(vr,{src:F(m)(ie.UserUUID),class:"rounded-circle mr-2 pt-4 d-inline-block",height:"32",width:"32"},null,8,["src"])]),default:c(()=>[re(" "+oe(ie.DisplayName),1)]),_:2},1024))),128))]),_:2},1032,["value"]),s(F(Vl),{value:fe(N),width:"200"},null,8,["value"])],64))),128))]),_:1}),s(_l,{modelValue:f.value,"onUpdate:modelValue":E[3]||(E[3]=N=>f.value=N),message:"Invite Link Copied",timeout:2e3},null,8,["modelValue"])]),_:1},8,["modelValue","subtitle"])],64)):ne("",!0)}}),Ks={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Qs=je({__name:"Paginator",props:Le({itemTotal:{}},{currentPage:{required:!0},currentPageModifiers:{},itemsPerPage:{required:!0},itemsPerPageModifiers:{}}),emits:["update:currentPage","update:itemsPerPage"],setup(a){const o=qe(a,"currentPage"),n=qe(a,"itemsPerPage");return(l,m)=>(A(),j(ct,{fluid:!0},{default:c(()=>[s(ge,{class:"align-center"},{default:c(()=>[s(B,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:c(()=>[s(Pl,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=p=>o.value=p),modelModifiers:{number:!0},length:Math.ceil(l.itemTotal/n.value)},null,8,["modelValue","length"])]),_:1}),s(B,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:c(()=>[s(Te,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=p=>n.value=p),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),s(B,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:c(()=>[s(Pe,{modelValue:o.value,"onUpdate:modelValue":m[2]||(m[2]=p=>o.value=p),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(l.itemTotal/n.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),s(B,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:c(()=>[se("span",Ks,[n.value===-1?(A(),z(ce,{key:0},[re(" 1-"+oe(l.itemTotal)+" of "+oe(l.itemTotal),1)],64)):(A(),z(ce,{key:1},[re(oe((o.value-1)*n.value+1)+" - "+oe(o.value*n.value>=l.itemTotal?l.itemTotal:o.value*n.value)+" of "+oe(l.itemTotal),1)],64))])]),_:1})]),_:1})]),_:1}))}});var Er=(a,o,n)=>{if(!o.has(a))throw TypeError("Cannot "+n)},Kn=(a,o,n)=>(Er(a,o,"read from private field"),n?n.call(a):o.get(a)),Xs=(a,o,n)=>{if(o.has(a))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(a):o.set(a,n)},Zs=(a,o,n,l)=>(Er(a,o,"write to private field"),o.set(a,n),n);const Ir=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"]],eu=[...Ir,["unknown"]].map(a=>a[0]),Ca=new Map(Ir);function tu(a){for(const[o,n]of Ca)if(a===n)return o;return"unknown"}function au(a){if(wr(a))return{width:a.naturalWidth,height:a.naturalHeight};if(Cr(a))return{width:a.width.baseVal.value,height:a.height.baseVal.value};if(kr(a))return{width:a.videoWidth,height:a.videoHeight};if(Rr(a))return{width:a.width,height:a.height};if(Vr(a))return{width:a.displayWidth,height:a.displayHeight};if(Or(a))return{width:a.width,height:a.height};if(Mr(a))return{width:a.width,height:a.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function wr(a){try{return a instanceof HTMLImageElement}catch{return!1}}function Cr(a){try{return a instanceof SVGImageElement}catch{return!1}}function kr(a){try{return a instanceof HTMLVideoElement}catch{return!1}}function Or(a){try{return a instanceof HTMLCanvasElement}catch{return!1}}function Rr(a){try{return a instanceof ImageBitmap}catch{return!1}}function Mr(a){try{return a instanceof OffscreenCanvas}catch{return!1}}function Vr(a){try{return a instanceof VideoFrame}catch{return!1}}function Pr(a){try{return a instanceof Blob}catch{return!1}}function nu(a){try{return a instanceof ImageData}catch{return!1}}function ru(a,o){try{const n=new OffscreenCanvas(a,o);if(n.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return n;throw void 0}catch{const l=document.createElement("canvas");return l.width=a,l.height=o,l}}async function $r(a){if(wr(a)&&!await su(a))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(Cr(a)&&!await uu(a))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(Vr(a)&&du(a))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(kr(a)&&(a.readyState===0||a.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(Rr(a)&&mu(a))throw new DOMException("The image source is detached.","InvalidStateError");const{width:o,height:n}=au(a);if(o===0||n===0)return null;const l=ru(o,n).getContext("2d");l.drawImage(a,0,0);try{return l.getImageData(0,0,o,n)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function ou(a){let o;try{if(globalThis.createImageBitmap)o=await createImageBitmap(a);else if(globalThis.Image){o=new Image;let n="";try{n=URL.createObjectURL(a),o.src=n,await o.decode()}finally{URL.revokeObjectURL(n)}}else return a}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}return await $r(o)}function iu(a){const{width:o,height:n}=a;if(o===0||n===0)return null;const l=a.getContext("2d");try{return l.getImageData(0,0,o,n)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function lu(a){if(Pr(a))return await ou(a);if(nu(a)){if(cu(a))throw new DOMException("The image data has been detached.","InvalidStateError");return a}return Or(a)||Mr(a)?iu(a):await $r(a)}async function su(a){try{return await a.decode(),!0}catch{return!1}}async function uu(a){var o;try{return await((o=a.decode)==null?void 0:o.call(a)),!0}catch{return!1}}function du(a){return a.format===null}function cu(a){return a.data.buffer.byteLength===0}function mu(a){return a.width===0&&a.height===0}function Qn(a,o){return a instanceof DOMException?new DOMException(`${o}: ${a.message}`,a.name):a instanceof Error?new a.constructor(`${o}: ${a.message}`):new Error(`${o}: ${a}`)}const Xn=["Aztec","Codabar","Code128","Code39","Code93","DataBar","DataBarExpanded","DataMatrix","DXFilmEdge","EAN-13","EAN-8","ITF","Linear-Codes","Matrix-Codes","MaxiCode","MicroQRCode","None","PDF417","QRCode","rMQRCode","UPC-A","UPC-E"];function fu(a){return a.join("|")}function vu(a){const o=Zn(a);let n=0,l=Xn.length-1;for(;n<=l;){const m=Math.floor((n+l)/2),p=Xn[m],y=Zn(p);if(y===o)return p;y<o?n=m+1:l=m-1}return"None"}function Zn(a){return a.toLowerCase().replace(/_-\[\]/g,"")}function pu(a,o){return a.Binarizer[o]}function yu(a,o){return a.CharacterSet[o]}const gu=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function hu(a){return gu[a.value]}function Uu(a,o){return a.EanAddOnSymbol[o]}function Tu(a,o){return a.TextMode[o]}const ia={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!1,validateCode39CheckSum:!1,validateITFCheckSum:!1,returnCodabarStartEnd:!1,returnErrors:!1,eanAddOnSymbol:"Read",textMode:"Plain",characterSet:"Unknown"};function Lr(a,o){return{...o,formats:fu(o.formats),binarizer:pu(a,o.binarizer),eanAddOnSymbol:Uu(a,o.eanAddOnSymbol),textMode:Tu(a,o.textMode),characterSet:yu(a,o.characterSet)}}function Fr(a){return{...a,format:vu(a.format),eccLevel:a.eccLevel,contentType:hu(a.contentType)}}const bu={locateFile:(a,o)=>{const n=a.match(/_(.+?)\.wasm$/);return n?`https://fastly.jsdelivr.net/npm/zxing-wasm@1.1.3/dist/${n[1]}/${a}`:o+a}};let er=new WeakMap;function pn(a,o){var n;const l=er.get(a);if(l!=null&&l.modulePromise&&o===void 0)return l.modulePromise;const m=(n=l==null?void 0:l.moduleOverrides)!=null?n:bu,p=a({...m});return er.set(a,{moduleOverrides:m,modulePromise:p}),p}async function _u(a,o,n=ia){const l={...ia,...n},m=await pn(a),{size:p}=o,y=new Uint8Array(await o.arrayBuffer()),u=m._malloc(p);m.HEAPU8.set(y,u);const d=m.readBarcodesFromImage(u,p,Lr(m,l));m._free(u);const f=[];for(let g=0;g<d.size();++g)f.push(Fr(d.get(g)));return f}async function Su(a,o,n=ia){const l={...ia,...n},m=await pn(a),{data:p,width:y,height:u,data:{byteLength:d}}=o,f=m._malloc(d);m.HEAPU8.set(p,f);const g=m.readBarcodesFromPixmap(f,y,u,Lr(m,l));m._free(f);const D=[];for(let w=0;w<g.size();++w)D.push(Fr(g.get(w)));return D}({...ia,formats:[...ia.formats]});var yn=(()=>{var a=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(o={}){var n=o,l,m;n.ready=new Promise((e,t)=>{l=e,m=t});var p=Object.assign({},n),y="./this.program",u=typeof window=="object",d=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var f="";function g(e){return n.locateFile?n.locateFile(e,f):f+e}var D;(u||d)&&(d?f=self.location.href:typeof document<"u"&&document.currentScript&&(f=document.currentScript.src),a&&(f=a),f.indexOf("blob:")!==0?f=f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):f="",d&&(D=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)})),n.print||console.log.bind(console);var w=n.printErr||console.error.bind(console);Object.assign(n,p),p=null,n.arguments&&n.arguments,n.thisProgram&&(y=n.thisProgram),n.quit&&n.quit;var P;n.wasmBinary&&(P=n.wasmBinary),typeof WebAssembly!="object"&&Be("no native wasm support detected");var R,Y=!1,ee,q,G,C,H,T,fe,_e;function L(){var e=R.buffer;n.HEAP8=ee=new Int8Array(e),n.HEAP16=G=new Int16Array(e),n.HEAPU8=q=new Uint8Array(e),n.HEAPU16=C=new Uint16Array(e),n.HEAP32=H=new Int32Array(e),n.HEAPU32=T=new Uint32Array(e),n.HEAPF32=fe=new Float32Array(e),n.HEAPF64=_e=new Float64Array(e)}var E=[],N=[],ie=[];function ue(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)rt(n.preRun.shift());Ke(E)}function yt(){Ke(N)}function gt(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Ge(n.postRun.shift());Ke(ie)}function rt(e){E.unshift(e)}function kt(e){N.unshift(e)}function Ge(e){ie.unshift(e)}var Ne=0,et=null;function ht(e){var t;Ne++,(t=n.monitorRunDependencies)===null||t===void 0||t.call(n,Ne)}function Ye(e){var t;if(Ne--,(t=n.monitorRunDependencies)===null||t===void 0||t.call(n,Ne),Ne==0&&et){var r=et;et=null,r()}}function Be(e){var t;(t=n.onAbort)===null||t===void 0||t.call(n,e),e="Aborted("+e+")",w(e),Y=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw m(r),r}var Ot="data:application/octet-stream;base64,",Ut=e=>e.startsWith(Ot),Je;Je="zxing_reader.wasm",Ut(Je)||(Je=g(Je));function Tt(e){if(e==Je&&P)return new Uint8Array(P);if(D)return D(e);throw"both async and sync fetching of the wasm failed"}function Rt(e){return!P&&(u||d)&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>Tt(e)):Promise.resolve().then(()=>Tt(e))}function bt(e,t,r){return Rt(e).then(i=>WebAssembly.instantiate(i,t)).then(i=>i).then(r,i=>{w(`failed to asynchronously prepare wasm: ${i}`),Be(i)})}function Bt(e,t,r,i){return!e&&typeof WebAssembly.instantiateStreaming=="function"&&!Ut(t)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(v=>{var U=WebAssembly.instantiateStreaming(v,r);return U.then(i,function(b){return w(`wasm streaming compile failed: ${b}`),w("falling back to ArrayBuffer instantiation"),bt(t,r,i)})}):bt(t,r,i)}function Ht(){var e={a:gi};function t(i,v){return Oe=i.exports,R=Oe.ia,L(),Tn=Oe.ma,kt(Oe.ja),Ye(),Oe}ht();function r(i){t(i.instance)}if(n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(i){w(`Module.instantiateWasm callback failed with error: ${i}`),m(i)}return Bt(P,Je,e,r).catch(m),{}}var Ke=e=>{for(;e.length>0;)e.shift()(n)};n.noExitRuntime;var Re=[],tt=0,ya=e=>{var t=new Wt(e);return t.get_caught()||(t.set_caught(!0),tt--),t.set_rethrown(!1),Re.push(t),Vn(t.excPtr),t.get_exception_ptr()},ot=0,Gt=()=>{Se(0,0);var e=Re.pop();Mn(e.excPtr),ot=0};function Wt(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(t){T[this.ptr+4>>2]=t},this.get_type=function(){return T[this.ptr+4>>2]},this.set_destructor=function(t){T[this.ptr+8>>2]=t},this.get_destructor=function(){return T[this.ptr+8>>2]},this.set_caught=function(t){t=t?1:0,ee[this.ptr+12>>0]=t},this.get_caught=function(){return ee[this.ptr+12>>0]!=0},this.set_rethrown=function(t){t=t?1:0,ee[this.ptr+13>>0]=t},this.get_rethrown=function(){return ee[this.ptr+13>>0]!=0},this.init=function(t,r){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(r)},this.set_adjusted_ptr=function(t){T[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return T[this.ptr+16>>2]},this.get_exception_ptr=function(){var t=$n(this.get_type());if(t)return T[this.excPtr>>2];var r=this.get_adjusted_ptr();return r!==0?r:this.excPtr}}var xt=e=>{throw ot||(ot=e),ot},mt=e=>{var t=ot;if(!t)return ma(0),0;var r=new Wt(t);r.set_adjusted_ptr(t);var i=r.get_type();if(!i)return ma(0),t;for(var v in e){var U=e[v];if(U===0||U===i)break;var b=r.ptr+16;if(Pn(U,i,b))return ma(U),t}return ma(i),t},Fa=()=>mt([]),at=e=>mt([e]),Mt=(e,t)=>mt([e,t]),be=()=>{var e=Re.pop();e||Be("no exception to throw");var t=e.excPtr;throw e.get_rethrown()||(Re.push(e),e.set_rethrown(!0),e.set_caught(!1),tt++),ot=t,ot},Na=(e,t,r)=>{var i=new Wt(e);throw i.init(t,r),ot=e,tt++,ot},xa=()=>tt,_t={},la=e=>{for(;e.length;){var t=e.pop(),r=e.pop();r(t)}};function qt(e){return this.fromWireType(H[e>>2])}var Vt={},St={},zt={},ga,Jt=e=>{throw new ga(e)},Dt=(e,t,r)=>{e.forEach(function(_){zt[_]=t});function i(_){var I=r(_);I.length!==e.length&&Jt("Mismatched type converter count");for(var M=0;M<e.length;++M)Qe(e[M],I[M])}var v=new Array(t.length),U=[],b=0;t.forEach((_,I)=>{St.hasOwnProperty(_)?v[I]=St[_]:(U.push(_),Vt.hasOwnProperty(_)||(Vt[_]=[]),Vt[_].push(()=>{v[I]=St[_],++b,b===U.length&&i(v)}))}),U.length===0&&i(v)},sa=e=>{var t=_t[e];delete _t[e];var r=t.rawConstructor,i=t.rawDestructor,v=t.fields,U=v.map(b=>b.getterReturnType).concat(v.map(b=>b.setterArgumentType));Dt([e],U,b=>{var _={};return v.forEach((I,M)=>{var x=I.fieldName,te=b[M],ae=I.getter,le=I.getterContext,De=b[M+v.length],we=I.setter,Ue=I.setterContext;_[x]={read:Fe=>te.fromWireType(ae(le,Fe)),write:(Fe,k)=>{var W=[];we(Ue,Fe,De.toWireType(W,k)),la(W)}}}),[{name:t.name,fromWireType:I=>{var M={};for(var x in _)M[x]=_[x].read(I);return i(I),M},toWireType:(I,M)=>{for(var x in _)if(!(x in M))throw new TypeError(`Missing field: "${x}"`);var te=r();for(x in _)_[x].write(te,M[x]);return I!==null&&I.push(i,te),te},argPackAdvance:S,readValueFromPointer:qt,destructorFunction:i}]})},ja=(e,t,r,i,v)=>{},Ya=()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ha=e},ha,Me=e=>{for(var t="",r=e;q[r];)t+=ha[q[r++]];return t},it,me=e=>{throw new it(e)};function Ua(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i=t.name;if(e||me(`type "${i}" must have a positive integer typeid pointer`),St.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;me(`Cannot register type '${i}' twice`)}if(St[e]=t,delete zt[e],Vt.hasOwnProperty(e)){var v=Vt[e];delete Vt[e],v.forEach(U=>U())}}function Qe(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Ua(e,t,r)}var S=8,h=(e,t,r,i)=>{t=Me(t),Qe(e,{name:t,fromWireType:function(v){return!!v},toWireType:function(v,U){return U?r:i},argPackAdvance:S,readValueFromPointer:function(v){return this.fromWireType(q[v])},destructorFunction:null})},O=e=>({count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}),$=e=>{function t(r){return r.$$.ptrType.registeredClass.name}me(t(e)+" instance already deleted")},J=!1,ye=e=>{},At=e=>{e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)},he=e=>{e.count.value-=1;var t=e.count.value===0;t&&At(e)},Kt=(e,t,r)=>{if(t===r)return e;if(r.baseClass===void 0)return null;var i=Kt(e,t,r.baseClass);return i===null?null:r.downcast(i)},Qt={},ua=()=>Object.keys(X).length,Ba=()=>{var e=[];for(var t in X)X.hasOwnProperty(t)&&e.push(X[t]);return e},Q=[],Pt=()=>{for(;Q.length;){var e=Q.pop();e.$$.deleteScheduled=!1,e.delete()}},He,de=e=>{He=e,Q.length&&He&&He(Pt)},lt=()=>{n.getInheritedInstanceCount=ua,n.getLiveInheritedInstances=Ba,n.flushPendingDeletes=Pt,n.setDelayFunction=de},X={},Ta=(e,t)=>{for(t===void 0&&me("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t},jt=(e,t)=>(t=Ta(e,t),X[t]),st=(e,t)=>{(!t.ptrType||!t.ptr)&&Jt("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,i=!!t.smartPtr;return r!==i&&Jt("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Z(Object.create(e,{$$:{value:t,writable:!0}}))};function K(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=jt(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var i=r.clone();return this.destructor(e),i}function v(){return this.isSmartPointer?st(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):st(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var U=this.registeredClass.getActualType(t),b=Qt[U];if(!b)return v.call(this);var _;this.isConst?_=b.constPointerType:_=b.pointerType;var I=Kt(t,this.registeredClass,_.registeredClass);return I===null?v.call(this):this.isSmartPointer?st(_.registeredClass.instancePrototype,{ptrType:_,ptr:I,smartPtrType:this,smartPtr:e}):st(_.registeredClass.instancePrototype,{ptrType:_,ptr:I})}var Z=e=>typeof FinalizationRegistry>"u"?(Z=t=>t,e):(J=new FinalizationRegistry(t=>{he(t.$$)}),Z=t=>{var r=t.$$,i=!!r.smartPtr;if(i){var v={$$:r};J.register(t,v,t)}return t},ye=t=>J.unregister(t),Z(e)),Xe=()=>{Object.assign(ba.prototype,{isAliasOf(e){if(!(this instanceof ba)||!(e instanceof ba))return!1;var t=this.$$.ptrType.registeredClass,r=this.$$.ptr;e.$$=e.$$;for(var i=e.$$.ptrType.registeredClass,v=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;i.baseClass;)v=i.upcast(v),i=i.baseClass;return t===i&&r===v},clone(){if(this.$$.ptr||$(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Z(Object.create(Object.getPrototypeOf(this),{$$:{value:O(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e},delete(){this.$$.ptr||$(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&me("Object already scheduled for deletion"),ye(this),he(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||$(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&me("Object already scheduled for deletion"),Q.push(this),Q.length===1&&He&&He(Pt),this.$$.deleteScheduled=!0,this}})};function ba(){}var da=(e,t)=>Object.defineProperty(t,"name",{value:e}),gn=(e,t,r)=>{if(e[t].overloadTable===void 0){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||me(`Function '${r}' called with an invalid number of arguments (${arguments.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}},Ha=(e,t,r)=>{n.hasOwnProperty(e)?((r===void 0||n[e].overloadTable!==void 0&&n[e].overloadTable[r]!==void 0)&&me(`Cannot register public name '${e}' twice`),gn(n,e,e),n.hasOwnProperty(r)&&me(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),n[e].overloadTable[r]=t):(n[e]=t,r!==void 0&&(n[e].numArguments=r))},eo=48,to=57,ao=e=>{if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=eo&&t<=to?`_${e}`:e};function no(e,t,r,i,v,U,b,_){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=i,this.baseClass=v,this.getActualType=U,this.upcast=b,this.downcast=_,this.pureVirtualFunctions=[]}var Ga=(e,t,r)=>{for(;t!==r;)t.upcast||me(`Expected null or instance of ${r.name}, got an instance of ${t.name}`),e=t.upcast(e),t=t.baseClass;return e};function ro(e,t){if(t===null)return this.isReference&&me(`null is not a valid ${this.name}`),0;t.$$||me(`Cannot pass "${Ka(t)}" as a ${this.name}`),t.$$.ptr||me(`Cannot pass deleted object as a pointer of type ${this.name}`);var r=t.$$.ptrType.registeredClass,i=Ga(t.$$.ptr,r,this.registeredClass);return i}function oo(e,t){var r;if(t===null)return this.isReference&&me(`null is not a valid ${this.name}`),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;(!t||!t.$$)&&me(`Cannot pass "${Ka(t)}" as a ${this.name}`),t.$$.ptr||me(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&me(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var i=t.$$.ptrType.registeredClass;if(r=Ga(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&me("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:me(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var v=t.clone();r=this.rawShare(r,Et.toHandle(()=>v.delete())),e!==null&&e.push(this.rawDestructor,r)}break;default:me("Unsupporting sharing policy")}return r}function io(e,t){if(t===null)return this.isReference&&me(`null is not a valid ${this.name}`),0;t.$$||me(`Cannot pass "${Ka(t)}" as a ${this.name}`),t.$$.ptr||me(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&me(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var r=t.$$.ptrType.registeredClass,i=Ga(t.$$.ptr,r,this.registeredClass);return i}function hn(e){return this.fromWireType(T[e>>2])}var lo=()=>{Object.assign(_a.prototype,{getPointee(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},destructor(e){var t;(t=this.rawDestructor)===null||t===void 0||t.call(this,e)},argPackAdvance:S,readValueFromPointer:hn,deleteObject(e){e!==null&&e.delete()},fromWireType:K})};function _a(e,t,r,i,v,U,b,_,I,M,x){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=i,this.isSmartPointer=v,this.pointeeType=U,this.sharingPolicy=b,this.rawGetPointee=_,this.rawConstructor=I,this.rawShare=M,this.rawDestructor=x,!v&&t.baseClass===void 0?i?(this.toWireType=ro,this.destructorFunction=null):(this.toWireType=io,this.destructorFunction=null):this.toWireType=oo}var Un=(e,t,r)=>{n.hasOwnProperty(e)||Jt("Replacing nonexistant public symbol"),n[e].overloadTable!==void 0&&r!==void 0?n[e].overloadTable[r]=t:(n[e]=t,n[e].argCount=r)},so=(e,t,r)=>{var i=n["dynCall_"+e];return r&&r.length?i.apply(null,[t].concat(r)):i.call(null,t)},Sa=[],Tn,Ae=e=>{var t=Sa[e];return t||(e>=Sa.length&&(Sa.length=e+1),Sa[e]=t=Tn.get(e)),t},uo=(e,t,r)=>{if(e.includes("j"))return so(e,t,r);var i=Ae(t).apply(null,r);return i},co=(e,t)=>{var r=[];return function(){return r.length=0,Object.assign(r,arguments),uo(e,t,r)}},ut=(e,t)=>{e=Me(e);function r(){return e.includes("j")?co(e,t):Ae(t)}var i=r();return typeof i!="function"&&me(`unknown function pointer with signature ${e}: ${t}`),i},mo=(e,t)=>{var r=da(t,function(i){this.name=t,this.message=i;var v=new Error(i).stack;v!==void 0&&(this.stack=this.toString()+`
`+v.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},r},bn,_n=e=>{var t=Rn(e),r=Me(t);return It(t),r},Da=(e,t)=>{var r=[],i={};function v(U){if(!i[U]&&!St[U]){if(zt[U]){zt[U].forEach(v);return}r.push(U),i[U]=!0}}throw t.forEach(v),new bn(`${e}: `+r.map(_n).join([", "]))},fo=(e,t,r,i,v,U,b,_,I,M,x,te,ae)=>{x=Me(x),U=ut(v,U),_&&(_=ut(b,_)),M&&(M=ut(I,M)),ae=ut(te,ae);var le=ao(x);Ha(le,function(){Da(`Cannot construct ${x} due to unbound types`,[i])}),Dt([e,t,r],i?[i]:[],function(De){De=De[0];var we,Ue;i?(we=De.registeredClass,Ue=we.instancePrototype):Ue=ba.prototype;var Fe=da(x,function(){if(Object.getPrototypeOf(this)!==k)throw new it("Use 'new' to construct "+x);if(W.constructor_body===void 0)throw new it(x+" has no accessible constructor");var xn=W.constructor_body[arguments.length];if(xn===void 0)throw new it(`Tried to invoke ctor of ${x} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(W.constructor_body).toString()}) parameters instead!`);return xn.apply(this,arguments)}),k=Object.create(Ue,{constructor:{value:Fe}});Fe.prototype=k;var W=new no(x,Fe,k,ae,we,U,_,M);if(W.baseClass){var Ce,$e;($e=(Ce=W.baseClass).__derivedClasses)!==null&&$e!==void 0||(Ce.__derivedClasses=[]),W.baseClass.__derivedClasses.push(W)}var Xt=new _a(x,W,!0,!1,!1),Ia=new _a(x+"*",W,!1,!1,!1),Nn=new _a(x+" const*",W,!1,!0,!1);return Qt[e]={pointerType:Ia,constPointerType:Nn},Un(le,Fe),[Xt,Ia,Nn]})},Wa=(e,t)=>{for(var r=[],i=0;i<e;i++)r.push(T[t+i*4>>2]);return r};function vo(e){for(var t=1;t<e.length;++t)if(e[t]!==null&&e[t].destructorFunction===void 0)return!0;return!1}function qa(e,t,r,i,v,U){var b=t.length;b<2&&me("argTypes array size mismatch! Must at least get return value and 'this' types!");var _=t[1]!==null&&r!==null,I=vo(t),M=t[0].name!=="void",x=b-2,te=new Array(x),ae=[],le=[],De=function(){arguments.length!==x&&me(`function ${e} called with ${arguments.length} arguments, expected ${x}`),le.length=0;var we;ae.length=_?2:1,ae[0]=v,_&&(we=t[1].toWireType(le,this),ae[1]=we);for(var Ue=0;Ue<x;++Ue)te[Ue]=t[Ue+2].toWireType(le,arguments[Ue]),ae.push(te[Ue]);var Fe=i.apply(null,ae);function k(W){if(I)la(le);else for(var Ce=_?1:2;Ce<t.length;Ce++){var $e=Ce===1?we:te[Ce-2];t[Ce].destructorFunction!==null&&t[Ce].destructorFunction($e)}if(M)return t[0].fromWireType(W)}return k(Fe)};return da(e,De)}var po=(e,t,r,i,v,U)=>{var b=Wa(t,r);v=ut(i,v),Dt([],[e],function(_){_=_[0];var I=`constructor ${_.name}`;if(_.registeredClass.constructor_body===void 0&&(_.registeredClass.constructor_body=[]),_.registeredClass.constructor_body[t-1]!==void 0)throw new it(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${_.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return _.registeredClass.constructor_body[t-1]=()=>{Da(`Cannot construct ${_.name} due to unbound types`,b)},Dt([],b,M=>(M.splice(1,0,null),_.registeredClass.constructor_body[t-1]=qa(I,M,null,v,U),[])),[]})},Sn=e=>{e=e.trim();const t=e.indexOf("(");return t!==-1?e.substr(0,t):e},yo=(e,t,r,i,v,U,b,_,I)=>{var M=Wa(r,i);t=Me(t),t=Sn(t),U=ut(v,U),Dt([],[e],function(x){x=x[0];var te=`${x.name}.${t}`;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),_&&x.registeredClass.pureVirtualFunctions.push(t);function ae(){Da(`Cannot call ${te} due to unbound types`,M)}var le=x.registeredClass.instancePrototype,De=le[t];return De===void 0||De.overloadTable===void 0&&De.className!==x.name&&De.argCount===r-2?(ae.argCount=r-2,ae.className=x.name,le[t]=ae):(gn(le,t,te),le[t].overloadTable[r-2]=ae),Dt([],M,function(we){var Ue=qa(te,we,x,U,b);return le[t].overloadTable===void 0?(Ue.argCount=r-2,le[t]=Ue):le[t].overloadTable[r-2]=Ue,[]}),[]})};function go(){Object.assign(Dn.prototype,{get(e){return this.allocated[e]},has(e){return this.allocated[e]!==void 0},allocate(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},free(e){this.allocated[e]=void 0,this.freelist.push(e)}})}function Dn(){this.allocated=[void 0],this.freelist=[]}var nt=new Dn,za=e=>{e>=nt.reserved&&--nt.get(e).refcount===0&&nt.free(e)},ho=()=>{for(var e=0,t=nt.reserved;t<nt.allocated.length;++t)nt.allocated[t]!==void 0&&++e;return e},Uo=()=>{nt.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),nt.reserved=nt.allocated.length,n.count_emval_handles=ho},Et={toValue:e=>(e||me("Cannot use deleted val. handle = "+e),nt.get(e).value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return nt.allocate({refcount:1,value:e})}}},To=(e,t)=>{t=Me(t),Qe(e,{name:t,fromWireType:r=>{var i=Et.toValue(r);return za(r),i},toWireType:(r,i)=>Et.toHandle(i),argPackAdvance:S,readValueFromPointer:qt,destructorFunction:null})},bo=(e,t,r)=>{switch(t){case 1:return r?function(i){return this.fromWireType(ee[i>>0])}:function(i){return this.fromWireType(q[i>>0])};case 2:return r?function(i){return this.fromWireType(G[i>>1])}:function(i){return this.fromWireType(C[i>>1])};case 4:return r?function(i){return this.fromWireType(H[i>>2])}:function(i){return this.fromWireType(T[i>>2])};default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},_o=(e,t,r,i)=>{t=Me(t);function v(){}v.values={},Qe(e,{name:t,constructor:v,fromWireType:function(U){return this.constructor.values[U]},toWireType:(U,b)=>b.value,argPackAdvance:S,readValueFromPointer:bo(t,r,i),destructorFunction:null}),Ha(t,v)},Ja=(e,t)=>{var r=St[e];return r===void 0&&me(t+" has unknown type "+_n(e)),r},So=(e,t,r)=>{var i=Ja(e,"enum");t=Me(t);var v=i.constructor,U=Object.create(i.constructor.prototype,{value:{value:r},constructor:{value:da(`${i.name}_${t}`,function(){})}});v.values[r]=U,v[t]=U},Ka=e=>{if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e},Do=(e,t)=>{switch(t){case 4:return function(r){return this.fromWireType(fe[r>>2])};case 8:return function(r){return this.fromWireType(_e[r>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},Ao=(e,t,r)=>{t=Me(t),Qe(e,{name:t,fromWireType:i=>i,toWireType:(i,v)=>v,argPackAdvance:S,readValueFromPointer:Do(t,r),destructorFunction:null})},Eo=(e,t,r,i,v,U,b)=>{var _=Wa(t,r);e=Me(e),e=Sn(e),v=ut(i,v),Ha(e,function(){Da(`Cannot call ${e} due to unbound types`,_)},t-1),Dt([],_,function(I){var M=[I[0],null].concat(I.slice(1));return Un(e,qa(e,M,null,v,U),t-1),[]})},Io=(e,t,r)=>{switch(t){case 1:return r?i=>ee[i>>0]:i=>q[i>>0];case 2:return r?i=>G[i>>1]:i=>C[i>>1];case 4:return r?i=>H[i>>2]:i=>T[i>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},wo=(e,t,r,i,v)=>{t=Me(t);var U=x=>x;if(i===0){var b=32-8*r;U=x=>x<<b>>>b}var _=t.includes("unsigned"),I=(x,te)=>{},M;_?M=function(x,te){return I(te,this.name),te>>>0}:M=function(x,te){return I(te,this.name),te},Qe(e,{name:t,fromWireType:U,toWireType:M,argPackAdvance:S,readValueFromPointer:Io(t,r,i!==0),destructorFunction:null})},Co=(e,t,r)=>{var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],v=i[t];function U(b){var _=T[b>>2],I=T[b+4>>2];return new v(ee.buffer,I,_)}r=Me(r),Qe(e,{name:r,fromWireType:U,argPackAdvance:S,readValueFromPointer:U},{ignoreDuplicateRegistrations:!0})},An=(e,t,r,i)=>{if(!(i>0))return 0;for(var v=r,U=r+i-1,b=0;b<e.length;++b){var _=e.charCodeAt(b);if(_>=55296&&_<=57343){var I=e.charCodeAt(++b);_=65536+((_&1023)<<10)|I&1023}if(_<=127){if(r>=U)break;t[r++]=_}else if(_<=2047){if(r+1>=U)break;t[r++]=192|_>>6,t[r++]=128|_&63}else if(_<=65535){if(r+2>=U)break;t[r++]=224|_>>12,t[r++]=128|_>>6&63,t[r++]=128|_&63}else{if(r+3>=U)break;t[r++]=240|_>>18,t[r++]=128|_>>12&63,t[r++]=128|_>>6&63,t[r++]=128|_&63}}return t[r]=0,r-v},ko=(e,t,r)=>An(e,q,t,r),En=e=>{for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i<=127?t++:i<=2047?t+=2:i>=55296&&i<=57343?(t+=4,++r):t+=3}return t},In=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Oo=(e,t,r)=>{for(var i=t+r,v=t;e[v]&&!(v>=i);)++v;if(v-t>16&&e.buffer&&In)return In.decode(e.subarray(t,v));for(var U="";t<v;){var b=e[t++];if(!(b&128)){U+=String.fromCharCode(b);continue}var _=e[t++]&63;if((b&224)==192){U+=String.fromCharCode((b&31)<<6|_);continue}var I=e[t++]&63;if((b&240)==224?b=(b&15)<<12|_<<6|I:b=(b&7)<<18|_<<12|I<<6|e[t++]&63,b<65536)U+=String.fromCharCode(b);else{var M=b-65536;U+=String.fromCharCode(55296|M>>10,56320|M&1023)}}return U},Qa=(e,t)=>e?Oo(q,e,t):"",Ro=(e,t)=>{t=Me(t);var r=t==="std::string";Qe(e,{name:t,fromWireType(i){var v=T[i>>2],U=i+4,b;if(r)for(var _=U,I=0;I<=v;++I){var M=U+I;if(I==v||q[M]==0){var x=M-_,te=Qa(_,x);b===void 0?b=te:(b+="\0",b+=te),_=M+1}}else{for(var ae=new Array(v),I=0;I<v;++I)ae[I]=String.fromCharCode(q[U+I]);b=ae.join("")}return It(i),b},toWireType(i,v){v instanceof ArrayBuffer&&(v=new Uint8Array(v));var U,b=typeof v=="string";b||v instanceof Uint8Array||v instanceof Uint8ClampedArray||v instanceof Int8Array||me("Cannot pass non-string to std::string"),r&&b?U=En(v):U=v.length;var _=en(4+U+1),I=_+4;if(T[_>>2]=U,r&&b)ko(v,I,U+1);else if(b)for(var M=0;M<U;++M){var x=v.charCodeAt(M);x>255&&(It(I),me("String has UTF-16 code units that do not fit in 8 bits")),q[I+M]=x}else for(var M=0;M<U;++M)q[I+M]=v[M];return i!==null&&i.push(It,_),_},argPackAdvance:S,readValueFromPointer:hn,destructorFunction(i){It(i)}})},wn=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Mo=(e,t)=>{for(var r=e,i=r>>1,v=i+t/2;!(i>=v)&&C[i];)++i;if(r=i<<1,r-e>32&&wn)return wn.decode(q.subarray(e,r));for(var U="",b=0;!(b>=t/2);++b){var _=G[e+b*2>>1];if(_==0)break;U+=String.fromCharCode(_)}return U},Vo=(e,t,r)=>{var i;if((i=r)!==null&&i!==void 0||(r=2147483647),r<2)return 0;r-=2;for(var v=t,U=r<e.length*2?r/2:e.length,b=0;b<U;++b){var _=e.charCodeAt(b);G[t>>1]=_,t+=2}return G[t>>1]=0,t-v},Po=e=>e.length*2,$o=(e,t)=>{for(var r=0,i="";!(r>=t/4);){var v=H[e+r*4>>2];if(v==0)break;if(++r,v>=65536){var U=v-65536;i+=String.fromCharCode(55296|U>>10,56320|U&1023)}else i+=String.fromCharCode(v)}return i},Lo=(e,t,r)=>{var i;if((i=r)!==null&&i!==void 0||(r=2147483647),r<4)return 0;for(var v=t,U=v+r-4,b=0;b<e.length;++b){var _=e.charCodeAt(b);if(_>=55296&&_<=57343){var I=e.charCodeAt(++b);_=65536+((_&1023)<<10)|I&1023}if(H[t>>2]=_,t+=4,t+4>U)break}return H[t>>2]=0,t-v},Fo=e=>{for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,t+=4}return t},No=(e,t,r)=>{r=Me(r);var i,v,U,b,_;t===2?(i=Mo,v=Vo,b=Po,U=()=>C,_=1):t===4&&(i=$o,v=Lo,b=Fo,U=()=>T,_=2),Qe(e,{name:r,fromWireType:I=>{for(var M=T[I>>2],x=U(),te,ae=I+4,le=0;le<=M;++le){var De=I+4+le*t;if(le==M||x[De>>_]==0){var we=De-ae,Ue=i(ae,we);te===void 0?te=Ue:(te+="\0",te+=Ue),ae=De+t}}return It(I),te},toWireType:(I,M)=>{typeof M!="string"&&me(`Cannot pass non-string to C++ string type ${r}`);var x=b(M),te=en(4+x+t);return T[te>>2]=x>>_,v(M,te+4,x+t),I!==null&&I.push(It,te),te},argPackAdvance:S,readValueFromPointer:qt,destructorFunction(I){It(I)}})},xo=(e,t,r,i,v,U)=>{_t[e]={name:Me(t),rawConstructor:ut(r,i),rawDestructor:ut(v,U),fields:[]}},jo=(e,t,r,i,v,U,b,_,I,M)=>{_t[e].fields.push({fieldName:Me(t),getterReturnType:r,getter:ut(i,v),getterContext:U,setterArgumentType:b,setter:ut(_,I),setterContext:M})},Yo=(e,t)=>{t=Me(t),Qe(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:(r,i)=>{}})},Xa=[],Bo=(e,t,r,i)=>(e=Xa[e],t=Et.toValue(t),e(null,t,r,i)),Ho={},Go=e=>{var t=Ho[e];return t===void 0?Me(e):t},Cn=()=>{if(typeof globalThis=="object")return globalThis;function e(t){t.$$$embind_global$$$=t;var r=typeof $$$embind_global$$$=="object"&&t.$$$embind_global$$$==t;return r||delete t.$$$embind_global$$$,r}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&e(global)?$$$embind_global$$$=global:typeof self=="object"&&e(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Wo=e=>e===0?Et.toHandle(Cn()):(e=Go(e),Et.toHandle(Cn()[e])),qo=e=>{var t=Xa.length;return Xa.push(e),t},zo=(e,t)=>{for(var r=new Array(e),i=0;i<e;++i)r[i]=Ja(T[t+i*4>>2],"parameter "+i);return r},Jo=Reflect.construct,Ko=(e,t,r)=>{var i=[],v=e.toWireType(i,r);return i.length&&(T[t>>2]=Et.toHandle(i)),v},Qo=(e,t,r)=>{var i=zo(e,t),v=i.shift();e--;var U=new Array(e),b=(I,M,x,te)=>{for(var ae=0,le=0;le<e;++le)U[le]=i[le].readValueFromPointer(te+ae),ae+=i[le].argPackAdvance;for(var De=r===1?Jo(M,U):M.apply(I,U),le=0;le<e;++le){var we,Ue;(we=(Ue=i[le]).deleteObject)===null||we===void 0||we.call(Ue,U[le])}return Ko(v,x,De)},_=`methodCaller<(${i.map(I=>I.name).join(", ")}) => ${v.name}>`;return qo(da(_,b))},Xo=e=>{e>4&&(nt.get(e).refcount+=1)},Zo=e=>{var t=Et.toValue(e);la(t),za(e)},ei=(e,t)=>{e=Ja(e,"_emval_take_value");var r=e.readValueFromPointer(t);return Et.toHandle(r)},ti=()=>{Be("")},ai=(e,t,r)=>q.copyWithin(e,t,t+r),ni=()=>2147483648,ri=e=>{var t=R.buffer,r=(e-t.byteLength+65535)/65536;try{return R.grow(r),L(),1}catch{}},oi=e=>{var t=q.length;e>>>=0;var r=ni();if(e>r)return!1;for(var i=(I,M)=>I+(M-I%M)%M,v=1;v<=4;v*=2){var U=t*(1+.2/v);U=Math.min(U,e+100663296);var b=Math.min(r,i(Math.max(e,U),65536)),_=ri(b);if(_)return!0}return!1},Za={},ii=()=>y||"./this.program",ca=()=>{if(!ca.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:ii()};for(var r in Za)Za[r]===void 0?delete t[r]:t[r]=Za[r];var i=[];for(var r in t)i.push(`${r}=${t[r]}`);ca.strings=i}return ca.strings},li=(e,t)=>{for(var r=0;r<e.length;++r)ee[t++>>0]=e.charCodeAt(r);ee[t>>0]=0},si=(e,t)=>{var r=0;return ca().forEach((i,v)=>{var U=t+r;T[e+v*4>>2]=U,li(i,U),r+=i.length+1}),0},ui=(e,t)=>{var r=ca();T[e>>2]=r.length;var i=0;return r.forEach(v=>i+=v.length+1),T[t>>2]=i,0},di=e=>e,Aa=e=>e%4===0&&(e%100!==0||e%400===0),ci=(e,t)=>{for(var r=0,i=0;i<=t;r+=e[i++]);return r},kn=[31,29,31,30,31,30,31,31,30,31,30,31],On=[31,28,31,30,31,30,31,31,30,31,30,31],mi=(e,t)=>{for(var r=new Date(e.getTime());t>0;){var i=Aa(r.getFullYear()),v=r.getMonth(),U=(i?kn:On)[v];if(t>U-r.getDate())t-=U-r.getDate()+1,r.setDate(1),v<11?r.setMonth(v+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1));else return r.setDate(r.getDate()+t),r}return r};function fi(e,t,r){var i=En(e)+1,v=new Array(i);return An(e,v,0,v.length),v}var vi=(e,t)=>{ee.set(e,t)},pi=(e,t,r,i)=>{var v=T[i+40>>2],U={tm_sec:H[i>>2],tm_min:H[i+4>>2],tm_hour:H[i+8>>2],tm_mday:H[i+12>>2],tm_mon:H[i+16>>2],tm_year:H[i+20>>2],tm_wday:H[i+24>>2],tm_yday:H[i+28>>2],tm_isdst:H[i+32>>2],tm_gmtoff:H[i+36>>2],tm_zone:v?Qa(v):""},b=Qa(r),_={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var I in _)b=b.replace(new RegExp(I,"g"),_[I]);var M=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],x=["January","February","March","April","May","June","July","August","September","October","November","December"];function te(k,W,Ce){for(var $e=typeof k=="number"?k.toString():k||"";$e.length<W;)$e=Ce[0]+$e;return $e}function ae(k,W){return te(k,W,"0")}function le(k,W){function Ce(Xt){return Xt<0?-1:Xt>0?1:0}var $e;return($e=Ce(k.getFullYear()-W.getFullYear()))===0&&($e=Ce(k.getMonth()-W.getMonth()))===0&&($e=Ce(k.getDate()-W.getDate())),$e}function De(k){switch(k.getDay()){case 0:return new Date(k.getFullYear()-1,11,29);case 1:return k;case 2:return new Date(k.getFullYear(),0,3);case 3:return new Date(k.getFullYear(),0,2);case 4:return new Date(k.getFullYear(),0,1);case 5:return new Date(k.getFullYear()-1,11,31);case 6:return new Date(k.getFullYear()-1,11,30)}}function we(k){var W=mi(new Date(k.tm_year+1900,0,1),k.tm_yday),Ce=new Date(W.getFullYear(),0,4),$e=new Date(W.getFullYear()+1,0,4),Xt=De(Ce),Ia=De($e);return le(Xt,W)<=0?le(Ia,W)<=0?W.getFullYear()+1:W.getFullYear():W.getFullYear()-1}var Ue={"%a":k=>M[k.tm_wday].substring(0,3),"%A":k=>M[k.tm_wday],"%b":k=>x[k.tm_mon].substring(0,3),"%B":k=>x[k.tm_mon],"%C":k=>{var W=k.tm_year+1900;return ae(W/100|0,2)},"%d":k=>ae(k.tm_mday,2),"%e":k=>te(k.tm_mday,2," "),"%g":k=>we(k).toString().substring(2),"%G":k=>we(k),"%H":k=>ae(k.tm_hour,2),"%I":k=>{var W=k.tm_hour;return W==0?W=12:W>12&&(W-=12),ae(W,2)},"%j":k=>ae(k.tm_mday+ci(Aa(k.tm_year+1900)?kn:On,k.tm_mon-1),3),"%m":k=>ae(k.tm_mon+1,2),"%M":k=>ae(k.tm_min,2),"%n":()=>`
`,"%p":k=>k.tm_hour>=0&&k.tm_hour<12?"AM":"PM","%S":k=>ae(k.tm_sec,2),"%t":()=>"	","%u":k=>k.tm_wday||7,"%U":k=>{var W=k.tm_yday+7-k.tm_wday;return ae(Math.floor(W/7),2)},"%V":k=>{var W=Math.floor((k.tm_yday+7-(k.tm_wday+6)%7)/7);if((k.tm_wday+371-k.tm_yday-2)%7<=2&&W++,W){if(W==53){var Ce=(k.tm_wday+371-k.tm_yday)%7;Ce!=4&&(Ce!=3||!Aa(k.tm_year))&&(W=1)}}else{W=52;var $e=(k.tm_wday+7-k.tm_yday-1)%7;($e==4||$e==5&&Aa(k.tm_year%400-1))&&W++}return ae(W,2)},"%w":k=>k.tm_wday,"%W":k=>{var W=k.tm_yday+7-(k.tm_wday+6)%7;return ae(Math.floor(W/7),2)},"%y":k=>(k.tm_year+1900).toString().substring(2),"%Y":k=>k.tm_year+1900,"%z":k=>{var W=k.tm_gmtoff,Ce=W>=0;return W=Math.abs(W)/60,W=W/60*100+W%60,(Ce?"+":"-")+("0000"+W).slice(-4)},"%Z":k=>k.tm_zone,"%%":()=>"%"};b=b.replace(/%%/g,"\0\0");for(var I in Ue)b.includes(I)&&(b=b.replace(new RegExp(I,"g"),Ue[I](U)));b=b.replace(/\0\0/g,"%");var Fe=fi(b);return Fe.length>t?0:(vi(Fe,e),Fe.length-1)},yi=(e,t,r,i,v)=>pi(e,t,r,i);ga=n.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Ya(),it=n.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},Xe(),lt(),lo(),bn=n.UnboundTypeError=mo(Error,"UnboundTypeError"),go(),Uo();var gi={s:ya,u:Gt,b:Fa,g:at,q:Mt,J:be,f:Na,V:xa,d:xt,da:sa,Q:ja,_:h,ca:fo,ba:po,w:yo,Y:To,x:_o,h:So,L:Ao,M:Eo,t:wo,o:Co,K:Ro,C:No,A:xo,ea:jo,$:Yo,R:Bo,ha:za,fa:Wo,Z:Qo,N:Xo,O:Zo,aa:ei,B:ti,X:ai,W:oi,T:si,U:ui,E:Mi,D:_i,F:Ri,n:Vi,a:hi,e:Di,m:bi,k:Ei,H:ki,v:wi,G:Oi,z:$i,P:Fi,l:Ai,j:Si,c:Ti,p:Ui,I:Ci,r:Pi,i:Ii,y:Li,ga:di,S:yi},Oe=Ht(),It=n._free=e=>(It=n._free=Oe.ka)(e),en=n._malloc=e=>(en=n._malloc=Oe.la)(e),Rn=e=>(Rn=Oe.na)(e),Se=(e,t)=>(Se=Oe.oa)(e,t),ma=e=>(ma=Oe.pa)(e),Ee=()=>(Ee=Oe.qa)(),Ie=e=>(Ie=Oe.ra)(e),Mn=e=>(Mn=Oe.sa)(e),Vn=e=>(Vn=Oe.ta)(e),Pn=(e,t,r)=>(Pn=Oe.ua)(e,t,r),$n=e=>($n=Oe.va)(e);n.dynCall_viijii=(e,t,r,i,v,U,b)=>(n.dynCall_viijii=Oe.wa)(e,t,r,i,v,U,b);var Ln=n.dynCall_jiiii=(e,t,r,i,v)=>(Ln=n.dynCall_jiiii=Oe.xa)(e,t,r,i,v);n.dynCall_iiiiij=(e,t,r,i,v,U,b)=>(n.dynCall_iiiiij=Oe.ya)(e,t,r,i,v,U,b),n.dynCall_iiiiijj=(e,t,r,i,v,U,b,_,I)=>(n.dynCall_iiiiijj=Oe.za)(e,t,r,i,v,U,b,_,I),n.dynCall_iiiiiijj=(e,t,r,i,v,U,b,_,I,M)=>(n.dynCall_iiiiiijj=Oe.Aa)(e,t,r,i,v,U,b,_,I,M);function hi(e,t){var r=Ee();try{return Ae(e)(t)}catch(i){if(Ie(r),i!==i+0)throw i;Se(1,0)}}function Ui(e,t,r,i){var v=Ee();try{Ae(e)(t,r,i)}catch(U){if(Ie(v),U!==U+0)throw U;Se(1,0)}}function Ti(e,t,r){var i=Ee();try{Ae(e)(t,r)}catch(v){if(Ie(i),v!==v+0)throw v;Se(1,0)}}function bi(e,t,r,i){var v=Ee();try{return Ae(e)(t,r,i)}catch(U){if(Ie(v),U!==U+0)throw U;Se(1,0)}}function _i(e,t,r,i,v){var U=Ee();try{return Ae(e)(t,r,i,v)}catch(b){if(Ie(U),b!==b+0)throw b;Se(1,0)}}function Si(e,t){var r=Ee();try{Ae(e)(t)}catch(i){if(Ie(r),i!==i+0)throw i;Se(1,0)}}function Di(e,t,r){var i=Ee();try{return Ae(e)(t,r)}catch(v){if(Ie(i),v!==v+0)throw v;Se(1,0)}}function Ai(e){var t=Ee();try{Ae(e)()}catch(r){if(Ie(t),r!==r+0)throw r;Se(1,0)}}function Ei(e,t,r,i,v){var U=Ee();try{return Ae(e)(t,r,i,v)}catch(b){if(Ie(U),b!==b+0)throw b;Se(1,0)}}function Ii(e,t,r,i,v,U,b,_,I,M,x){var te=Ee();try{Ae(e)(t,r,i,v,U,b,_,I,M,x)}catch(ae){if(Ie(te),ae!==ae+0)throw ae;Se(1,0)}}function wi(e,t,r,i,v,U,b){var _=Ee();try{return Ae(e)(t,r,i,v,U,b)}catch(I){if(Ie(_),I!==I+0)throw I;Se(1,0)}}function Ci(e,t,r,i,v){var U=Ee();try{Ae(e)(t,r,i,v)}catch(b){if(Ie(U),b!==b+0)throw b;Se(1,0)}}function ki(e,t,r,i,v,U){var b=Ee();try{return Ae(e)(t,r,i,v,U)}catch(_){if(Ie(b),_!==_+0)throw _;Se(1,0)}}function Oi(e,t,r,i,v,U,b,_){var I=Ee();try{return Ae(e)(t,r,i,v,U,b,_)}catch(M){if(Ie(I),M!==M+0)throw M;Se(1,0)}}function Ri(e,t,r,i){var v=Ee();try{return Ae(e)(t,r,i)}catch(U){if(Ie(v),U!==U+0)throw U;Se(1,0)}}function Mi(e,t,r,i){var v=Ee();try{return Ae(e)(t,r,i)}catch(U){if(Ie(v),U!==U+0)throw U;Se(1,0)}}function Vi(e){var t=Ee();try{return Ae(e)()}catch(r){if(Ie(t),r!==r+0)throw r;Se(1,0)}}function Pi(e,t,r,i,v,U,b,_){var I=Ee();try{Ae(e)(t,r,i,v,U,b,_)}catch(M){if(Ie(I),M!==M+0)throw M;Se(1,0)}}function $i(e,t,r,i,v,U,b,_,I,M,x,te){var ae=Ee();try{return Ae(e)(t,r,i,v,U,b,_,I,M,x,te)}catch(le){if(Ie(ae),le!==le+0)throw le;Se(1,0)}}function Li(e,t,r,i,v,U,b,_,I,M,x,te,ae,le,De,we){var Ue=Ee();try{Ae(e)(t,r,i,v,U,b,_,I,M,x,te,ae,le,De,we)}catch(Fe){if(Ie(Ue),Fe!==Fe+0)throw Fe;Se(1,0)}}function Fi(e,t,r,i,v){var U=Ee();try{return Ln(e,t,r,i,v)}catch(b){if(Ie(U),b!==b+0)throw b;Se(1,0)}}var Ea;et=function e(){Ea||Fn(),Ea||(et=e)};function Fn(){if(Ne>0||(ue(),Ne>0))return;function e(){Ea||(Ea=!0,n.calledRun=!0,!Y&&(yt(),l(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),gt()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),e()},1)):e()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Fn(),o.ready}})();function Du(a){return pn(yn,a)}async function Au(a,o){return _u(yn,a,o)}async function Eu(a,o){return Su(yn,a,o)}var va;class tr extends EventTarget{constructor(o={}){var n;super(),Xs(this,va,void 0);try{const l=(n=o==null?void 0:o.formats)==null?void 0:n.filter(m=>m!=="unknown");if((l==null?void 0:l.length)===0)throw new TypeError("Hint option provided, but is empty.");l==null||l.forEach(m=>{if(!Ca.has(m))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${m}' is not a valid enum value of type BarcodeFormat.`)}),Zs(this,va,l??[]),Du().then(m=>{this.dispatchEvent(new CustomEvent("load",{detail:m}))}).catch(m=>{this.dispatchEvent(new CustomEvent("error",{detail:m}))})}catch(l){throw Qn(l,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return eu.filter(o=>o!=="unknown")}async detect(o){try{const n=await lu(o);if(n===null)return[];let l;try{Pr(n)?l=await Au(n,{tryHarder:!0,formats:Kn(this,va).map(m=>Ca.get(m))}):l=await Eu(n,{tryHarder:!0,formats:Kn(this,va).map(m=>Ca.get(m))})}catch(m){throw console.error(m),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return l.map(m=>{const{topLeft:{x:p,y},topRight:{x:u,y:d},bottomLeft:{x:f,y:g},bottomRight:{x:D,y:w}}=m.position,P=Math.min(p,u,f,D),R=Math.min(y,d,g,w),Y=Math.max(p,u,f,D),ee=Math.max(y,d,g,w);return{boundingBox:new DOMRectReadOnly(P,R,Y-P,ee-R),rawValue:m.text,format:tu(m.format),cornerPoints:[{x:p,y},{x:u,y:d},{x:D,y:w},{x:f,y:g}]}})}catch(n){throw Qn(n,"Failed to execute 'detect' on 'BarcodeDetector'")}}}va=new WeakMap;const Nr=(a,o,n="error")=>{let l,m;const p=new Promise((y,u)=>{l=y,m=u,a.addEventListener(o,l),a.addEventListener(n,m)});return p.finally(()=>{a.removeEventListener(o,l),a.removeEventListener(n,m)}),p},ar=a=>new Promise(o=>setTimeout(o,a));class xr extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class Iu extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}class wu extends Error{constructor(){super("Loading camera stream timed out after 6 seconds. If you are on iOS in PWA mode, this is a known issue (see https://github.com/gruhn/vue-qrcode-reader/issues/298)"),this.name="StreamLoadTimeoutError"}}let jr;async function Cu(a){if(window.BarcodeDetector===void 0)return console.debug("[vue-qrcode-reader] Native BarcodeDetector not supported. Will use polyfill."),new tr({formats:a});const o=await window.BarcodeDetector.getSupportedFormats(),n=a.filter(l=>!o.includes(l));return n.length>0?(console.debug(`[vue-qrcode-reader] Native BarcodeDetector does not support formats ${JSON.stringify(n)}. Will use polyfill.`),new tr({formats:a})):(console.debug("[vue-qrcode-reader] Will use native BarcodeDetector."),new window.BarcodeDetector({formats:a}))}async function Yr(a){jr=await Cu(a)}const ku=async(a,{detectHandler:o,locateHandler:n,minDelay:l,formats:m})=>{console.debug("[vue-qrcode-reader] start scanning"),await Yr(m);const p=y=>async u=>{if(a.readyState===0)console.debug("[vue-qrcode-reader] stop scanning: video element readyState is 0");else{const{lastScanned:d,contentBefore:f,lastScanHadContent:g}=y;if(u-d<l)window.requestAnimationFrame(p(y));else{const D=await jr.detect(a),w=D.some(Y=>!f.includes(Y.rawValue));w&&o(D);const P=D.length>0;P&&n(D),!P&&g&&n(D);const R={lastScanned:u,lastScanHadContent:P,contentBefore:w?D.map(Y=>Y.rawValue):f};window.requestAnimationFrame(p(R))}}};p({lastScanned:performance.now(),contentBefore:[],lastScanHadContent:!1})(performance.now())};var Br={},ze={};Object.defineProperty(ze,"__esModule",{value:!0});ze.compactObject=Wr;ze.deprecated=Nu;var Ou=ze.detectBrowser=xu;ze.disableLog=$u;ze.disableWarnings=Lu;ze.extractVersion=ka;ze.filterStats=ju;ze.log=Fu;ze.walkStats=Va;ze.wrapPeerConnectionEvent=Pu;function Ru(a,o,n){return o=Mu(o),o in a?Object.defineProperty(a,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[o]=n,a}function Mu(a){var o=Vu(a,"string");return Lt(o)==="symbol"?o:String(o)}function Vu(a,o){if(Lt(a)!=="object"||a===null)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var l=n.call(a,o||"default");if(Lt(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(a)}function Lt(a){"@babel/helpers - typeof";return Lt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Lt(a)}var Hr=!0,Gr=!0;function ka(a,o,n){var l=a.match(o);return l&&l.length>=n&&parseInt(l[n],10)}function Pu(a,o,n){if(a.RTCPeerConnection){var l=a.RTCPeerConnection.prototype,m=l.addEventListener;l.addEventListener=function(y,u){if(y!==o)return m.apply(this,arguments);var d=function(f){var g=n(f);g&&(u.handleEvent?u.handleEvent(g):u(g))};return this._eventMap=this._eventMap||{},this._eventMap[o]||(this._eventMap[o]=new Map),this._eventMap[o].set(u,d),m.apply(this,[y,d])};var p=l.removeEventListener;l.removeEventListener=function(y,u){if(y!==o||!this._eventMap||!this._eventMap[o])return p.apply(this,arguments);if(!this._eventMap[o].has(u))return p.apply(this,arguments);var d=this._eventMap[o].get(u);return this._eventMap[o].delete(u),this._eventMap[o].size===0&&delete this._eventMap[o],Object.keys(this._eventMap).length===0&&delete this._eventMap,p.apply(this,[y,d])},Object.defineProperty(l,"on"+o,{get:function(){return this["_on"+o]},set:function(y){this["_on"+o]&&(this.removeEventListener(o,this["_on"+o]),delete this["_on"+o]),y&&this.addEventListener(o,this["_on"+o]=y)},enumerable:!0,configurable:!0})}}function $u(a){return typeof a!="boolean"?new Error("Argument type: "+Lt(a)+". Please use a boolean."):(Hr=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function Lu(a){return typeof a!="boolean"?new Error("Argument type: "+Lt(a)+". Please use a boolean."):(Gr=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function Fu(){if((typeof window>"u"?"undefined":Lt(window))==="object"){if(Hr)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Nu(a,o){Gr&&console.warn(a+" is deprecated, please use "+o+" instead.")}function xu(a){var o={browser:null,version:null};if(typeof a>"u"||!a.navigator||!a.navigator.userAgent)return o.browser="Not a browser.",o;var n=a.navigator;if(n.mozGetUserMedia)o.browser="firefox",o.version=ka(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)o.browser="chrome",o.version=ka(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(a.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))o.browser="safari",o.version=ka(n.userAgent,/AppleWebKit\/(\d+)\./,1),o.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype;else return o.browser="Not a supported browser.",o;return o}function nr(a){return Object.prototype.toString.call(a)==="[object Object]"}function Wr(a){return nr(a)?Object.keys(a).reduce(function(o,n){var l=nr(a[n]),m=l?Wr(a[n]):a[n],p=l&&!Object.keys(m).length;return m===void 0||p?o:Object.assign(o,Ru({},n,m))},{}):a}function Va(a,o,n){!o||n.has(o.id)||(n.set(o.id,o),Object.keys(o).forEach(function(l){l.endsWith("Id")?Va(a,a.get(o[l]),n):l.endsWith("Ids")&&o[l].forEach(function(m){Va(a,a.get(m),n)})}))}function ju(a,o,n){var l=n?"outbound-rtp":"inbound-rtp",m=new Map;if(o===null)return m;var p=[];return a.forEach(function(y){y.type==="track"&&y.trackIdentifier===o.id&&p.push(y)}),p.forEach(function(y){a.forEach(function(u){u.type===l&&u.trackId===y.id&&Va(a,u,m)})}),m}Object.defineProperty(Br,"__esModule",{value:!0});var Yu=Br.shimGetUserMedia=Gu,Bu=Hu(ze);function qr(a){if(typeof WeakMap!="function")return null;var o=new WeakMap,n=new WeakMap;return(qr=function(l){return l?n:o})(a)}function Hu(a,o){if(a.__esModule)return a;if(a===null||$t(a)!=="object"&&typeof a!="function")return{default:a};var n=qr(o);if(n&&n.has(a))return n.get(a);var l={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in a)if(p!=="default"&&Object.prototype.hasOwnProperty.call(a,p)){var y=m?Object.getOwnPropertyDescriptor(a,p):null;y&&(y.get||y.set)?Object.defineProperty(l,p,y):l[p]=a[p]}return l.default=a,n&&n.set(a,l),l}function $t(a){"@babel/helpers - typeof";return $t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},$t(a)}var rr=Bu.log;function Gu(a,o){var n=a&&a.navigator;if(n.mediaDevices){var l=function(d){if($t(d)!=="object"||d.mandatory||d.optional)return d;var f={};return Object.keys(d).forEach(function(g){if(!(g==="require"||g==="advanced"||g==="mediaSource")){var D=$t(d[g])==="object"?d[g]:{ideal:d[g]};D.exact!==void 0&&typeof D.exact=="number"&&(D.min=D.max=D.exact);var w=function(R,Y){return R?R+Y.charAt(0).toUpperCase()+Y.slice(1):Y==="deviceId"?"sourceId":Y};if(D.ideal!==void 0){f.optional=f.optional||[];var P={};typeof D.ideal=="number"?(P[w("min",g)]=D.ideal,f.optional.push(P),P={},P[w("max",g)]=D.ideal,f.optional.push(P)):(P[w("",g)]=D.ideal,f.optional.push(P))}D.exact!==void 0&&typeof D.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[w("",g)]=D.exact):["min","max"].forEach(function(R){D[R]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[w(R,g)]=D[R])})}}),d.advanced&&(f.optional=(f.optional||[]).concat(d.advanced)),f},m=function(d,f){if(o.version>=61)return f(d);if(d=JSON.parse(JSON.stringify(d)),d&&$t(d.audio)==="object"){var g=function(R,Y,ee){Y in R&&!(ee in R)&&(R[ee]=R[Y],delete R[Y])};d=JSON.parse(JSON.stringify(d)),g(d.audio,"autoGainControl","googAutoGainControl"),g(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=l(d.audio)}if(d&&$t(d.video)==="object"){var D=d.video.facingMode;D=D&&($t(D)==="object"?D:{ideal:D});var w=o.version<66;if(D&&(D.exact==="user"||D.exact==="environment"||D.ideal==="user"||D.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!w)){delete d.video.facingMode;var P;if(D.exact==="environment"||D.ideal==="environment"?P=["back","rear"]:(D.exact==="user"||D.ideal==="user")&&(P=["front"]),P)return n.mediaDevices.enumerateDevices().then(function(R){R=R.filter(function(ee){return ee.kind==="videoinput"});var Y=R.find(function(ee){return P.some(function(q){return ee.label.toLowerCase().includes(q)})});return!Y&&R.length&&P.includes("back")&&(Y=R[R.length-1]),Y&&(d.video.deviceId=D.exact?{exact:Y.deviceId}:{ideal:Y.deviceId}),d.video=l(d.video),rr("chrome: "+JSON.stringify(d)),f(d)})}d.video=l(d.video)}return rr("chrome: "+JSON.stringify(d)),f(d)},p=function(d){return o.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},y=function(d,f,g){m(d,function(D){n.webkitGetUserMedia(D,f,function(w){g&&g(p(w))})})};if(n.getUserMedia=y.bind(n),n.mediaDevices.getUserMedia){var u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(d){return m(d,function(f){return u(f).then(function(g){if(f.audio&&!g.getAudioTracks().length||f.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(function(D){D.stop()}),new DOMException("","NotFoundError");return g},function(g){return Promise.reject(p(g))})})}}}}var zr={};Object.defineProperty(zr,"__esModule",{value:!0});var Wu=zr.shimGetUserMedia=Ju,qu=zu(ze);function Jr(a){if(typeof WeakMap!="function")return null;var o=new WeakMap,n=new WeakMap;return(Jr=function(l){return l?n:o})(a)}function zu(a,o){if(a.__esModule)return a;if(a===null||na(a)!=="object"&&typeof a!="function")return{default:a};var n=Jr(o);if(n&&n.has(a))return n.get(a);var l={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in a)if(p!=="default"&&Object.prototype.hasOwnProperty.call(a,p)){var y=m?Object.getOwnPropertyDescriptor(a,p):null;y&&(y.get||y.set)?Object.defineProperty(l,p,y):l[p]=a[p]}return l.default=a,n&&n.set(a,l),l}function na(a){"@babel/helpers - typeof";return na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},na(a)}function Ju(a,o){var n=a&&a.navigator,l=a&&a.MediaStreamTrack;if(n.getUserMedia=function(d,f,g){qu.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(d).then(f,g)},!(o.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var m=function(d,f,g){f in d&&!(g in d)&&(d[g]=d[f],delete d[f])},p=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(d){return na(d)==="object"&&na(d.audio)==="object"&&(d=JSON.parse(JSON.stringify(d)),m(d.audio,"autoGainControl","mozAutoGainControl"),m(d.audio,"noiseSuppression","mozNoiseSuppression")),p(d)},l&&l.prototype.getSettings){var y=l.prototype.getSettings;l.prototype.getSettings=function(){var d=y.apply(this,arguments);return m(d,"mozAutoGainControl","autoGainControl"),m(d,"mozNoiseSuppression","noiseSuppression"),d}}if(l&&l.prototype.applyConstraints){var u=l.prototype.applyConstraints;l.prototype.applyConstraints=function(d){return this.kind==="audio"&&na(d)==="object"&&(d=JSON.parse(JSON.stringify(d)),m(d,"autoGainControl","mozAutoGainControl"),m(d,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[d])}}}}var pt={};Object.defineProperty(pt,"__esModule",{value:!0});pt.shimAudioContext=od;pt.shimCallbacksAPI=ed;pt.shimConstraints=Xr;pt.shimCreateOfferLegacy=rd;var Ku=pt.shimGetUserMedia=td;pt.shimLocalStreamsAPI=Xu;pt.shimRTCIceServerUrls=ad;pt.shimRemoteStreamsAPI=Zu;pt.shimTrackEventTransceiver=nd;var Kr=Qu(ze);function Qr(a){if(typeof WeakMap!="function")return null;var o=new WeakMap,n=new WeakMap;return(Qr=function(l){return l?n:o})(a)}function Qu(a,o){if(a.__esModule)return a;if(a===null||Ft(a)!=="object"&&typeof a!="function")return{default:a};var n=Qr(o);if(n&&n.has(a))return n.get(a);var l={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in a)if(p!=="default"&&Object.prototype.hasOwnProperty.call(a,p)){var y=m?Object.getOwnPropertyDescriptor(a,p):null;y&&(y.get||y.set)?Object.defineProperty(l,p,y):l[p]=a[p]}return l.default=a,n&&n.set(a,l),l}function Ft(a){"@babel/helpers - typeof";return Ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Ft(a)}function Xu(a){if(!(Ft(a)!=="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){var o=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(n){var l=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(function(m){return o.call(l,m,n)}),n.getVideoTracks().forEach(function(m){return o.call(l,m,n)})},a.RTCPeerConnection.prototype.addTrack=function(n){for(var l=this,m=arguments.length,p=new Array(m>1?m-1:0),y=1;y<m;y++)p[y-1]=arguments[y];return p&&p.forEach(function(u){l._localStreams?l._localStreams.includes(u)||l._localStreams.push(u):l._localStreams=[u]}),o.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(n){var l=this;this._localStreams||(this._localStreams=[]);var m=this._localStreams.indexOf(n);if(m!==-1){this._localStreams.splice(m,1);var p=n.getTracks();this.getSenders().forEach(function(y){p.includes(y.track)&&l.removeTrack(y)})}})}}function Zu(a){if(!(Ft(a)!=="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(n){var l=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=function(m){m.streams.forEach(function(p){if(l._remoteStreams||(l._remoteStreams=[]),!l._remoteStreams.includes(p)){l._remoteStreams.push(p);var y=new Event("addstream");y.stream=p,l.dispatchEvent(y)}})})}});var o=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(function(m){if(n._remoteStreams||(n._remoteStreams=[]),!(n._remoteStreams.indexOf(m)>=0)){n._remoteStreams.push(m);var p=new Event("addstream");p.stream=m,n.dispatchEvent(p)}})}),o.apply(n,arguments)}}}function ed(a){if(!(Ft(a)!=="object"||!a.RTCPeerConnection)){var o=a.RTCPeerConnection.prototype,n=o.createOffer,l=o.createAnswer,m=o.setLocalDescription,p=o.setRemoteDescription,y=o.addIceCandidate;o.createOffer=function(d,f){var g=arguments.length>=2?arguments[2]:arguments[0],D=n.apply(this,[g]);return f?(D.then(d,f),Promise.resolve()):D},o.createAnswer=function(d,f){var g=arguments.length>=2?arguments[2]:arguments[0],D=l.apply(this,[g]);return f?(D.then(d,f),Promise.resolve()):D};var u=function(d,f,g){var D=m.apply(this,[d]);return g?(D.then(f,g),Promise.resolve()):D};o.setLocalDescription=u,u=function(d,f,g){var D=p.apply(this,[d]);return g?(D.then(f,g),Promise.resolve()):D},o.setRemoteDescription=u,u=function(d,f,g){var D=y.apply(this,[d]);return g?(D.then(f,g),Promise.resolve()):D},o.addIceCandidate=u}}function td(a){var o=a&&a.navigator;if(o.mediaDevices&&o.mediaDevices.getUserMedia){var n=o.mediaDevices,l=n.getUserMedia.bind(n);o.mediaDevices.getUserMedia=function(m){return l(Xr(m))}}!o.getUserMedia&&o.mediaDevices&&o.mediaDevices.getUserMedia&&(o.getUserMedia=(function(m,p,y){o.mediaDevices.getUserMedia(m).then(p,y)}).bind(o))}function Xr(a){return a&&a.video!==void 0?Object.assign({},a,{video:Kr.compactObject(a.video)}):a}function ad(a){if(a.RTCPeerConnection){var o=a.RTCPeerConnection;a.RTCPeerConnection=function(n,l){if(n&&n.iceServers){for(var m=[],p=0;p<n.iceServers.length;p++){var y=n.iceServers[p];y.urls===void 0&&y.url?(Kr.deprecated("RTCIceServer.url","RTCIceServer.urls"),y=JSON.parse(JSON.stringify(y)),y.urls=y.url,delete y.url,m.push(y)):m.push(n.iceServers[p])}n.iceServers=m}return new o(n,l)},a.RTCPeerConnection.prototype=o.prototype,"generateCertificate"in o&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return o.generateCertificate}})}}function nd(a){Ft(a)==="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function rd(a){var o=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);var l=this.getTransceivers().find(function(p){return p.receiver.track.kind==="audio"});n.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):n.offerToReceiveAudio===!0&&!l&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);var m=this.getTransceivers().find(function(p){return p.receiver.track.kind==="video"});n.offerToReceiveVideo===!1&&m?m.direction==="sendrecv"?m.setDirection?m.setDirection("sendonly"):m.direction="sendonly":m.direction==="recvonly"&&(m.setDirection?m.setDirection("inactive"):m.direction="inactive"):n.offerToReceiveVideo===!0&&!m&&this.addTransceiver("video",{direction:"recvonly"})}return o.apply(this,arguments)}}function od(a){Ft(a)!=="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}const id=a=>{let o=!1,n;return(...l)=>(o||(n=a(l),o=!0),n)};function ft(a,o){if(a===!1)throw new Error(o??"assertion failure")}function or(a){throw new Error("this code should be unreachable")}const ld=id(()=>{const a=Ou(window);switch(a.browser){case"chrome":Yu(window,a);break;case"firefox":Wu(window,a);break;case"safari":Ku(window,a);break;default:throw new xr}});let ra=Promise.resolve({type:"stop",data:{}});async function ir(a,o,n){var l,m,p;if(console.debug("[vue-qrcode-reader] starting camera with constraints: ",JSON.stringify(o)),window.isSecureContext!==!0)throw new Iu;if(((l=navigator==null?void 0:navigator.mediaDevices)==null?void 0:l.getUserMedia)===void 0)throw new xr;ld(),console.debug("[vue-qrcode-reader] calling getUserMedia");const y=await navigator.mediaDevices.getUserMedia({audio:!1,video:o});a.srcObject!==void 0?a.srcObject=y:a.mozSrcObject!==void 0?a.mozSrcObject=y:window.URL.createObjectURL?a.src=window.URL.createObjectURL(y):window.webkitURL?a.src=window.webkitURL.createObjectURL(y):a.src=y.id,a.play(),console.debug("[vue-qrcode-reader] waiting for video element to load"),await Promise.race([Nr(a,"loadeddata"),ar(6e3).then(()=>{throw new wu})]),console.debug("[vue-qrcode-reader] video element loaded"),await ar(500);const[u]=y.getVideoTracks(),d=(p=(m=u==null?void 0:u.getCapabilities)==null?void 0:m.call(u))!=null?p:{};let f=!1;return n&&d.torch&&(await u.applyConstraints({advanced:[{torch:!0}]}),f=!0),console.debug("[vue-qrcode-reader] camera ready"),{type:"start",data:{videoEl:a,stream:y,capabilities:d,constraints:o,isTorchOn:f}}}async function sd(a,{constraints:o,torch:n,restart:l=!1}){ra=ra.then(p=>{if(p.type==="start"){const{data:{videoEl:y,stream:u,constraints:d,isTorchOn:f}}=p;return!l&&a===y&&o===d&&n===f?p:Zr(y,u,f).then(()=>ir(a,o,n))}else if(p.type==="stop"||p.type==="failed")return ir(a,o,n);or()}).catch(p=>(console.debug(`[vue-qrcode-reader] starting camera failed with "${p}"`),{type:"failed",error:p}));const m=await ra;if(m.type==="stop")throw new Error("Something went wrong with the camera task queue (start task).");if(m.type==="failed")throw m.error;if(m.type==="start")return m.data.capabilities;or()}async function Zr(a,o,n){console.debug("[vue-qrcode-reader] stopping camera"),a.src="",a.srcObject=null,a.load(),await Nr(a,"error");for(const l of o.getTracks())n!=null||await l.applyConstraints({advanced:[{torch:!1}]}),o.removeTrack(l),l.stop();return{type:"stop",data:{}}}async function wa(){if(ra=ra.then(a=>{if(a.type==="stop"||a.type==="failed")return a;const{data:{videoEl:o,stream:n,isTorchOn:l}}=a;return Zr(o,n,l)}),(await ra).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")}const ud=je({__name:"QrcodeStream",props:{constraints:{default:()=>({facingMode:"environment"})},formats:{default:()=>["qr_code"]},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function,default:void 0}},emits:["detect","camera-on","camera-off","error"],setup(a,{emit:o}){const n=a,l=o,m=V(n.constraints),p=V(n.formats);We(()=>n.constraints,(C,H)=>{JSON.stringify(C)!==JSON.stringify(H)&&(m.value=C)},{deep:!0}),We(()=>n.formats,(C,H)=>{JSON.stringify(C)!==JSON.stringify(H)&&(p.value=C)},{deep:!0});const y=V(),u=V(),d=V(),f=V(!1),g=V(!1);dr(()=>{g.value=!0}),Hi(()=>{wa()});const D=ea(()=>({torch:n.torch,constraints:m.value,shouldStream:g.value&&!n.paused}));We(D,async C=>{const H=d.value;ft(H!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus video element should always be defined.");const T=y.value;ft(T!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus canvas should always be defined.");const fe=T.getContext("2d");if(ft(fe!==null,"if cavnas is defined, canvas 2d context should also be non-null"),C.shouldStream){wa(),f.value=!1;try{const _e=await sd(H,C);g.value?(f.value=!0,l("camera-on",_e)):await wa()}catch(_e){l("error",_e)}}else T.width=H.videoWidth,T.height=H.videoHeight,fe.drawImage(H,0,0,H.videoWidth,H.videoHeight),wa(),f.value=!1,l("camera-off")},{deep:!0}),We(p,async C=>{g.value&&await Yr(C)});const w=ea(()=>D.value.shouldStream&&f.value);We(w,C=>{if(C){ft(y.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus pause frame canvas is defined"),P(y.value),ft(u.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus tracking canvas is defined"),P(u.value);const H=()=>n.track===void 0?500:40;ft(d.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus video element is defined"),ku(d.value,{detectHandler:T=>l("detect",T),formats:p.value,locateHandler:R,minDelay:H()})}});const P=C=>{const H=C.getContext("2d");ft(H!==null,"canvas 2d context should always be non-null"),H.clearRect(0,0,C.width,C.height)},R=C=>{const H=u.value;ft(H!==void 0,"onLocate handler should only be called when component is mounted. Thus tracking canvas is always defined.");const T=d.value;if(ft(T!==void 0,"onLocate handler should only be called when component is mounted. Thus video element is always defined."),C.length===0||n.track===void 0)P(H);else{const fe=T.offsetWidth,_e=T.offsetHeight,L=T.videoWidth,E=T.videoHeight,N=Math.max(fe/L,_e/E),ie=L*N,ue=E*N,yt=ie/L,gt=ue/E,rt=(fe-ie)/2,kt=(_e-ue)/2,Ge=({x:Ye,y:Be})=>({x:Math.floor(Ye*yt),y:Math.floor(Be*gt)}),Ne=({x:Ye,y:Be})=>({x:Math.floor(Ye+rt),y:Math.floor(Be+kt)}),et=C.map(Ye=>{const{boundingBox:Be,cornerPoints:Ot}=Ye,{x:Ut,y:Je}=Ne(Ge({x:Be.x,y:Be.y})),{x:Tt,y:Rt}=Ge({x:Be.width,y:Be.height});return{...Ye,cornerPoints:Ot.map(bt=>Ne(Ge(bt))),boundingBox:DOMRectReadOnly.fromRect({x:Ut,y:Je,width:Tt,height:Rt})}});H.width=T.offsetWidth,H.height=T.offsetHeight;const ht=H.getContext("2d");ft(ht!==null,"canvas 2d context should always be non-null"),n.track(et,ht)}},Y={width:"100%",height:"100%",position:"relative","z-index":"0"},ee={width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},q={width:"100%",height:"100%","object-fit":"cover"},G=ea(()=>w.value?q:{...q,visibility:"hidden",position:"absolute"});return(C,H)=>(A(),z("div",{style:Y},[se("video",{ref_key:"videoRef",ref:d,style:Gi(G.value),autoplay:"",muted:"",playsinline:""},null,4),Wi(se("canvas",{id:"qrcode-stream-pause-frame",ref_key:"pauseFrameRef",ref:y,style:q},null,512),[[qi,!w.value]]),se("canvas",{id:"qrcode-stream-tracking-layer",ref_key:"trackingLayerRef",ref:u,style:ee},null,512),se("div",{style:ee},[zi(C.$slots,"default")])]))}}),dd=je({__name:"QRCodeReader",emits:["scan"],setup(a,{emit:o}){const n=o,l=Ji("inputBox"),m=V("keyboard"),p=V({facingMode:"environment"}),y=[{label:"Rear Camera",constraints:{facingMode:"environment"}},{label:"Front Camera",constraints:{facingMode:"user"}}],u=V(y),d=V({aztec:!0,code_128:!0,code_39:!0,code_93:!0,codabar:!0,databar:!0,databar_expanded:!0,data_matrix:!0,dx_film_edge:!0,ean_13:!0,ean_8:!0,itf:!0,maxi_code:!0,micro_qr_code:!0,pdf417:!0,qr_code:!0,rm_qr_code:!0,upc_a:!0,upc_e:!0,linear_codes:!0,matrix_codes:!0}),f=R=>{R.length>=1&&n("scan",R[0].rawValue)},g=async()=>{const Y=(await navigator.mediaDevices.enumerateDevices()).filter(({kind:ee})=>ee==="videoinput");u.value=[...y,...Y.map(({deviceId:ee,label:q})=>({label:`${q}`,constraints:{deviceId:ee}}))]},D=ea(()=>Object.keys(d.value).filter(R=>d.value[R])),w=V(""),P=R=>{R.key==="Enter"?(n("scan",w.value),w.value=""):R.key.length===1&&(w.value+=R.key)};return ur(()=>{window.removeEventListener("keydown",P)}),window.addEventListener("keydown",P),dr(()=>{l.value&&l.value.focus()}),(R,Y)=>m.value==="keyboard"?(A(),z(ce,{key:0},[se("input",{ref_key:"inputBox",ref:l,type:"text",class:"opacity-0 w-0 h-0"},null,512),s(ge,null,{default:c(()=>[s(B,{class:"text-center"},{default:c(()=>[s(fn,{icon:"mdi:mdi-qrcode-scan",size:"150"})]),_:1})]),_:1}),s(ge,null,{default:c(()=>[w.value?(A(),j(B,{key:0,class:"text-center"},{default:c(()=>[re(oe(w.value),1)]),_:1})):(A(),j(B,{key:1,class:"text-center"},{default:c(()=>Y[3]||(Y[3]=[se("small",null,"(Awaiting Input)",-1)])),_:1}))]),_:1}),s(ge,null,{default:c(()=>[s(B,{class:"text-center"},{default:c(()=>[s(pe,{onClick:Y[0]||(Y[0]=ee=>m.value="camera"),color:"primary"},{default:c(()=>Y[4]||(Y[4]=[re(" Use Camera ")])),_:1})]),_:1})]),_:1})],64)):m.value==="camera"?(A(),z(ce,{key:1},[s(ge,null,{default:c(()=>[s(B,{class:"text-center"},{default:c(()=>[s(F(ud),{onDetect:f,onCameraOn:g,constraints:p.value,formats:D.value,style:{"max-width":"400px"}},null,8,["constraints","formats"])]),_:1})]),_:1}),s(ge,null,{default:c(()=>[s(B,null,{default:c(()=>[s(Te,{modelValue:p.value,"onUpdate:modelValue":Y[1]||(Y[1]=ee=>p.value=ee),items:u.value,"item-title":"label","item-value":"constraints",label:"Select Camera","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1}),s(ge,null,{default:c(()=>[s(B,{class:"text-center"},{default:c(()=>[s(pe,{onClick:Y[2]||(Y[2]=ee=>m.value="keyboard"),color:"primary"},{default:c(()=>Y[5]||(Y[5]=[re(" Cancel ")])),_:1})]),_:1})]),_:1})],64)):ne("",!0)}}),cd=["colspan"],bc=je({__name:"RegistrationsView",emits:["pageTitle"],async setup(a,{emit:o}){var me,Ua,Qe;let n,l;const m=hl();o("pageTitle","Registration Manager");const y=Ki(),u=sr(),d=V(!0);let f=((me=y.params.convention)==null?void 0:me.toString())||"";const g=V();g.value=([n,l]=jn(()=>$l()),n=await n,l(),n);const D=Nt(),w=Oa.getInstance(),{getLinkedFields:P}=Sl(),R=V([]),Y=V({ID:0,AdminLayoutUUID:Ct(),ConventionID:((Ua=g.value)==null?void 0:Ua.ID)||0,ConventionUUID:((Qe=g.value)==null?void 0:Qe.ConventionUUID)||Ze,Name:"Registration Table",RunnerLayoutUUID:Ze,Type:dt.ADMIN_LAYOUT_TABLE,Panels:[]}),ee=V([]),q=V([]),G=V([]),C=V([]),H=V([]),T=V([]),fe=V(1),_e=V(10),L=V([]),E=V(0),N=V(!1),ie=V(!1),ue=V(""),yt=V(""),gt=V(""),rt=V(""),kt=V(""),Ge=([n,l]=jn(()=>{var S;return P(((S=g.value)==null?void 0:S.ConventionUUID)||Ze)}),n=await n,l(),n),Ne=V({FieldUUID:Ge.badge_name||Ze,Value:""}),et=V({FieldUUID:Ge.forename||Ze,Value:""}),ht=V({FieldUUID:Ge.surname||Ze,Value:""}),Ye=V({FieldUUID:Ge.dob||Ze,Value:""}),Be=V(new Map([[Ge.badge_name||Ze,Ne.value],[Ge.forename||Ze,et.value],[Ge.surname||Ze,ht.value],[Ge.dob||Ze,Ye.value]])),Ot=V(""),Ut=V(""),Je=V([]),Tt=V([]),Rt=V([]),bt=V([]),Bt=V([]),Ht=V([]),Ke=V(0),Re=V(),tt=V(!1),ya=V(!1),ot=V(!1),Gt=V(),Wt=V(),xt=V(),mt=V(!1),Fa=$a(),at=V(""),Mt=V(!1),be=Hn(()=>{at.value="";const S=T.value.find(h=>h.uuid===ue.value);S&&S.challenge||(yt.value=Date.now().toString())}),Na=Hn(()=>{Mt.value=!1,yt.value=Date.now().toString()});We(ue,S=>{const h=T.value.find(O=>O.uuid===S);if(h){const O=h.headers.find($=>$.defaultSort===!0);O&&(L.value=[{key:O.key,order:"asc"}],Je.value=[{key:O.key,order:"asc"}]),h.challenge&&(h.items=[])}_t({page:1,itemsPerPage:_e.value,sortBy:Je.value})}),We(Ke,S=>{S===8&&qt()}),We(Ot,()=>{be()}),We(Ut,()=>{be()});const xa=()=>{if(ee.value=[],G.value=[],C.value=[],T.value=[],!!g.value){try{D.getConventionAdminLayoutByName(g.value.ConventionUUID,"Registration Table").then(S=>{if(Ke.value+=1,S)Y.value=S;else{if(!g.value)return;Y.value.ConventionID=g.value.ID,Y.value.ConventionUUID=g.value.ConventionUUID}})}catch{Y.value.ConventionID=g.value.ID,Y.value.ConventionUUID=g.value.ConventionUUID}try{D.getConventionAdminLayouts(g.value.ConventionUUID).then(S=>{Ke.value+=1,S&&(S.forEach(h=>{h.Panels.sort((O,$)=>O.Order>$.Order?1:O.Order===$.Order?0:-1),h.Panels.forEach(O=>{O.Items.sort(($,J)=>$.Order>J.Order?1:$.Order===J.Order?0:-1)})}),G.value=S)})}catch{}try{D.getConventionForms(g.value.ConventionUUID).then(S=>{Ke.value+=1,S&&(ee.value=S)})}catch{}try{D.getConventionAccommodation(g.value.ConventionUUID).then(S=>{Ke.value+=1,S&&(Tt.value=S)})}catch{}try{D.getConventionVenues(g.value.ConventionUUID).then(S=>{Ke.value+=1,S&&(Ht.value=S)})}catch{}try{D.getConventionExtras(g.value.ConventionUUID).then(S=>{Ke.value+=1,S&&(Rt.value=S)})}catch{}try{D.getConventionInterests(g.value.ConventionUUID).then(S=>{Ke.value+=1,S&&(bt.value=S)})}catch{}try{D.getConventionTickets(g.value.ConventionUUID).then(S=>{Ke.value+=1,S&&(Bt.value=S)})}catch{}try{D.getConventionGroups(g.value.ConventionUUID).then(S=>{S&&(q.value=S.sort((h,O)=>h.Name.localeCompare(O.Name)))})}catch{}try{D.getConventionTags(g.value.ConventionUUID).then(S=>{S&&(H.value=S.sort((h,O)=>h.Title.localeCompare(O.Title)).map(h=>(h.Title=`${h.Title} [${h.Key}]`,h)))})}catch{}}},_t=({page:S,itemsPerPage:h,sortBy:O})=>{if(!g.value)return;fe.value=S,L.value=O;const $=T.value.find(he=>he.uuid==ue.value),J=$==null?void 0:$.layout.Items;let ye="",At="";if(!($&&$.challenge&&at.value.trim().length<3)){if(d.value=!0,O&&J&&O.length>=1){const he=J.find(Kt=>Kt.LayoutItemUUID==O[0].key);switch(At=O[0].order||"asc",he==null?void 0:he.MetaField){case ve.META_DATA_SOURCE_ACCOMMODATION_FORM:ye="submission.status";break;case ve.META_DATA_SOURCE_ADDITIONAL_FORM:ye="submission.status";break;case ve.META_DATA_SOURCE_ADMIN_FORM:ye="submission.status";break;case ve.META_DATA_SOURCE_BADGE_FORM:ye="submission.status";break;case ve.META_DATA_SOURCE_DEALER_FORM:ye="submission.status";break;case ve.META_DATA_SOURCE_REGISTRATION_FORM:ye="submission.status";break;case ve.META_DATA_SOURCE_REGISTRATION_REFERENCE:ye="reference";break;case ve.META_DATA_SOURCE_SUBMISSION_DATE:ye="created";break;case ve.META_DATA_SOURCE_SUBMISSION_STATUS:ye="submission.status";break}switch(he==null?void 0:he.UserField){case Ve.USER_DATA_SOURCE_DISPLAY_NAME:ye="user.display_name";break;case Ve.USER_DATA_SOURCE_EMAIL:ye="user.email";break;case Ve.USER_DATA_SOURCE_FIRST_NAME:ye="user.firstname";break;case Ve.USER_DATA_SOURCE_HANDLE:ye="user.handle";break;case Ve.USER_DATA_SOURCE_LAST_NAME:ye="user.lastname";break}}try{const he={Direction:At,Limit:h,Offset:(S-1)*h,Order:ye};$&&(he.PanelUUID=$==null?void 0:$.layout.LayoutPanelUUID),($==null?void 0:$.layout.RequiredFormType)===ke.FORM_TYPE_ADDITIONAL&&(he.Additional=!0),($==null?void 0:$.layout.RequiredFormType)===ke.FORM_TYPE_ADMIN&&(he.AdminForm=!0),($==null?void 0:$.layout.RequiredFormType)===ke.FORM_TYPE_ACCOMMODATION&&(he.Accommodation=!0),($==null?void 0:$.layout.RequiredFormType)===ke.FORM_TYPE_BADGE&&(he.Badge=!0),($==null?void 0:$.layout.RequiredFormType)===ke.FORM_TYPE_DEALER&&(he.Dealer=!0),($==null?void 0:$.layout.RequiredFormType)===ke.FORM_TYPE_REGISTRATION&&(he.Registration=!0),he.GroupUUID=Ot.value||Ze,he.TagUUID=Ut.value||Ze,he.Email=kt.value,he.Reference=rt.value,gt.value&&(he.RegistrationUUID=gt.value),he.FieldValues=Array.from(Be.value.values()),gt.value="";const Kt=yt.value;console.log(at.value),D.searchConventionRegistrations(g.value.ConventionUUID,he,at.value).then(Qt=>{Qt&&Kt===yt.value&&(E.value=Qt.Total,C.value=Qt.Registrations,T.value.forEach(ua=>{const Ba=ua.layout;ua.items=C.value.map(Q=>{const Pt=[];let He;Q.Leader?He=Q:He=Q.Primary,Pt.push({Name:He.User.DisplayName,UUID:He.UserUUID,UserUUID:He.User.UserUUID,IsLeader:!0,Reference:He.Reference,Paid:He.Paid,Total:He.Total}),Pt.push(...He.Members.map(lt=>({Name:lt.User.DisplayName,UUID:lt.UserUUID,UserUUID:lt.User.UserUUID,IsLeader:!1,Reference:lt.Reference,Paid:lt.Paid,Total:lt.Total})));const de={};return ua.headers.forEach(lt=>{var Ta;const X=Ba.Items.find(jt=>jt.LayoutItemUUID===lt.key);if(X){if(X.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&X.SectionField)Q.Submissions.forEach(jt=>{const st=jt.Data.find(K=>K.SectionFieldUUID===X.SectionFieldUUID);if(st){lt.type===cr.ACCOMMODATION?de[X.LayoutItemUUID]={Data:st.Data,Registration:Q}:de[X.LayoutItemUUID]=st.Data;return}});else if(X.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&X.UserField)switch(X.UserField){case Ve.USER_DATA_SOURCE_AVATAR:de[X.LayoutItemUUID]=m.GetProfileImageURL(Q.UserUUID);break;case Ve.USER_DATA_SOURCE_CONTACTS:de[X.LayoutItemUUID]={},Q.User.Generated&&Q.User.Generated.telegram_handle&&(de[X.LayoutItemUUID].telegram=`@${Q.User.Generated.telegram_handle}`),de[X.LayoutItemUUID].email=Q.User.Additional.Email;break;case Ve.USER_DATA_SOURCE_DISPLAY_NAME:de[X.LayoutItemUUID]=Q.User.DisplayName;break;case Ve.USER_DATA_SOURCE_EMAIL:de[X.LayoutItemUUID]=Q.User.Additional.Email;break;case Ve.USER_DATA_SOURCE_HANDLE:de[X.LayoutItemUUID]=Q.User.Handle;break;case Ve.USER_DATA_SOURCE_DATE_OF_BIRTH:de[X.LayoutItemUUID]=Q.User.Additional.DOB;break;case Ve.USER_DATA_SOURCE_FIRST_NAME:de[X.LayoutItemUUID]=Q.User.Additional.FirstName;break;case Ve.USER_DATA_SOURCE_LAST_NAME:de[X.LayoutItemUUID]=Q.User.Additional.LastName;break;case Ve.USER_DATA_SOURCE_TELEGRAM:Q.User.Generated&&Q.User.Generated.telegram_handle?de[X.LayoutItemUUID]=`@${Q.User.Generated.telegram_handle}`:de[X.LayoutItemUUID]="";break}else if(X.SourceType==="LAYOUT_ITEM_SOURCE_META"&&X.MetaField){const jt=(Ta=ee.value.find(K=>K.Type===ke.FORM_TYPE_REGISTRATION))==null?void 0:Ta.FormUUID,st=Q.Submissions.find(K=>K.FormUUID===jt);switch(X.MetaField){case ve.META_DATA_SOURCE_REGISTRATION_ACTIONS:de[X.LayoutItemUUID]=Q;break;case ve.META_DATA_SOURCE_REGISTRATION_GROUP:de[X.LayoutItemUUID]=Pt;break;case ve.META_DATA_SOURCE_REGISTRATION_REFERENCE:de[X.LayoutItemUUID]=Q.Reference;break;case ve.META_DATA_SOURCE_SUBMISSION_DATE:if(st){const K=new Date(st.CreatedAt||"");de[X.LayoutItemUUID]=`${K.getFullYear()}-${(K.getMonth()+1).toString().padStart(2,"0")}-${K.getDate().toString().padStart(2,"0")} ${K.getHours().toString().padStart(2,"0")}:${K.getMinutes().toString().padStart(2,"0")}:${K.getSeconds().toString().padStart(2,"0")}`}else{const K=new Date(Q.CreatedAt||"");de[X.LayoutItemUUID]=`${K.getFullYear()}-${(K.getMonth()+1).toString().padStart(2,"0")}-${K.getDate().toString().padStart(2,"0")} ${K.getHours().toString().padStart(2,"0")}:${K.getMinutes().toString().padStart(2,"0")}:${K.getSeconds().toString().padStart(2,"0")}`}break;case ve.META_DATA_SOURCE_ACCOMMODATION_FORM:de[X.LayoutItemUUID]=Q.Submissions.map(K=>{const Z=ee.value.find(Xe=>Xe.FormUUID===K.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:K,Registration:Q}}).filter(K=>{var Z;return((Z=K.Form)==null?void 0:Z.Type)===ke.FORM_TYPE_ACCOMMODATION});break;case ve.META_DATA_SOURCE_ADMIN_FORM:de[X.LayoutItemUUID]=Q.Submissions.map(K=>{const Z=ee.value.find(Xe=>Xe.FormUUID===K.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:K,Registration:Q}}).filter(K=>{var Z;return((Z=K.Form)==null?void 0:Z.Type)===ke.FORM_TYPE_ADMIN});break;case ve.META_DATA_SOURCE_ADDITIONAL_FORM:de[X.LayoutItemUUID]=Q.Submissions.map(K=>{const Z=ee.value.find(Xe=>Xe.FormUUID===K.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:K,Registration:Q}}).filter(K=>{var Z;return((Z=K.Form)==null?void 0:Z.Type)===ke.FORM_TYPE_ADDITIONAL});break;case ve.META_DATA_SOURCE_BADGE_FORM:de[X.LayoutItemUUID]=Q.Submissions.map(K=>{const Z=ee.value.find(Xe=>Xe.FormUUID===K.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:K,Registration:Q}}).filter(K=>{var Z;return((Z=K.Form)==null?void 0:Z.Type)===ke.FORM_TYPE_BADGE});break;case ve.META_DATA_SOURCE_DEALER_FORM:de[X.LayoutItemUUID]=Q.Submissions.map(K=>{const Z=ee.value.find(Xe=>Xe.FormUUID===K.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:K,Registration:Q}}).filter(K=>{var Z;return((Z=K.Form)==null?void 0:Z.Type)===ke.FORM_TYPE_DEALER});break;case ve.META_DATA_SOURCE_PAYMENT_STATUS:if(Q.Paid===0&&Q.Total)de[X.LayoutItemUUID]="REQUIRED";else if(Q.Total>Q.Paid)de[X.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const K=Pt.find(Z=>Z.Paid===0&&(Z.Total||0)>0);if(K){Q.Total===0&&K.Total===0?de[X.LayoutItemUUID]="NOT_REQUIRED":Q.Total>0&&K.Total===0?de[X.LayoutItemUUID]="MISSING_REQUIRED":Q.Paid>=Q.Total?de[X.LayoutItemUUID]="AWAITING_PARTNER":de[X.LayoutItemUUID]="ALL_REQUIRED";break}else Q.Total===0?de[X.LayoutItemUUID]="NOT_REQUIRED":de[X.LayoutItemUUID]="COMPLETE"}break;case ve.META_DATA_SOURCE_SUBMISSION_STATUS:gl(Q.Submissions,ee.value),de[X.LayoutItemUUID]=Q.Submissions.map(K=>{const Z=ee.value.find(Xe=>Xe.FormUUID===K.FormUUID);return{Heading:Z==null?void 0:Z.Heading,Form:Z,Submission:K,Registration:Q}});break;case ve.META_DATA_SOURCE_DATA_LAYOUT:de[X.LayoutItemUUID]={Registration:Q,Layouts:G.value.filter(K=>{if(X.Meta&&X.Meta.LayoutUUID&&Array.isArray(X.Meta.LayoutUUID))return X.Meta.LayoutUUID.includes(K.AdminLayoutUUID)})};break}}}}),{key:Q.RegistrationUUID,registration:Q,...de}})}),d.value=!1)})}catch{}}},la=S=>{N.value=!1,S&&(Y.value=S,qt())},qt=()=>{Ar(Y.value.Panels,ee.value),Y.value.Panels.length>0&&(T.value=[],Y.value.Panels.forEach(S=>{const h={uuid:Ct(),order:S.Order,name:S.Name,headers:[],items:[],layout:S,challenge:S.Meta&&!!S.Meta.challenge};S.Items.sort((O,$)=>O.Order>$.Order?1:O.Order==$.Order?0:-1),h.headers=S.Items.filter(O=>O.SourceType!=wt.LAYOUT_ITEM_SOURCE_META||O.MetaField!=ve.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP).map(O=>{var $,J;return{key:O.LayoutItemUUID,title:O.Label||((J=($=O.SectionField)==null?void 0:$.Field)==null?void 0:J.Label)||"",align:O.Align==="end"?"end":"start",sortable:zt(O),type:Vt(O),defaultSort:O.DefaultSort,meta:O.Meta}}),T.value.push(h)}),T.value=T.value.sort((S,h)=>S.order>h.order?1:S.order==h.order?0:-1)),(ue.value==null||ue.value=="")&&T.value.length>0&&(ue.value=T.value[0].uuid)};f?D.getConvention(f).then(S=>{S&&(g.value=S,Y.value.ConventionID=g.value.ID,Y.value.ConventionUUID=g.value.ConventionUUID,xa())}).catch(()=>{u.push("/")}):u.push("/");const Vt=S=>{var h,O;if(S.SourceType===wt.LAYOUT_ITEM_SOURCE_META)return`${S.SourceType}.${S.MetaField}`;if(S.SourceType===wt.LAYOUT_ITEM_SOURCE_FORM)return(O=(h=S.SectionField)==null?void 0:h.Field)==null?void 0:O.Type;if(S.SourceType===wt.LAYOUT_ITEM_SOURCE_USER)return`${S.SourceType}.${S.UserField}`},St=()=>{const S=T.value.find(h=>h.uuid===ue.value);return S?!!S.layout.Items.find(h=>h.SourceType==wt.LAYOUT_ITEM_SOURCE_META&&h.MetaField==ve.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP):!1},zt=S=>{const h=[ve.META_DATA_SOURCE_ACCOMMODATION_FORM,ve.META_DATA_SOURCE_BADGE_FORM,ve.META_DATA_SOURCE_DEALER_FORM,ve.META_DATA_SOURCE_REGISTRATION_FORM,ve.META_DATA_SOURCE_REGISTRATION_REFERENCE,ve.META_DATA_SOURCE_SUBMISSION_DATE,ve.META_DATA_SOURCE_SUBMISSION_STATUS],O=[Ve.USER_DATA_SOURCE_DISPLAY_NAME,Ve.USER_DATA_SOURCE_EMAIL,Ve.USER_DATA_SOURCE_HANDLE,Ve.USER_DATA_SOURCE_DATE_OF_BIRTH,Ve.USER_DATA_SOURCE_FIRST_NAME,Ve.USER_DATA_SOURCE_LAST_NAME];return h.includes(S.MetaField)||O.includes(S.UserField)},ga=S=>{Re.value=S,tt.value=!0},Jt=S=>{Re.value=S,ya.value=!0},Dt=S=>{Re.value=S,ot.value=!0};We(tt,S=>{S||(Re.value=void 0)}),We(ya,S=>{S||(Re.value=void 0)});const sa=async(S="")=>{Wt.value=await D.getRegistrationGroup(S)},ja=({registration:S,form:h})=>{const O={FormUUID:h.FormUUID,Limit:1,RegistrationUUID:S.RegistrationUUID};switch(h.Type){case ke.FORM_TYPE_ACCOMMODATION:O.Accommodation=!0;break;case ke.FORM_TYPE_ADDITIONAL:O.Additional=!0;break;case ke.FORM_TYPE_ADMIN:O.AdminForm=!0;break;case ke.FORM_TYPE_BADGE:O.Badge=!0;break;case ke.FORM_TYPE_DEALER:O.Dealer=!0;break;case ke.FORM_TYPE_REGISTRATION:O.Registration=!0;break}D.searchConventionRegistrations(S.ConventionUUID,O).then($=>{if($&&$.Total>0){if(Re.value=$.Registrations[0],!Re.value)return;sa(S.RegistrationUUID).then(()=>{var J,ye;Re.value&&((J=Re.value)!=null&&J.Submissions)&&(xt.value=(ye=Re.value)==null?void 0:ye.Submissions.find(At=>At.FormUUID===h.FormUUID)),xt.value||(xt.value=Ya(h,S)),Gt.value=h,mt.value=!0})}})},Ya=(S,h)=>({ID:0,SubmissionUUID:Ct(),FormID:S.ID,FormUUID:S.FormUUID,Form:S,UserID:h.UserID,UserUUID:h.UserUUID,RegistrationID:h.ID,RegistrationUUID:h.RegistrationUUID,Registration:h,Data:[],Status:fl.SUBMISSION_STATUS_NULL}),ha=S=>{D.switchUser(S.UserUUID).then(h=>{h&&El(h.tokens,h.user,u,!1)}).catch(h=>{console.error(h)})},Me=S=>{xl(S)?(it(),gt.value=S,ie.value=!1,be()):isNaN(parseInt(S))||(it(),rt.value=S,ie.value=!1,be())},it=()=>{gt.value="",rt.value="",Ne.value.Value="",kt.value="",et.value.Value="",ht.value.Value="",Ye.value.Value=""};return w.on("registration.group.leave",S=>{D.leaveRegistrationGroup(S).then(h=>{h&&sa(S).then(()=>{w.emit("registration.group.left",h)})})}),w.on("registration.group.remove.member",S=>{D.leaveRegistrationGroup(S).then(h=>{h&&sa(S).then(()=>{w.emit("registration.group.left",h)})})}),w.on("checkin-saved",()=>{it()}),(S,h)=>g.value?(A(),j(Gn,{key:0},{default:c(()=>[s(Wn,{color:"blue-darken-4"},{default:c(()=>[s(yr,{modelValue:ue.value,"onUpdate:modelValue":h[0]||(h[0]=O=>ue.value=O),"show-arrows":""},{default:c(()=>[(A(!0),z(ce,null,xe(T.value,O=>(A(),j(gr,{key:O.uuid,value:O.uuid},{default:c(()=>[re(oe(O.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(fa),s(Js),s(pe,{icon:"mdi:mdi-cog-outline",onClick:h[1]||(h[1]=O=>N.value=!0)})]),_:1}),s(hr,{modelValue:ue.value,"onUpdate:modelValue":h[27]||(h[27]=O=>ue.value=O),disabled:!0,touch:!1},{default:c(()=>[(A(!0),z(ce,null,xe(T.value,O=>(A(),j(Yt,{key:O.uuid,value:O.uuid},{default:c(()=>[O.uuid===ue.value?(A(),j(aa,{key:0,class:"pa-2"},{default:c(()=>[s(Il,{expanded:R.value,"onUpdate:expanded":h[23]||(h[23]=$=>R.value=$),page:fe.value,"onUpdate:page":h[24]||(h[24]=$=>fe.value=$),"items-per-page":_e.value,"onUpdate:itemsPerPage":h[25]||(h[25]=$=>_e.value=$),"sort-by":Je.value,"onUpdate:sortBy":h[26]||(h[26]=$=>Je.value=$),headers:O.headers,"items-length":E.value,items:O.items,"item-value":"key",loading:d.value,search:yt.value,"onUpdate:options":_t,"show-expand":St()},Ma({top:c(()=>[s(Dr,{class:"mb-3"},{default:c(()=>[s(rn,null,{default:c(()=>[s(on,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:c(()=>{var $;return[s(B,{class:"py-0 pl-0 pr-2 text-left flex-shrink-1 text-no-wrap"},{default:c(()=>[h[39]||(h[39]=re(" Search Criteria ")),s(fn,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),s(B,{class:"d-none d-sm-block py-0 px-2",cols:"6",sm:"7",md:"2"},{default:c(()=>[s(Pe,{modelValue:rt.value,"onUpdate:modelValue":h[2]||(h[2]=J=>rt.value=J),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:h[3]||(h[3]=vt(()=>{},["stop"])),"onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{class:"d-none d-md-block py-0 px-2",md:"4"},{default:c(()=>[s(Pe,{modelValue:Ne.value.Value,"onUpdate:modelValue":h[4]||(h[4]=J=>Ne.value.Value=J),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:h[5]||(h[5]=vt(()=>{},["stop"])),"onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{class:"d-none d-md-block py-0 px-2",md:"2"},{default:c(()=>[s(Pe,{modelValue:Ye.value.Value,"onUpdate:modelValue":h[6]||(h[6]=J=>Ye.value.Value=J),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"plain","onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(fa),s(pe,{icon:"mdi:mdi-eraser",variant:"text",title:"Clear Primary Search Values",onClick:h[7]||(h[7]=vt(J=>{it(),F(be)()},["stop"]))}),s(pe,{icon:"mdi:mdi-qrcode-scan",variant:"text",title:"Scan Code",onClick:h[8]||(h[8]=vt(J=>ie.value=!0,["stop"]))}),($=T.value.find(J=>J.uuid===ue.value))!=null&&$.challenge?(A(),j(pe,{key:0,icon:"mdi:mdi-magnify",variant:"text",title:"Search",onClick:h[9]||(h[9]=vt(J=>{at.value="",Mt.value=!0},["stop"]))})):ne("",!0)]}),_:1}),s(ln,{class:"pt-2"},{default:c(()=>{var $;return[s(ge,null,{default:c(()=>[s(B,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:c(()=>[s(Pe,{modelValue:rt.value,"onUpdate:modelValue":h[10]||(h[10]=J=>rt.value=J),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:c(()=>[s(Pe,{modelValue:Ne.value.Value,"onUpdate:modelValue":h[11]||(h[11]=J=>Ne.value.Value=J),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:c(()=>[s(Pe,{modelValue:kt.value,"onUpdate:modelValue":h[12]||(h[12]=J=>kt.value=J),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:c(()=>[s(Pe,{modelValue:et.value.Value,"onUpdate:modelValue":h[13]||(h[13]=J=>et.value.Value=J),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:c(()=>[s(Pe,{modelValue:ht.value.Value,"onUpdate:modelValue":h[14]||(h[14]=J=>ht.value.Value=J),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:c(()=>[s(Pe,{modelValue:Ye.value.Value,"onUpdate:modelValue":h[15]||(h[15]=J=>Ye.value.Value=J),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":F(be),onInput:F(be)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),s(B,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:c(()=>[s(Te,{modelValue:Ot.value,"onUpdate:modelValue":h[16]||(h[16]=J=>Ot.value=J),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:q.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),s(B,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:c(()=>[s(Te,{modelValue:Ut.value,"onUpdate:modelValue":h[17]||(h[17]=J=>Ut.value=J),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:H.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1}),($=T.value.find(J=>J.uuid===ue.value))!=null&&$.challenge?(A(),j(ge,{key:0},{default:c(()=>[s(B,{class:"text-right"},{default:c(()=>[s(pe,{"prepend-icon":"mdi:mdi-magnify",title:"Search",color:"success",onClick:h[18]||(h[18]=vt(J=>{at.value="",Mt.value=!0},["stop"]))},{default:c(()=>h[40]||(h[40]=[re(" Run Search ")])),_:1})]),_:1})]),_:1})):ne("",!0)]}),_:1})]),_:1})]),_:1})]),"expanded-row":c(({columns:$,internalItem:J})=>[se("tr",null,[se("td",{colspan:$.length},[s(Jn,{modelValue:tt.value,"onUpdate:modelValue":h[20]||(h[20]=ye=>tt.value=ye),registration:J.raw.registration,"onUpdate:registration":ye=>J.raw.registration=ye,accommodations:Tt.value,convention:g.value,extras:Rt.value,forms:ee.value,interests:bt.value,tickets:Bt.value,title:`Registration Controls (#${J.raw.registration.Reference} ${J.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:Ht.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,cd)])]),"item.data-table-expand":c(({internalItem:$})=>[R.value.findIndex(J=>J===$.key)>=0?(A(),j(pe,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:J=>R.value.splice(R.value.findIndex(ye=>ye===$.key),1)},{default:c(()=>[$.raw.registration.Notes&&$.raw.registration.Notes.length>0?(A(),z(ce,{key:0},[re(oe($.raw.registration.Notes.length),1)],64)):ne("",!0)]),_:2},1032,["onClick"])):(A(),j(pe,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:J=>R.value.push($.key)},{default:c(()=>[$.raw.registration.Notes&&$.raw.registration.Notes.length>0?(A(),z(ce,{key:0},[re(oe($.raw.registration.Notes.length),1)],64)):ne("",!0)]),_:2},1032,["onClick"]))]),bottom:c(()=>[s(Qs,{"current-page":fe.value,"onUpdate:currentPage":h[21]||(h[21]=$=>fe.value=$),"items-per-page":_e.value,"onUpdate:itemsPerPage":h[22]||(h[22]=$=>_e.value=$),"item-total":E.value},null,8,["current-page","items-per-page","item-total"])]),_:2},[xe(O.headers,$=>({name:`item.${$.key}`,fn:c(({internalItem:J,index:ye})=>[s(ts,{header:$,item:J,accommodations:Tt.value,convention:g.value,extras:Rt.value,forms:ee.value,interests:bt.value,tickets:Bt.value,user:F(Fa),venues:Ht.value,modelValue:O.items[ye],"onUpdate:modelValue":At=>O.items[ye]=At,onOpenActions:ga,onOpenPayments:Jt,onOpenTags:Dt,onReload:h[19]||(h[19]=At=>_t({page:fe.value,itemsPerPage:_e.value,sortBy:L.value})),onSwitchUser:ha,onShowForm:ja},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search","show-expand"])]),_:2},1024)):ne("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),ie.value?(A(),j(Pa,{key:0,modelValue:ie.value,"onUpdate:modelValue":h[28]||(h[28]=O=>ie.value=O),title:"Scan Code",width:"auto","card-class":"px-2 px-sm-6"},{default:c(()=>[s(dd,{onScan:Me})]),_:1},8,["modelValue"])):ne("",!0),N.value?(A(),j(qs,{key:1,title:"Edit Layouts",modelValue:N.value,"onUpdate:modelValue":h[29]||(h[29]=O=>N.value=O),convention:g.value,onSave:la},null,8,["modelValue","convention"])):ne("",!0),Re.value?(A(),z(ce,{key:2},[tt.value?(A(),j(Jn,{key:0,modelValue:tt.value,"onUpdate:modelValue":h[30]||(h[30]=O=>tt.value=O),registration:Re.value,"onUpdate:registration":h[31]||(h[31]=O=>Re.value=O),accommodations:Tt.value,convention:g.value,extras:Rt.value,forms:ee.value,interests:bt.value,tickets:Bt.value,title:`Registration Controls (#${Re.value.Reference} ${Re.value.User.DisplayName})`,"use-dialog":!0,venues:Ht.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):ne("",!0)],64)):ne("",!0),mt.value&&xt.value&&Gt.value?(A(),j(sn,{key:3,modelValue:mt.value,"onUpdate:modelValue":h[35]||(h[35]=O=>mt.value=O),scrollable:!0,fullscreen:!0},{default:c(()=>[s(aa,{class:"bg-red-darken-4"},{default:c(()=>[s(Wn,{color:"error"},{default:c(()=>[s(Ll,null,{default:c(()=>h[41]||(h[41]=[re("Submission Editor - Admin Mode")])),_:1}),s(fa),s(yl,null,{default:c(()=>[s(pe,{icon:"mdi:mdi-window-close",onClick:h[32]||(h[32]=O=>mt.value=!1)})]),_:1})]),_:1}),s(ta,{class:"pa-0"},{default:c(()=>[s(dl,{modelValue:Gt.value,"onUpdate:modelValue":h[33]||(h[33]=O=>Gt.value=O),admin:!0,convention:g.value,data:xt.value,editable:!0,"registration-group":Wt.value,onClose:h[34]||(h[34]=O=>{mt.value=!1,_t({page:fe.value,itemsPerPage:_e.value,sortBy:L.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):ne("",!0),s(sn,{modelValue:Mt.value,"onUpdate:modelValue":h[38]||(h[38]=O=>Mt.value=O)},{default:c(()=>[s(aa,{class:"rounded-xl"},{default:c(()=>[s(La,null,{default:c(()=>[s(ta,{class:"px-0"},{default:c(()=>h[42]||(h[42]=[se("h2",null,"Search Challenge",-1)])),_:1}),s(bl,null,{default:c(()=>h[43]||(h[43]=[re("Please provide the reason for this search. If it relates to an open case, enter the relevant identifiers.")])),_:1})]),_:1}),s(ta,{color:"white"},{default:c(()=>[s(Fl,{modelValue:at.value,"onUpdate:modelValue":h[36]||(h[36]=O=>at.value=O),label:"Reason"},null,8,["modelValue"])]),_:1}),s(br,null,{default:c(()=>[s(pe,{onClick:h[37]||(h[37]=O=>{at.value="",Mt.value=!1})},{default:c(()=>h[44]||(h[44]=[re("Cancel")])),_:1}),s(fa),s(pe,{onClick:F(Na),disabled:at.value.length<3},{default:c(()=>h[45]||(h[45]=[re("Search")])),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):(A(),j(Gn,{key:1},{default:c(()=>h[46]||(h[46]=[re(" Convention Not Found ")])),_:1}))}});export{bc as default};
