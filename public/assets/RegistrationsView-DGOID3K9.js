import{i as he,M as Ue,N as be,r as S,n as d,D as N,q as C,v as o,H as ee,Q as xe,f as l,x as Q,y as j,A as z,E as ut,P as Fe,G as Z,F as M,a2 as Ta,m as Kt,k as dt,w as Ve,Z as nt,c as wt,O as mt,a3 as Ia,a4 as ba,g as Aa,a5 as Da,T as Sa,R as Qt,a6 as Ea,b as ka,z as et,C as Ft,V as Ae,U as Va}from"./index-Dc0PJCAV.js";import{_ as Ra,D as Ma,a as Oa,b as Ca,c as La,d as wa,e as Fa,f as Na,g as Pa,h as $a,L as At,M as Dt,U as St,i as Ce,A as ke,u as gt,j as Ba,P as Ya,k as Nt,l as W,m as Ga,n as fe}from"./runner-CEm2fSX3.js";import{a as Jt,b as qa}from"./FormRenderer.vue_vue_type_style_index_0_lang-B3LhnWmZ.js";import{F as de,a as Ha}from"./form-Cqw16b_M.js";import{b as ja,c as Xt,d as Pt,S as za}from"./submission-DAi9v6uc.js";import{C as Ka}from"./canManageGlobalUsers-P9b4HQC5.js";import{_ as Et}from"./ModelDialog.vue_vue_type_script_setup_true_lang-BjyZHRqF.js";import{a as tt,c as Wt,V as kt,b as Qa}from"./VList-BYhZqXWf.js";import{V as se,d as Zt,e as Ee}from"./VContainer-skhVHdC9.js";import{V as ea,b as Ja}from"./forwardRefs-BVi-1r4K.js";import{s as Xa}from"./sortSubmissions-BLiX_qgz.js";import{u as Wa}from"./useStoreAPI-E23S3FdK.js";import{u as ta}from"./useModel-CUrDqfXa.js";import{a as aa,V as la,d as Ye,e as na}from"./VTabs-BUr_uzK7.js";import{u as Za,P as el}from"./useDisplayTransactions-X_jlQbmc.js";import{C as oa,G as ia}from"./canDo-CHtQwS4q.js";import{G as ct}from"./userData-BgiVn9qc.js";import{a as Vt,V as Rt,c as ft,e as ot,d as tl}from"./VCard-BtDrxj2w.js";import{V as ce,a as w}from"./VRow-C98q8wHR.js";import{_ as sa}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as xt,a as al}from"./SaveButton.vue_vue_type_script_setup_true_lang-DrMbS0ZZ.js";import{V as ie}from"./VSelect-CU6M64tH.js";import{_ as ra,a as ht,u as ll}from"./useLinkedFields-C7HDxmEs.js";import{V as nl,a as ol}from"./VAlert-zUhIVp0h.js";import{V as lt}from"./VCheckbox-wdOzeniY.js";import{S as il}from"./setupLogin-BTbIs6Kl.js";import{V as sl,u as rl}from"./debounce-DttBwH-7.js";import{b as ul}from"./sorted-PYsDa1V2.js";import{_ as dl}from"./SelectGroups.vue_vue_type_script_setup_true_lang-1QiHg67m.js";import{_ as ml}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-BOoo8wIi.js";import{v as Le}from"./v4-CtRu48qb.js";import{u as cl}from"./useAdvancedMode-CqFI7pzN.js";import{V as ve}from"./VTextField-Di7Mdt7F.js";import{V as ua,a as yt,b as Tt,c as It}from"./VExpansionPanels-B2ahDP8v.js";import{V as da}from"./VDialog-DOdgwJ6n.js";import{c as fl}from"./copyToClipboard-BtcEYe2-.js";import{u as vl}from"./useAvatar-fIU0Z322.js";import{V as bt}from"./scopeId-Ckyk7eJQ.js";import{a as Ul}from"./VDataTable-Bx_awmjX.js";import{u as pl}from"./useConventionSlug-B9L93VLl.js";import{V as $t}from"./VSheet-C3c6kEBb.js";import{V as Bt,a as _l}from"./VToolbar-C2vm6IUD.js";import"./date-DgbCHIwC.js";import"./canEditRegistrations-BeWiD20f.js";import"./ticket-DqurB3v3.js";import"./Editor-DRpoxbyV.js";import"./VAutocomplete-C9_Ry2n-.js";import"./filter-xF2oHn7Z.js";import"./form-C_nqeyZf.js";import"./VCheckboxBtn-Ctu7zwS7.js";import"./VChip-Dc7cTl6U.js";import"./VDivider-CvNf32pw.js";import"./VTextarea-DBquUOkB.js";import"./VForm-C9uyw5HV.js";import"./VNavigationDrawer-CWuzL298.js";import"./layout-CfMkfkvA.js";import"./index-fwfMqYug.js";import"./VTooltip-D48oXaNw.js";import"./VOverlay-CbITe18g.js";import"./VFileInput-ChiPOWQI.js";import"./createSimpleFunctional-Dn1He-s9.js";import"./VToolbarItems-B-9JYyvi.js";import"./VTable-oN73Rg5Z.js";const gl=()=>({ID:0,UserUUID:"",DisplayName:"",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]}),xl=he({__name:"DataTableItemPanel",props:Ue({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Ue(["openActions","showForm"],["update:modelValue"]),setup(V,{emit:O}){const p=ut.getInstance(),f=O,A=be(V,"modelValue"),b=S(),y=Fe(),i=S(),U=S(!1),u=L=>{const $={AdminLayoutUUID:L.AdminLayoutUUID,Limit:1,RegistrationUUID:A.value.RegistrationUUID};y.searchConventionRegistrations(A.value.ConventionUUID,$).then(q=>{q&&q.Total>0&&(b.value=q.Registrations[0],i.value=L,U.value=!0)})},_=L=>{f("openActions",L)},k=(L,$,q)=>{f("showForm",L,$,q)};return p.on("checkin-saved",()=>{U.value=!1}),(L,$)=>(d(),N("div",null,[L.layouts?(d(),C(kt,{key:0},{default:o(()=>[(d(!0),N(ee,null,xe(L.layouts,q=>(d(),C(tt,{key:q.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:o(()=>[l(Wt,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:o(()=>[l(se,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:te=>u(q)},{default:o(()=>[Q(j(q.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):z("",!0),U.value&&i.value&&b.value?(d(),C(Et,{key:1,modelValue:U.value,"onUpdate:modelValue":$[2]||($[2]=q=>U.value=q),"hide-extension":!0,fullscreen:!0,title:`#${b.value.Reference} ${b.value.User.DisplayName} - ${i.value.Name} `,scrollable:!0,"card-class":"pa-0"},{default:o(()=>[l(Ra,{accommodations:L.accommodations,convention:L.convention,extras:L.extras,forms:L.forms,interests:L.interests,tickets:L.tickets,venues:L.venues,layout:i.value,"onUpdate:layout":$[0]||($[0]=q=>i.value=q),modelValue:b.value,"onUpdate:modelValue":$[1]||($[1]=q=>b.value=q),onOpenActions:_,onShowForm:k},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):z("",!0)]))}}),hl={class:"text-grey-lighten-1"},yl={key:0,class:"mb-2"},Tl={key:1,class:"mb-2"},Il={key:0,class:"text-blue text-center"},bl={key:1,class:"text-red text-center"},Al={key:2,class:"text-orange text-center"},Dl={key:3,class:"text-orange text-center"},Sl={key:4,class:"text-orange text-center"},El={key:5,class:"text-orange text-center"},kl={key:6,class:"text-green text-center"},Vl={key:0},Rl={key:0},Ml=he({__name:"RegListRow",props:Ue({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Ue(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(V,{emit:O}){const p=O,f=be(V,"modelValue"),A=(i,U)=>{p("showForm",{registration:i,form:U})},b=i=>{p("openActions",i)},y=i=>{p("switchUser",i)};return(i,U)=>i.header.type==="ACCOMMODATION"&&i.accommodations.length>0&&i.item.raw[i.header.key]?(d(),C(Ma,{key:0,value:i.item.raw[i.header.key].Data,accommodations:i.accommodations,convention:i.convention,forms:i.forms,tickets:i.tickets,venues:i.venues,registration:i.item.raw[i.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):i.header.type==="EXTRAS"&&i.extras.length>0?(d(),C(Oa,{key:1,value:i.item.raw[i.header.key],extras:i.extras},null,8,["value","extras"])):i.header.type==="INTERESTS"&&i.interests.length>0?(d(),C(Ca,{key:2,value:i.item.raw[i.header.key],interests:i.interests},null,8,["value","interests"])):i.header.type==="TICKET"&&i.tickets.length>0?(d(),C(La,{key:3,value:i.item.raw[i.header.key],tickets:i.tickets},null,8,["value","tickets"])):i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(d(),C(wa,{key:4,convention:i.convention,"show-controls":!1,modelValue:i.item.raw.registration,"onUpdate:modelValue":U[0]||(U[0]=u=>i.item.raw.registration=u)},null,8,["convention","modelValue"])):i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADDITIONAL_FORM"||i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(d(),N(ee,{key:5},[Z("ul",null,[(d(!0),N(ee,null,xe(i.forms.filter(u=>u.Type===M(de).FORM_TYPE_ADMIN&&i.item.raw[i.header.key].findIndex(_=>_.Form.ID===u.ID)<0),u=>(d(),N("li",{key:u.Heading},[Z("strong",hl,j(u.Heading),1),l(se,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:_=>A(i.item.raw.registration,u)},null,8,["onClick"])]))),128))]),Z("ul",null,[(d(!0),N(ee,null,xe(i.item.raw[i.header.key],u=>(d(),N("li",{key:u.Heading},[Z("strong",null,[Q(j(u.Heading),1),u.Form.Type!==M(de).FORM_TYPE_ADMIN?(d(),N(ee,{key:0},[Q(": ")],64)):z("",!0)]),u.Form.Type!==M(de).FORM_TYPE_ADMIN?(d(),N("span",{key:0,class:Ta(M(ja)(u.Submission.Status))},j(M(Xt)(u.Submission.Status)),3)):z("",!0),l(se,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:_=>A(u.Registration,u.Form)},null,8,["onClick"])]))),128))])],64)):i.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(d(),C(ea,{key:6,class:"rounded-circle",src:i.item.raw[i.header.key],height:"32",width:"32"},null,8,["src"])):i.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_CONTACTS"?(d(),N(ee,{key:7},[i.item.raw[i.header.key].email?(d(),N("p",yl,[U[4]||(U[4]=Z("strong",null,"Email",-1)),U[5]||(U[5]=Z("br",null,null,-1)),Q(j(i.item.raw[i.header.key].email),1)])):z("",!0),i.item.raw[i.header.key].telegram?(d(),N("p",Tl,[U[6]||(U[6]=Z("strong",null,"Telegram",-1)),U[7]||(U[7]=Z("br",null,null,-1)),Q(j(i.item.raw[i.header.key].telegram),1)])):z("",!0)],64)):i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(d(),N(ee,{key:8},[i.item.raw[i.header.key]=="NOT_REQUIRED"?(d(),N("div",Il,"No Payment Requested")):i.item.raw[i.header.key]=="MISSING_REQUIRED"?(d(),N("div",bl,"Partner Payment Not Requested")):i.item.raw[i.header.key]=="AWAITING_PARTNER"?(d(),N("div",Al,"Awaiting Partner Payment")):i.item.raw[i.header.key]=="ALL_REQUIRED"?(d(),N("div",Dl,"Awaiting Payments")):i.item.raw[i.header.key]=="REQUIRED"?(d(),N("div",Sl,"Awaiting Payment")):i.item.raw[i.header.key]=="ADDITIONAL_REQUIRED"?(d(),N("div",El,"Awaiting Additional Payments")):(d(),N("div",kl,"Completed"))],64)):i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(d(),N(ee,{key:9},[l(se,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:U[1]||(U[1]=u=>b(i.item.raw[i.header.key]))}),M(Ka)(i.user)?(d(),C(se,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:U[2]||(U[2]=u=>y(i.item.raw[i.header.key]))})):z("",!0)],64)):i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(d(),N(ee,{key:10},[i.item.raw[i.header.key].length===1?(d(),N("em",Vl," Not in a group ")):(d(),N(ee,{key:1},[Z("ul",null,[(d(!0),N(ee,null,xe(i.item.raw[i.header.key],u=>(d(),N("li",{key:u.UUID,class:"ml-0"},[Q(" #"+j(u.Reference)+" : "+j(u.Name)+" ",1),u.IsLeader?(d(),N("strong",Rl,"(Leader)")):z("",!0)]))),128))]),U[8]||(U[8]=Z("strong",null,"Total:",-1)),Q(" "+j(i.item.raw[i.header.key].length),1)],64))],64)):i.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(d(),N(ee,{key:11},[f.value.registration?(d(),C(xl,{key:0,accommodations:i.accommodations,convention:i.convention,extras:i.extras,forms:i.forms,interests:i.interests,tickets:i.tickets,venues:i.venues,layouts:i.item.raw[i.header.key].Layouts,modelValue:f.value.registration,"onUpdate:modelValue":U[3]||(U[3]=u=>f.value.registration=u),onOpenActions:b,onShowForm:A},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):z("",!0)],64)):(d(),N(ee,{key:12},[Q(j(i.item.raw[i.header.key]),1)],64))}}),Yt=he({__name:"RegistrationActionTabs",props:Ue({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const O=V,p=be(V,"modelValue");return(f,A)=>(d(),C(aa,Kt({modelValue:p.value,"onUpdate:modelValue":A[0]||(A[0]=b=>p.value=b)},O),{default:o(()=>[(d(!0),N(ee,null,xe(f.tabs,b=>(d(),C(la,{value:b.value,key:b.value},{default:o(()=>[Q(j(b.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),Ol=(V=void 0,O)=>V===void 0?!1:oa(V,ia.GROUP_TYPE_CONVENTION,O.ConventionUUID,O).EditPaymentTransactions,Cl={class:"mb-4"},Ll={class:"v-row"},wl={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},Fl={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},Nl={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},Pl={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},$l={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Bl={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Yl={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Gl={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},ql=he({__name:"PaymentActions",props:Ue({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const O=S(!1),p=S(),f=S([]),A=S(new Date().getTime()),b=S(!1),y=be(V,"modelValue"),i=S(dt(y.value));Ve(y,()=>{i.value=dt(y.value)});const U=Fe();U.getConvention(y.value.ConventionUUID).then(L=>{L&&(b.value=Ol(ct(),L))});const u=()=>{U.generateRegistrationCharges(y.value.RegistrationUUID,!1).then(L=>{L&&(f.value=L.PaymentTransactions,p.value=L.Registration,A.value=new Date().getTime())}).catch(()=>{})};u();const _=()=>{U.generateRegistrationCharges(y.value.RegistrationUUID,!0).then(L=>{L&&(f.value=L.PaymentTransactions,p.value=L.Registration,A.value=new Date().getTime())})},{totalCharges:k}=Za();return(L,$)=>(d(),C(ot,null,{default:o(()=>[l(Rt,null,{default:o(()=>[l(Vt,null,{default:o(()=>[Q(" Payments (#"+j(y.value.Reference)+" "+j(y.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),l(ft,null,{default:o(()=>[p.value?(d(),N(ee,{key:0},[Z("h3",Cl,"#"+j(p.value.Reference)+" "+j(p.value.User.DisplayName),1),Z("dl",Ll,[(d(!0),N(ee,null,xe(f.value,q=>(d(),N(ee,{key:q.PaymentTransactionUUID},[q.Type===M(el).PAYMENT_TRANSACTION_TYPE_CHARGE?(d(),N("dt",wl,[Z("div",Fl,j(q.Description.split(":")[0])+": ",1),Z("div",Nl,j(q.Description.split(":")[1]),1)])):z("",!0),Z("dd",Pl," £"+j(q.Amount),1)],64))),128)),$[2]||($[2]=Z("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),Z("dd",$l," £"+j(M(k)(f.value)),1),$[3]||($[3]=Z("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Z("dd",Bl," £"+j(p.value.Total),1),$[4]||($[4]=Z("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Z("dd",Yl," £"+j(p.value.Paid),1),$[5]||($[5]=Z("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),Z("dd",Gl," £"+j(p.value.Total-p.value.Paid),1)]),l(ce,{class:"flex-row-reverse"},{default:o(()=>[l(w,{class:"text-right"},{default:o(()=>[l(se,{color:"primary",onClick:_},{default:o(()=>$[6]||($[6]=[Q("Apply Charges")])),_:1})]),_:1}),!O.value&&b.value?(d(),C(w,{key:0},{default:o(()=>[l(se,{color:"secondary",onClick:$[0]||($[0]=q=>O.value=!0)},{default:o(()=>$[7]||($[7]=[Q("Transaction Entry")])),_:1})]),_:1})):z("",!0)]),_:1})],64)):z("",!0),l(Fa,{"can-edit":b.value,registration:y.value,"show-editor":O.value,onCloseEditor:$[1]||($[1]=q=>O.value=!1),updated:A.value,onChange:u},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),Hl=sa(ql,[["__scopeId","data-v-861debd5"]]),jl=he({__name:"RegistrationFormStatus",props:Ue({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const O=Fe(),p=be(V,"modelValue"),f=(A,b)=>{const y=p.value.Submissions.find(i=>i.SubmissionUUID==b);if(!y){A&&A("Submission not found");return}O.setSubmissionStatus(b,y.Status).then(i=>{i?(p.value.Submissions.forEach((U,u)=>{p.value.Submissions[u].Status=U.Status}),A&&A("Status Saved")):A&&A("Status not saved")}).catch(()=>{A&&A("Status not saved")})};return(A,b)=>(d(),C(ot,null,{default:o(()=>[l(Rt,null,{default:o(()=>[l(Vt,null,{default:o(()=>[Q("Status (#"+j(p.value.Reference)+" "+j(p.value.User.DisplayName)+")",1)]),_:1})]),_:1}),l(ft,null,{default:o(()=>[l(kt,null,{default:o(()=>[(d(!0),N(ee,null,xe(p.value.Submissions,y=>(d(),C(tt,{key:y.SubmissionUUID,class:"pa-0"},{default:o(()=>[l(ce,{class:"py-2 align-center"},{default:o(()=>[l(w,{cols:"9",sm:"10",md:"10",lg:"9"},{default:o(()=>{var i;return[l(ie,{modelValue:y.Status,"onUpdate:modelValue":U=>y.Status=U,items:M(Pt),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((i=A.forms.find(U=>U.FormUUID==y.FormUUID))==null?void 0:i.Name)||""},{selection:o(()=>[l(Zt,{class:"mr-4 d-none d-sm-inline"},{default:o(()=>{var U;return[Q(j((U=M(Pt).find(u=>u.value===y.Status))==null?void 0:U.icon),1)]}),_:2},1024),Q(" "+j(M(Xt)(y.Status)),1)]),item:o(({item:U,props:{onClick:u}})=>[l(tt,{title:U.title,"prepend-icon":U.raw.icon,onClick:u},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),l(w,{cols:"3",sm:"2",md:"2",lg:"1"},{default:o(()=>[l(xt,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:i=>f(i.callback,y.SubmissionUUID)},null,8,["onClick"]),l(xt,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:i=>f(i.callback,y.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),zl={class:"mb-4"},Kl=he({__name:"RegistrationTags",props:Ue({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const O=Fe(),p=be(V,"modelValue"),f=S(dt(p.value)),A=S(!1),b=S(f.value.Tags);Ve(p,()=>{f.value=dt(p.value)});const y=({callback:i})=>{const U=[],u=[];f.value.Tags.forEach(_=>{b.value.find(L=>L.TagUUID===_.TagUUID)||U.push(_.TagUUID)}),b.value.forEach(_=>{f.value.Tags.find(L=>_.TagUUID===L.TagUUID)||u.push(_.TagUUID)}),O.updateRegistrationTags(U,u,f.value.RegistrationUUID).then(_=>{_?i&&(i("Tags Saved"),p.value.Tags=_.Tags):i&&i("Error Saving Tags")}).catch(()=>{i&&i("Error Saving Tags")})};return(i,U)=>(d(),C(ot,null,{default:o(()=>[l(Rt,null,{default:o(()=>[l(Vt,null,{default:o(()=>[Q("Tags (#"+j(f.value.Reference)+" "+j(f.value.User.DisplayName)+")",1)]),_:1})]),_:1}),l(ft,null,{default:o(()=>[l(nl,{class:"my-4"},{default:o(()=>[l(ol,null,{default:o(()=>U[2]||(U[2]=[Q("Caution")])),_:1}),U[3]||(U[3]=Z("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1))]),_:1}),Z("h3",zl,"#"+j(f.value.Reference)+" "+j(f.value.User.DisplayName),1),l(ra,{modelValue:f.value.Tags,"onUpdate:modelValue":U[0]||(U[0]=u=>f.value.Tags=u),convention:f.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":A.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),l(tl,{class:"px-4 align-start"},{default:o(()=>[l(lt,{label:"Show UUID",modelValue:A.value,"onUpdate:modelValue":U[1]||(U[1]=u=>A.value=u)},null,8,["modelValue"]),l(xt,{onClick:y,variant:"flat"})]),_:1})]),_:1}))}}),Ql=sa(Kl,[["__scopeId","data-v-a4024c39"]]),Gt=he({__name:"RegistrationActionWindows",props:Ue({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Ue(["update:registration"],["update:modelValue"]),setup(V,{emit:O}){const p=V,f=be(V,"modelValue"),b=ta(p,O,void 0,void 0,"registration");return(y,i)=>(d(),C(na,{modelValue:f.value,"onUpdate:modelValue":i[3]||(i[3]=U=>f.value=U),disabled:!0,touch:!1},{default:o(()=>[l(Ye,{value:"badges"},{default:o(()=>[f.value=="badges"?(d(),C(Ee,{key:0,class:"pa-0 mx-0",fluid:!0},{default:o(()=>[l(Na,{convention:y.convention,registration:M(b)},null,8,["convention","registration"])]),_:1})):z("",!0)]),_:1}),l(Ye,{value:"emails"},{default:o(()=>[f.value=="emails"?(d(),C(Ee,{key:0,class:"pa-0 mx-0",fluid:!0},{default:o(()=>[l(Pa,{registration:M(b)},null,8,["registration"])]),_:1})):z("",!0)]),_:1}),l(Ye,{value:"notes"},{default:o(()=>[f.value=="notes"?(d(),C(Ee,{key:0,class:"pa-0 mx-0",fluid:!0},{default:o(()=>[l($a,{convention:y.convention,expanded:!1,registration:M(b)},null,8,["convention","registration"])]),_:1})):z("",!0)]),_:1}),l(Ye,{value:"payments"},{default:o(()=>[f.value=="payments"?(d(),C(Ee,{key:0,class:"pa-0 mx-0",fluid:!0},{default:o(()=>[l(Hl,{modelValue:M(b),"onUpdate:modelValue":i[0]||(i[0]=U=>nt(b)?b.value=U:null),forms:y.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):z("",!0)]),_:1}),l(Ye,{value:"status"},{default:o(()=>[f.value=="status"?(d(),C(Ee,{key:0,class:"pa-0 mx-0",fluid:!0},{default:o(()=>[l(jl,{modelValue:M(b),"onUpdate:modelValue":i[1]||(i[1]=U=>nt(b)?b.value=U:null),forms:y.forms},null,8,["modelValue","forms"])]),_:1})):z("",!0)]),_:1}),l(Ye,{value:"tags"},{default:o(()=>[f.value=="tags"?(d(),C(Ee,{key:0,class:"pa-0 mx-0",fluid:!0},{default:o(()=>[l(Ql,{modelValue:M(b),"onUpdate:modelValue":i[2]||(i[2]=U=>nt(b)?b.value=U:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):z("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Jl=(V,O)=>V===void 0?!1:oa(V,ia.GROUP_TYPE_CONVENTION,O.ConventionUUID,O).ViewPaymentTransactions,Xl={key:0},Wl={key:1},qt=he({__name:"RegistrationActions",props:Ue({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Ue(["update:registration"],["update:modelValue"]),setup(V,{emit:O}){const p=V,f=be(V,"modelValue"),b=ta(p,O,void 0,void 0,"registration"),y=S("notes"),i=ct(),U=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Jl(i,p.convention)&&U.splice(2,0,{label:"Payments",value:"payments"}),(u,_)=>u.useDialog?(d(),N("div",Xl,[l(Et,{modelValue:f.value,"onUpdate:modelValue":_[3]||(_[3]=k=>f.value=k),title:u.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:o(()=>[l(Yt,{modelValue:y.value,"onUpdate:modelValue":_[0]||(_[0]=k=>y.value=k),tabs:U,"show-arrows":!0},null,8,["modelValue"])]),default:o(()=>[l(Gt,{modelValue:y.value,"onUpdate:modelValue":_[1]||(_[1]=k=>y.value=k),registration:M(b),"onUpdate:registration":_[2]||(_[2]=k=>nt(b)?b.value=k:null),accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,tabs:U,tickets:u.tickets,venues:u.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(d(),N("div",Wl,[l(Yt,{modelValue:y.value,"onUpdate:modelValue":_[4]||(_[4]=k=>y.value=k),tabs:U,"show-arrows":!0},null,8,["modelValue"]),l(Gt,{modelValue:y.value,"onUpdate:modelValue":_[5]||(_[5]=k=>y.value=k),registration:M(b),"onUpdate:registration":_[6]||(_[6]=k=>nt(b)?b.value=k:null),accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,tabs:U,tickets:u.tickets,venues:u.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),ma=(V,O)=>{V.forEach(p=>{p.Items.forEach(f=>{(f.SectionField==null||f.SectionField.Field==null)&&O.find(A=>{A.Sections.find(b=>{if(b.Fields){const y=b.Fields.find(i=>i.SectionFieldUUID===f.SectionFieldUUID);if(y)return f.SectionField=y,!0}})})})})},Zl={base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"},en={base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"},tn={base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"},an={base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"},ln={base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"},nn={base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"},on={base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"},sn={base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"},rn={base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"},un={base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"},dn={base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"},mn={base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"},cn={base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"},fn={base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"},vn={base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"},Un={base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"},pn={base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"},_n={base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"},gn={base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"},xn={black:"#000000",white:"#ffffff",transparent:"#ffffff00"},hn={red:Zl,pink:en,purple:tn,deepPurple:an,indigo:ln,blue:nn,lightBlue:on,cyan:sn,teal:rn,green:un,lightGreen:dn,lime:mn,yellow:cn,amber:fn,orange:vn,deepOrange:Un,brown:pn,blueGrey:_n,grey:gn,shades:xn},yn=he({__name:"EditAdminLayoutSearch",props:Ue({formOptions:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const O=V,p=be(V,"modelValue");p.value.Search||(p.value.Search=[]);const f=S(O.formOptions),A=()=>{p.value.Search.push({ID:0,LayoutItemUUID:Le(),LayoutPanelID:p.value.AdminLayoutID,LayoutPanelUUID:p.value.AdminLayoutUUID,Label:"",SourceType:Ce.LAYOUT_ITEM_SOURCE_FORM,Align:"",Order:p.value.Search.length,DefaultSort:!1,Meta:{}})},b=i=>{const U=p.value.Search.findIndex(u=>u.LayoutItemUUID===i.LayoutItemUUID);U!=-1&&p.value.Search.splice(U,1)},y=i=>{const U=f.value.find(u=>u.value===i.SectionFieldUUID);U&&(i.SectionFieldID=U.object.ID,i.SectionField=U.object)};return(i,U)=>(d(),N(ee,null,[(d(!0),N(ee,null,xe(p.value.Search,u=>(d(),C(ce,{key:u.LayoutItemUUID},{default:o(()=>[l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ie,{modelValue:u.SourceType,"onUpdate:modelValue":_=>u.SourceType=_,label:"Source Type",items:M(At),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(w,null,{default:o(()=>[u.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(d(),C(ie,{key:0,modelValue:u.SectionFieldUUID,"onUpdate:modelValue":_=>u.SectionFieldUUID=_,label:"Form Data",items:f.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:_=>y(u)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):u.SourceType==="LAYOUT_ITEM_SOURCE_META"?(d(),C(ie,{key:1,modelValue:u.MetaField,"onUpdate:modelValue":_=>u.MetaField=_,label:"Miscellaneous Data",items:M(Dt),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):u.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(d(),C(ie,{key:2,modelValue:u.UserField,"onUpdate:modelValue":_=>u.UserField=_,label:"User Profile Data",items:M(St),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):z("",!0)]),_:2},1024),l(w,null,{default:o(()=>[l(se,{icon:"mdi:mdi-delete",onClick:_=>b(u)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(se,{onClick:A,color:"primary"},{default:o(()=>U[0]||(U[0]=[Q(" Add Search Item ")])),_:1})],64))}}),Tn=he({__name:"EditAdminLayoutFilter",props:Ue({formOptions:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const O=V,p=be(V,"modelValue");p.value.Filter||(p.value.Filter=[]);const f=S(O.formOptions),A=()=>{p.value.Filter.push({ID:0,LayoutItemUUID:Le(),LayoutPanelID:p.value.AdminLayoutID,LayoutPanelUUID:p.value.AdminLayoutUUID,Label:"",SourceType:Ce.LAYOUT_ITEM_SOURCE_FORM,Align:"",Order:p.value.Filter.length,DefaultSort:!1,Meta:{}})},b=i=>{const U=p.value.Filter.findIndex(u=>u.LayoutItemUUID===i.LayoutItemUUID);U!=-1&&p.value.Filter.splice(U,1)},y=i=>{const U=f.value.find(u=>u.value===i.SectionFieldUUID);U&&(i.SectionFieldID=U.object.ID,i.SectionField=U.object)};return(i,U)=>(d(),N(ee,null,[(d(!0),N(ee,null,xe(p.value.Filter,u=>(d(),C(ce,{key:u.LayoutItemUUID},{default:o(()=>[l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ie,{modelValue:u.SourceType,"onUpdate:modelValue":_=>u.SourceType=_,label:"Source Type",items:M(At),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(w,null,{default:o(()=>[u.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(d(),C(ie,{key:0,modelValue:u.SectionFieldUUID,"onUpdate:modelValue":_=>u.SectionFieldUUID=_,label:"Form Data",items:f.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:_=>y(u)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):u.SourceType==="LAYOUT_ITEM_SOURCE_META"?(d(),C(ie,{key:1,modelValue:u.MetaField,"onUpdate:modelValue":_=>u.MetaField=_,label:"Miscellaneous Data",items:M(Dt),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):u.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(d(),C(ie,{key:2,modelValue:u.UserField,"onUpdate:modelValue":_=>u.UserField=_,label:"User Profile Data",items:M(St),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):z("",!0)]),_:2},1024),l(w,null,{default:o(()=>[l(se,{icon:"mdi:mdi-delete",onClick:_=>b(u)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(se,{onClick:A,color:"primary"},{default:o(()=>U[0]||(U[0]=[Q(" Add Filter Item ")])),_:1})],64))}}),In={key:0,class:"text-warning text-right pl-1"},bn=he({__name:"EditAdminLayout",props:Ue({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Ue(["change","delete"],["update:modelValue"]),setup(V,{emit:O}){const p=cl(),f=be(V,"modelValue"),A=S([]),b=Fe(),y=O,i=S(Object.assign({},...V.layouts.map(J=>J.Panels.map(F=>F.Items.map(D=>{if(!D.Meta)return{};const ne={};return Object.entries(D.Meta).forEach(c=>{Array.isArray(c[1])?(ne[`${D.LayoutItemUUID}.${c[0]}`]=[],c[1].forEach(ae=>{ne[`${D.LayoutItemUUID}.${c[0]}`].push(ae.toString())})):c[1]!==void 0&&c[1]!==null&&(ne[`${D.LayoutItemUUID}.${c[0]}`]=[c[1].toString()])}),ne}))).flat(2))),U=S(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),u=S(!1),_=S([]);b.getConventionTags(V.convention.ConventionUUID).then(J=>{J&&(_.value=J)}).catch(()=>{});const k=()=>({ID:0,LayoutPanelUUID:Le(),AdminLayoutID:f.value.ID,AdminLayoutUUID:f.value.AdminLayoutUUID,Name:"",Order:f.value.Panels.length+1,Items:[],Search:[],Filter:[],PanelStyle:Nt.PANEL_STYLE_FLEX,RequiredFormType:de.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),L=J=>()=>({ID:0,LayoutItemUUID:Le(),LayoutPanelID:J.ID,LayoutPanelUUID:J.LayoutPanelUUID,Label:"",SourceType:Ce.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:J.Items.length+1,DefaultSort:!1,Meta:{}}),$=(J,F)=>{J.Meta[F]=i.value[`${J.LayoutItemUUID}.${F}`]},q=J=>{const F=A.value.find(D=>D.value===J.SectionFieldUUID);F&&(J.SectionFieldID=F.object.ID,J.SectionField=F.object)};b.getConventionForms(f.value.ConventionUUID).then(J=>{J&&(J.forEach(F=>F.Sections.forEach(D=>D.Fields&&A.value.push(...D.Fields.map(ne=>{var ae;return{title:`${F.Name} - ${D.Name} - ${(ae=ne.Field)==null?void 0:ae.Name}`,value:ne.SectionFieldUUID,object:ne}})))),A.value.sort(ul("title")),ma(f.value.Panels,J))});const te=wt(()=>{switch(f.value.Type){case ke.ADMIN_LAYOUT_PANELS:return"Panels";case ke.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});Ve(f,()=>{y("change")},{deep:!0});const me=wt(()=>{const J=/([a-zA-Z]+)(\d+)/;return Object.entries(hn).map(([F,D])=>Object.entries(D).map(([ne,c])=>{const ae=J.exec(ne);return!ae||ae.length<3?void 0:{Title:`${gt(F).split(/(?=[A-Z])/).join(" ")} ${gt(ae[1])} ${gt(ae[2])}`,CSSName:`${F}-${ae[1]}-${ae[2]}`,Value:c}})).flat().filter(F=>!!F).sort((F,D)=>F.Title>D.Title?1:F.Title==D.Title?0:-1)});return(J,F)=>(d(),C(Ee,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[l(ce,null,{default:o(()=>[l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ve,{modelValue:f.value.Name,"onUpdate:modelValue":F[0]||(F[0]=D=>f.value.Name=D),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ie,{modelValue:f.value.Type,"onUpdate:modelValue":F[1]||(F[1]=D=>f.value.Type=D),label:"Layout Type",items:M(Ba),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),f.value.Type==M(ke).ADMIN_LAYOUT_PANELS?(d(),C(w,{key:0,cols:"12",sm:"6"},{default:o(()=>[l(ie,{modelValue:f.value.RunnerLayoutUUID,"onUpdate:modelValue":F[2]||(F[2]=D=>f.value.RunnerLayoutUUID=D),clearable:!0,items:J.layouts.filter(D=>D.Type===M(ke).ADMIN_LAYOUT_PANELS)||[],multiple:!1,label:"Runner Display (Optional)","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})):z("",!0)]),_:1}),l(ce,null,{default:o(()=>[l(w,null,{default:o(()=>[l(ht,{modelValue:f.value.Panels,"onUpdate:modelValue":F[3]||(F[3]=D=>f.value.Panels=D),"new-item":k,closeable:!1,title:te.value,label:"Name","slot-name-prefix":"panel"},mt({_:2},[xe(f.value.Panels,(D,ne)=>({name:`panel_${ne}`,fn:o(()=>[l(Ee,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[l(ce,null,{default:o(()=>[l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ve,{modelValue:D.Name,"onUpdate:modelValue":c=>D.Name=c,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),f.value.Type===M(ke).ADMIN_LAYOUT_PANELS?(d(),C(w,{key:0,cols:"12",sm:"6"},{default:o(()=>[l(ie,{modelValue:D.PanelStyle,"onUpdate:modelValue":c=>D.PanelStyle=c,items:M(Ya),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):z("",!0),l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ie,{modelValue:D.RequiredFormType,"onUpdate:modelValue":c=>D.RequiredFormType=c,items:M(Ha),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(w,{cols:"12",sm:"6"},{default:o(()=>[l(dl,{label:"Required Groups",variant:"outlined",modelValue:D.RequiredGroupMemberships,"onUpdate:modelValue":c=>D.RequiredGroupMemberships=c,convention:f.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ra,{label:"Registration Tags",variant:"outlined",modelValue:D.RequiredRegistrationTags,"onUpdate:modelValue":c=>D.RequiredRegistrationTags=c,convention:f.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),M(p)?(d(),C(ce,{key:0},{default:o(()=>[l(w,null,{default:o(()=>[l(ua,{variant:"accordion"},{default:o(()=>[l(yt,null,{default:o(()=>[l(Tt,null,{default:o(()=>F[7]||(F[7]=[Q(" Filters ")])),_:1}),l(It,null,{default:o(()=>[F[8]||(F[8]=Z("p",null," Fixed search settings to pre-filter results by ",-1)),l(Tn,{modelValue:f.value.Panels[ne],"onUpdate:modelValue":c=>f.value.Panels[ne]=c,"form-options":A.value},null,8,["modelValue","onUpdate:modelValue","form-options"])]),_:2},1024)]),_:2},1024),l(yt,null,{default:o(()=>[l(Tt,null,{default:o(()=>F[9]||(F[9]=[Q(" Search Options ")])),_:1}),l(It,null,{default:o(()=>[F[10]||(F[10]=Z("p",null," Dynamic search options ",-1)),l(yn,{modelValue:f.value.Panels[ne],"onUpdate:modelValue":c=>f.value.Panels[ne]=c,"form-options":A.value},null,8,["modelValue","onUpdate:modelValue","form-options"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):z("",!0),f.value.Type===M(ke).ADMIN_LAYOUT_PANELS&&D.PanelStyle===M(Nt).PANEL_STYLE_FLEX?(d(),C(ce,{key:1},{default:o(()=>[l(w,{cols:"12",class:"py-0 my-0"},{default:o(()=>F[11]||(F[11]=[Z("h4",null,"Grid Size (Max 12)",-1)])),_:1}),l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(ve,{modelValue:D.Meta.cols,"onUpdate:modelValue":c=>D.Meta.cols=c,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(ve,{modelValue:D.Meta.cols_xs,"onUpdate:modelValue":c=>D.Meta.cols_xs=c,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(ve,{modelValue:D.Meta.cols_sm,"onUpdate:modelValue":c=>D.Meta.cols_sm=c,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(ve,{modelValue:D.Meta.cols_md,"onUpdate:modelValue":c=>D.Meta.cols_md=c,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(ve,{modelValue:D.Meta.cols_lg,"onUpdate:modelValue":c=>D.Meta.cols_lg=c,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(ve,{modelValue:D.Meta.cols_xl,"onUpdate:modelValue":c=>D.Meta.cols_xl=c,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):z("",!0)]),_:2},1024),l(ht,{modelValue:D.Items,"onUpdate:modelValue":c=>D.Items=c,"new-item":L(D),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},mt({_:2},[xe(D.Items,(c,ae)=>({name:`item_${ae}`,fn:o(()=>[l(Ee,{class:"px-0 mx-0",fluid:!0},{default:o(()=>{var ye,h;return[l(ce,null,{default:o(()=>[l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ve,{modelValue:c.Label,"onUpdate:modelValue":v=>c.Label=v,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),l(ce,null,{default:o(()=>[l(w,{cols:"12",sm:"6"},{default:o(()=>[l(ie,{modelValue:c.SourceType,"onUpdate:modelValue":v=>c.SourceType=v,label:"Source Type",items:M(At),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(w,{cols:"12",sm:"6"},{default:o(()=>[c.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(d(),C(ie,{key:0,modelValue:c.SectionFieldUUID,"onUpdate:modelValue":v=>c.SectionFieldUUID=v,label:"Form Data",items:A.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:v=>q(c)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):c.SourceType==="LAYOUT_ITEM_SOURCE_META"?(d(),C(ie,{key:1,modelValue:c.MetaField,"onUpdate:modelValue":v=>c.MetaField=v,label:"Miscellaneous Data",items:M(Dt),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):c.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(d(),C(ie,{key:2,modelValue:c.UserField,"onUpdate:modelValue":v=>c.UserField=v,label:"User Profile Data",items:M(St),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):z("",!0)]),_:2},1024)]),_:2},1024),J.layouts&&c.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((h=(ye=c.SectionField)==null?void 0:ye.Field)==null?void 0:h.Type)===M(Jt).TEXT?(d(),C(ce,{key:0},{default:o(()=>[l(w,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:o(()=>[l(lt,{modelValue:c.Meta.DirectEdit,"onUpdate:modelValue":v=>c.Meta.DirectEdit=v,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(w,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:o(()=>[l(ie,{modelValue:c.Meta.DirectEditPermission,"onUpdate:modelValue":v=>c.Meta.DirectEditPermission=v,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):z("",!0),J.layouts&&c.SourceType==="LAYOUT_ITEM_SOURCE_META"&&c.MetaField===M(W).META_DATA_SOURCE_BADGE_DISPLAY?(d(),C(ce,{key:1},{default:o(()=>[l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(lt,{modelValue:c.Meta.HideDownloadButton,"onUpdate:modelValue":v=>c.Meta.HideDownloadButton=v,label:"Hide Download Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(lt,{modelValue:c.Meta.HideNFCButton,"onUpdate:modelValue":v=>c.Meta.HideNFCButton=v,label:"Hide NFC Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):z("",!0),J.layouts&&c.SourceType==="LAYOUT_ITEM_SOURCE_META"&&c.MetaField===M(W).META_DATA_SOURCE_DATA_LAYOUT?(d(),C(ce,{key:2},{default:o(()=>[l(w,{cols:"6",sm:"4",lg:"2"},{default:o(()=>[l(ie,{modelValue:i.value[`${c.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[v=>i.value[`${c.LayoutItemUUID}.LayoutUUID`]=v,v=>$(c,"LayoutUUID")],clearable:!0,items:J.layouts.filter(v=>v.Type===M(ke).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):z("",!0),J.layouts&&c.SourceType==="LAYOUT_ITEM_SOURCE_META"&&c.MetaField===M(W).META_DATA_SOURCE_TAGS?(d(),C(ce,{key:3},{default:o(()=>[l(w,{cols:"6",sm:"6",md:"6",lg:"6"},{default:o(()=>[l(ie,{modelValue:i.value[`${c.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[v=>i.value[`${c.LayoutItemUUID}.Tags`]=v,v=>$(c,"Tags")],clearable:!0,items:_.value||[],multiple:!0,chips:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!i.value[c.LayoutItemUUID]||i.value[c.LayoutItemUUID].length===0?(d(),N("small",In," Will show all tags ")):z("",!0)]),_:2},1024),l(w,{cols:"6"},{default:o(()=>[l(ie,{modelValue:c.Meta.TagColour,"onUpdate:modelValue":v=>c.Meta.TagColour=v,items:me.value,label:"Colour","item-title":"Title","item-value":"Value",variant:"outlined","hide-details":""},{selection:o(({item:v})=>[l(se,{size:"x-small",color:v.raw.Value,class:"mr-2"},null,8,["color"]),Q(" "+j(v.title),1)]),item:o(({props:v,item:R})=>[l(tt,Ia(ba(v)),{prepend:o(()=>[l(se,{size:"x-small",color:R.raw.Value,class:"mr-2"},null,8,["color"])]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):z("",!0),f.value.Type===M(ke).ADMIN_LAYOUT_TABLE&&(c.SourceType!==M(Ce).LAYOUT_ITEM_SOURCE_META||c.MetaField!==M(W).META_DATA_SOURCE_DATA_LAYOUT)?(d(),C(ce,{key:4},{default:o(()=>[l(w,null,{default:o(()=>[l(lt,{modelValue:c.DefaultSort,"onUpdate:modelValue":v=>c.DefaultSort=v,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):z("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),l(ce,null,{default:o(()=>[l(w,null,{default:o(()=>[l(se,{onClick:F[4]||(F[4]=D=>u.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:o(()=>F[12]||(F[12]=[Q("Delete Layout")])),_:1})]),_:1})]),_:1}),u.value?(d(),C(ml,{key:0,modelValue:u.value,"onUpdate:modelValue":F[5]||(F[5]=D=>u.value=D),message:U.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:F[6]||(F[6]=D=>y("delete"))},null,8,["modelValue","message"])):z("",!0)]),_:1}))}}),An=he({__name:"EditAdminLayouts",props:Ue({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Ue(["save"],["update:modelValue"]),setup(V,{emit:O}){const p=be(V,"modelValue"),f=O,A=S([]),b=S([]),y=S([]),i=Fe(),U=()=>({ID:0,AdminLayoutUUID:Le(),ConventionID:V.convention.ID,ConventionUUID:V.convention.ConventionUUID,Name:"New Layout",Type:ke.ADMIN_LAYOUT_PANELS,Panels:[]}),u=()=>{let k=!1;[...new Set(y.value)].forEach($=>{const q=A.value.findIndex(te=>te.AdminLayoutUUID===$);q<0||q>=A.value.length||(i.saveAdminLayout(A.value[q]).then(te=>{te&&A.value.splice(q,1,te)}).catch(()=>{}),k=!0)}),b.value.forEach($=>{i.deleteAdminLayout($).catch(()=>{})}),b.value=[],y.value=[],k&&f("save")},_=k=>{const L=A.value.findIndex($=>$.AdminLayoutUUID===k.AdminLayoutUUID);L<0||L>=A.value.length||(A.value[L].ID>0&&b.value.push(k.AdminLayoutUUID),A.value.splice(L,1))};return i.getConventionAdminLayouts(V.convention.ConventionUUID).then(k=>{k&&(A.value=k)}).catch(()=>[]),(k,L)=>(d(),C(da,{modelValue:p.value,"onUpdate:modelValue":L[2]||(L[2]=$=>p.value=$),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:o(()=>[l(ht,{modelValue:A.value,"onUpdate:modelValue":L[0]||(L[0]=$=>A.value=$),"new-item":U,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:k.title,label:"Name","slot-name-prefix":"panel",onClose:L[1]||(L[1]=$=>p.value=!1),onSave:u},mt({_:2},[xe(A.value,($,q)=>({name:`panel_${q}`,fn:o(()=>[l(Ee,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[l(ce,null,{default:o(()=>[l(w,{cols:"12"},{default:o(()=>[l(bn,{modelValue:A.value[q],"onUpdate:modelValue":te=>A.value[q]=te,convention:k.convention,layouts:A.value,onChange:te=>y.value.push($.AdminLayoutUUID),onDelete:te=>_($)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}});var rt={exports:{}},Dn=rt.exports,Ht;function Sn(){return Ht||(Ht=1,function(V,O){(function(p,f){V.exports=f()})(Dn,function(){var p=function(){},f=Object.prototype.hasOwnProperty,A=Array.prototype.slice;function b(t,e){var a;return typeof Object.create=="function"?a=Object.create(t):(p.prototype=t,a=new p,p.prototype=null),e&&i(!0,a,e),a}function y(t,e,a,n){var s=this;return typeof t!="string"&&(n=a,a=e,e=t,t=null),typeof e!="function"&&(n=a,a=e,e=function(){return s.apply(this,arguments)}),i(!1,e,s,n),e.prototype=b(s.prototype,a),e.prototype.constructor=e,e.class_=t||s.class_,e.super_=s,e}function i(t,e,a){a=A.call(arguments,2);for(var n,s,g=0,T=a.length;g<T;g++){s=a[g];for(n in s)(!t||f.call(s,n))&&(e[n]=s[n])}}var U=y;function u(){}u.class_="Nevis",u.super_=Object,u.extend=U;var _=u,k=_,L=k.extend(function(t,e,a){this.qrious=t,this.element=e,this.element.qrious=t,this.enabled=!!a},{draw:function(t){},getElement:function(){return this.enabled||(this.enabled=!0,this.render()),this.element},getModuleSize:function(t){var e=this.qrious,a=e.padding||0,n=Math.floor((e.size-a*2)/t.width);return Math.max(1,n)},getOffset:function(t){var e=this.qrious,a=e.padding;if(a!=null)return a;var n=this.getModuleSize(t),s=Math.floor((e.size-n*t.width)/2);return Math.max(0,s)},render:function(t){this.enabled&&(this.resize(),this.reset(),this.draw(t))},reset:function(){},resize:function(){}}),$=L,q=$.extend({draw:function(t){var e,a,n=this.qrious,s=this.getModuleSize(t),g=this.getOffset(t),T=this.element.getContext("2d");for(T.fillStyle=n.foreground,T.globalAlpha=n.foregroundAlpha,e=0;e<t.width;e++)for(a=0;a<t.width;a++)t.buffer[a*t.width+e]&&T.fillRect(s*e+g,s*a+g,s,s)},reset:function(){var t=this.qrious,e=this.element.getContext("2d"),a=t.size;e.lineWidth=1,e.clearRect(0,0,a,a),e.fillStyle=t.background,e.globalAlpha=t.backgroundAlpha,e.fillRect(0,0,a,a)},resize:function(){var t=this.element;t.width=t.height=this.qrious.size}}),te=q,me=k.extend(null,{BLOCK:[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28]}),J=me,F=k.extend(null,{BLOCKS:[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],FINAL_FORMAT:[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],LEVELS:{L:1,M:2,Q:3,H:4}}),D=F,ne=k.extend(null,{EXPONENT:[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],LOG:[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175]}),c=ne,ae=k.extend(null,{BLOCK:[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177]}),ye=ae,h=k.extend(function(t){var e,a,n,s,g,T=t.value.length;for(this._badness=[],this._level=D.LEVELS[t.level],this._polynomial=[],this._value=t.value,this._version=0,this._stringBuffer=[];this._version<40&&(this._version++,n=(this._level-1)*4+(this._version-1)*16,s=D.BLOCKS[n++],g=D.BLOCKS[n++],e=D.BLOCKS[n++],a=D.BLOCKS[n],n=e*(s+g)+g-3+(this._version<=9),!(T<=n)););this._dataBlock=e,this._eccBlock=a,this._neccBlock1=s,this._neccBlock2=g;var E=this.width=17+4*this._version;this.buffer=h._createArray(E*E),this._ecc=h._createArray(e+(e+a)*(s+g)+g),this._mask=h._createArray((E*(E+1)+1)/2),this._insertFinders(),this._insertAlignments(),this.buffer[8+E*(E-8)]=1,this._insertTimingGap(),this._reverseMask(),this._insertTimingRowAndColumn(),this._insertVersion(),this._syncMask(),this._convertBitStream(T),this._calculatePolynomial(),this._appendEccToData(),this._interleaveBlocks(),this._pack(),this._finish()},{_addAlignment:function(t,e){var a,n=this.buffer,s=this.width;for(n[t+s*e]=1,a=-2;a<2;a++)n[t+a+s*(e-2)]=1,n[t-2+s*(e+a+1)]=1,n[t+2+s*(e+a)]=1,n[t+a+1+s*(e+2)]=1;for(a=0;a<2;a++)this._setMask(t-1,e+a),this._setMask(t+1,e-a),this._setMask(t-a,e-1),this._setMask(t+a,e+1)},_appendData:function(t,e,a,n){var s,g,T,E=this._polynomial,K=this._stringBuffer;for(g=0;g<n;g++)K[a+g]=0;for(g=0;g<e;g++){if(s=c.LOG[K[t+g]^K[a]],s!==255)for(T=1;T<n;T++)K[a+T-1]=K[a+T]^c.EXPONENT[h._modN(s+E[n-T])];else for(T=a;T<a+n;T++)K[T]=K[T+1];K[a+n-1]=s===255?0:c.EXPONENT[h._modN(s+E[0])]}},_appendEccToData:function(){var t,e=0,a=this._dataBlock,n=this._calculateMaxLength(),s=this._eccBlock;for(t=0;t<this._neccBlock1;t++)this._appendData(e,a,n,s),e+=a,n+=s;for(t=0;t<this._neccBlock2;t++)this._appendData(e,a+1,n,s),e+=a+1,n+=s},_applyMask:function(t){var e,a,n,s,g=this.buffer,T=this.width;switch(t){case 0:for(s=0;s<T;s++)for(n=0;n<T;n++)!(n+s&1)&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break;case 1:for(s=0;s<T;s++)for(n=0;n<T;n++)!(s&1)&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break;case 2:for(s=0;s<T;s++)for(e=0,n=0;n<T;n++,e++)e===3&&(e=0),!e&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break;case 3:for(a=0,s=0;s<T;s++,a++)for(a===3&&(a=0),e=a,n=0;n<T;n++,e++)e===3&&(e=0),!e&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break;case 4:for(s=0;s<T;s++)for(e=0,a=s>>1&1,n=0;n<T;n++,e++)e===3&&(e=0,a=!a),!a&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break;case 5:for(a=0,s=0;s<T;s++,a++)for(a===3&&(a=0),e=0,n=0;n<T;n++,e++)e===3&&(e=0),!((n&s&1)+!(!e|!a))&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break;case 6:for(a=0,s=0;s<T;s++,a++)for(a===3&&(a=0),e=0,n=0;n<T;n++,e++)e===3&&(e=0),!((n&s&1)+(e&&e===a)&1)&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break;case 7:for(a=0,s=0;s<T;s++,a++)for(a===3&&(a=0),e=0,n=0;n<T;n++,e++)e===3&&(e=0),!((e&&e===a)+(n+s&1)&1)&&!this._isMasked(n,s)&&(g[n+s*T]^=1);break}},_calculateMaxLength:function(){return this._dataBlock*(this._neccBlock1+this._neccBlock2)+this._neccBlock2},_calculatePolynomial:function(){var t,e,a=this._eccBlock,n=this._polynomial;for(n[0]=1,t=0;t<a;t++){for(n[t+1]=1,e=t;e>0;e--)n[e]=n[e]?n[e-1]^c.EXPONENT[h._modN(c.LOG[n[e]]+t)]:n[e-1];n[0]=c.EXPONENT[h._modN(c.LOG[n[0]]+t)]}for(t=0;t<=a;t++)n[t]=c.LOG[n[t]]},_checkBadness:function(){var t,e,a,n,s,g=0,T=this._badness,E=this.buffer,K=this.width;for(s=0;s<K-1;s++)for(n=0;n<K-1;n++)(E[n+K*s]&&E[n+1+K*s]&&E[n+K*(s+1)]&&E[n+1+K*(s+1)]||!(E[n+K*s]||E[n+1+K*s]||E[n+K*(s+1)]||E[n+1+K*(s+1)]))&&(g+=h.N2);var Ie=0;for(s=0;s<K;s++){for(a=0,T[0]=0,t=0,n=0;n<K;n++)e=E[n+K*s],t===e?T[a]++:T[++a]=1,t=e,Ie+=t?1:-1;g+=this._getBadness(a)}Ie<0&&(Ie=-Ie);var it=0,we=Ie;for(we+=we<<2,we<<=1;we>K*K;)we-=K*K,it++;for(g+=it*h.N4,n=0;n<K;n++){for(a=0,T[0]=0,t=0,s=0;s<K;s++)e=E[n+K*s],t===e?T[a]++:T[++a]=1,t=e;g+=this._getBadness(a)}return g},_convertBitStream:function(t){var e,a,n=this._ecc,s=this._version;for(a=0;a<t;a++)n[a]=this._value.charCodeAt(a);var g=this._stringBuffer=n.slice(),T=this._calculateMaxLength();t>=T-2&&(t=T-2,s>9&&t--);var E=t;if(s>9){for(g[E+2]=0,g[E+3]=0;E--;)e=g[E],g[E+3]|=255&e<<4,g[E+2]=e>>4;g[2]|=255&t<<4,g[1]=t>>4,g[0]=64|t>>12}else{for(g[E+1]=0,g[E+2]=0;E--;)e=g[E],g[E+2]|=255&e<<4,g[E+1]=e>>4;g[1]|=255&t<<4,g[0]=64|t>>4}for(E=t+3-(s<10);E<T;)g[E++]=236,g[E++]=17},_getBadness:function(t){var e,a=0,n=this._badness;for(e=0;e<=t;e++)n[e]>=5&&(a+=h.N1+n[e]-5);for(e=3;e<t-1;e+=2)n[e-2]===n[e+2]&&n[e+2]===n[e-1]&&n[e-1]===n[e+1]&&n[e-1]*3===n[e]&&(n[e-3]===0||e+3>t||n[e-3]*3>=n[e]*4||n[e+3]*3>=n[e]*4)&&(a+=h.N3);return a},_finish:function(){this._stringBuffer=this.buffer.slice();var t,e,a=0,n=3e4;for(e=0;e<8&&(this._applyMask(e),t=this._checkBadness(),t<n&&(n=t,a=e),a!==7);e++)this.buffer=this._stringBuffer.slice();a!==e&&this._applyMask(a),n=D.FINAL_FORMAT[a+(this._level-1<<3)];var s=this.buffer,g=this.width;for(e=0;e<8;e++,n>>=1)n&1&&(s[g-1-e+g*8]=1,e<6?s[8+g*e]=1:s[8+g*(e+1)]=1);for(e=0;e<7;e++,n>>=1)n&1&&(s[8+g*(g-7+e)]=1,e?s[6-e+g*8]=1:s[7+g*8]=1)},_interleaveBlocks:function(){var t,e,a=this._dataBlock,n=this._ecc,s=this._eccBlock,g=0,T=this._calculateMaxLength(),E=this._neccBlock1,K=this._neccBlock2,Ie=this._stringBuffer;for(t=0;t<a;t++){for(e=0;e<E;e++)n[g++]=Ie[t+e*a];for(e=0;e<K;e++)n[g++]=Ie[E*a+t+e*(a+1)]}for(e=0;e<K;e++)n[g++]=Ie[E*a+t+e*(a+1)];for(t=0;t<s;t++)for(e=0;e<E+K;e++)n[g++]=Ie[T+t+e*s];this._stringBuffer=n},_insertAlignments:function(){var t,e,a,n=this._version,s=this.width;if(n>1)for(t=J.BLOCK[n],a=s-7;;){for(e=s-7;e>t-3&&(this._addAlignment(e,a),!(e<t));)e-=t;if(a<=t+9)break;a-=t,this._addAlignment(6,a),this._addAlignment(a,6)}},_insertFinders:function(){var t,e,a,n,s=this.buffer,g=this.width;for(t=0;t<3;t++){for(e=0,n=0,t===1&&(e=g-7),t===2&&(n=g-7),s[n+3+g*(e+3)]=1,a=0;a<6;a++)s[n+a+g*e]=1,s[n+g*(e+a+1)]=1,s[n+6+g*(e+a)]=1,s[n+a+1+g*(e+6)]=1;for(a=1;a<5;a++)this._setMask(n+a,e+1),this._setMask(n+1,e+a+1),this._setMask(n+5,e+a),this._setMask(n+a+1,e+5);for(a=2;a<4;a++)s[n+a+g*(e+2)]=1,s[n+2+g*(e+a+1)]=1,s[n+4+g*(e+a)]=1,s[n+a+1+g*(e+4)]=1}},_insertTimingGap:function(){var t,e,a=this.width;for(e=0;e<7;e++)this._setMask(7,e),this._setMask(a-8,e),this._setMask(7,e+a-7);for(t=0;t<8;t++)this._setMask(t,7),this._setMask(t+a-8,7),this._setMask(t,a-8)},_insertTimingRowAndColumn:function(){var t,e=this.buffer,a=this.width;for(t=0;t<a-14;t++)t&1?(this._setMask(8+t,6),this._setMask(6,8+t)):(e[8+t+a*6]=1,e[6+a*(8+t)]=1)},_insertVersion:function(){var t,e,a,n,s=this.buffer,g=this._version,T=this.width;if(g>6)for(t=ye.BLOCK[g-7],e=17,a=0;a<6;a++)for(n=0;n<3;n++,e--)1&(e>11?g>>e-12:t>>e)?(s[5-a+T*(2-n+T-11)]=1,s[2-n+T-11+T*(5-a)]=1):(this._setMask(5-a,2-n+T-11),this._setMask(2-n+T-11,5-a))},_isMasked:function(t,e){var a=h._getMaskBit(t,e);return this._mask[a]===1},_pack:function(){var t,e,a,n=1,s=1,g=this.width,T=g-1,E=g-1,K=(this._dataBlock+this._eccBlock)*(this._neccBlock1+this._neccBlock2)+this._neccBlock2;for(e=0;e<K;e++)for(t=this._stringBuffer[e],a=0;a<8;a++,t<<=1){128&t&&(this.buffer[T+g*E]=1);do s?T--:(T++,n?E!==0?E--:(T-=2,n=!n,T===6&&(T--,E=9)):E!==g-1?E++:(T-=2,n=!n,T===6&&(T--,E-=8))),s=!s;while(this._isMasked(T,E))}},_reverseMask:function(){var t,e,a=this.width;for(t=0;t<9;t++)this._setMask(t,8);for(t=0;t<8;t++)this._setMask(t+a-8,8),this._setMask(8,t);for(e=0;e<7;e++)this._setMask(8,e+a-7)},_setMask:function(t,e){var a=h._getMaskBit(t,e);this._mask[a]=1},_syncMask:function(){var t,e,a=this.width;for(e=0;e<a;e++)for(t=0;t<=e;t++)this.buffer[t+a*e]&&this._setMask(t,e)}},{_createArray:function(t){var e,a=[];for(e=0;e<t;e++)a[e]=0;return a},_getMaskBit:function(t,e){var a;return t>e&&(a=t,t=e,e=a),a=e,a+=e*e,a>>=1,a+=t,a},_modN:function(t){for(;t>=255;)t-=255,t=(t>>8)+(t&255);return t},N1:3,N2:3,N3:40,N4:10}),v=h,R=$.extend({draw:function(){this.element.src=this.qrious.toDataURL()},reset:function(){this.element.src=""},resize:function(){var t=this.element;t.width=t.height=this.qrious.size}}),H=R,oe=k.extend(function(t,e,a,n){this.name=t,this.modifiable=!!e,this.defaultValue=a,this._valueTransformer=n},{transform:function(t){var e=this._valueTransformer;return typeof e=="function"?e(t,this):t}}),_e=oe,Ge=k.extend(null,{abs:function(t){return t!=null?Math.abs(t):null},hasOwn:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},noop:function(){},toUpperCase:function(t){return t!=null?t.toUpperCase():null}}),pe=Ge,Te=k.extend(function(t){this.options={},t.forEach(function(e){this.options[e.name]=e},this)},{exists:function(t){return this.options[t]!=null},get:function(t,e){return Te._get(this.options[t],e)},getAll:function(t){var e,a=this.options,n={};for(e in a)pe.hasOwn(a,e)&&(n[e]=Te._get(a[e],t));return n},init:function(t,e,a){typeof a!="function"&&(a=pe.noop);var n,s;for(n in this.options)pe.hasOwn(this.options,n)&&(s=this.options[n],Te._set(s,s.defaultValue,e),Te._createAccessor(s,e,a));this._setAll(t,e,!0)},set:function(t,e,a){return this._set(t,e,a)},setAll:function(t,e){return this._setAll(t,e)},_set:function(t,e,a,n){var s=this.options[t];if(!s)throw new Error("Invalid option: "+t);if(!s.modifiable&&!n)throw new Error("Option cannot be modified: "+t);return Te._set(s,e,a)},_setAll:function(t,e,a){if(!t)return!1;var n,s=!1;for(n in t)pe.hasOwn(t,n)&&this._set(n,t[n],e,a)&&(s=!0);return s}},{_createAccessor:function(t,e,a){var n={get:function(){return Te._get(t,e)}};t.modifiable&&(n.set=function(s){Te._set(t,s,e)&&a(s,t)}),Object.defineProperty(e,t.name,n)},_get:function(t,e){return e["_"+t.name]},_set:function(t,e,a){var n="_"+t.name,s=a[n],g=t.transform(e??t.defaultValue);return a[n]=g,g!==s}}),qe=Te,He=k.extend(function(){this._services={}},{getService:function(t){var e=this._services[t];if(!e)throw new Error("Service is not being managed with name: "+t);return e},setService:function(t,e){if(this._services[t])throw new Error("Service is already managed with name: "+t);e&&(this._services[t]=e)}}),je=He,ze=new qe([new _e("background",!0,"white"),new _e("backgroundAlpha",!0,1,pe.abs),new _e("element"),new _e("foreground",!0,"black"),new _e("foregroundAlpha",!0,1,pe.abs),new _e("level",!0,"L",pe.toUpperCase),new _e("mime",!0,"image/png"),new _e("padding",!0,null,pe.abs),new _e("size",!0,100,pe.abs),new _e("value",!0,"")]),Ne=new je,Pe=k.extend(function(t){ze.init(t,this,this.update.bind(this));var e=ze.get("element",this),a=Ne.getService("element"),n=e&&a.isCanvas(e)?e:a.createCanvas(),s=e&&a.isImage(e)?e:a.createImage();this._canvasRenderer=new te(this,n,!0),this._imageRenderer=new H(this,s,s===e),this.update()},{get:function(){return ze.getAll(this)},set:function(t){ze.setAll(t,this)&&this.update()},toDataURL:function(t){return this.canvas.toDataURL(t||this.mime)},update:function(){var t=new v({level:this.level,value:this.value});this._canvasRenderer.render(t),this._imageRenderer.render(t)}},{use:function(t){Ne.setService(t.getName(),t)}});Object.defineProperties(Pe.prototype,{canvas:{get:function(){return this._canvasRenderer.getElement()}},image:{get:function(){return this._imageRenderer.getElement()}}});var Ke=Pe,$e=Ke,Qe=k.extend({getName:function(){}}),Je=Qe,Xe=Je.extend({createCanvas:function(){},createImage:function(){},getName:function(){return"element"},isCanvas:function(t){},isImage:function(t){}}),We=Xe,De=We.extend({createCanvas:function(){return document.createElement("canvas")},createImage:function(){return document.createElement("img")},isCanvas:function(t){return t instanceof HTMLCanvasElement},isImage:function(t){return t instanceof HTMLImageElement}}),ge=De;$e.use(new ge);var Re=$e;return Re})}(rt)),rt.exports}var En=Sn();const kn=Aa(En);var Vn=Object.defineProperty,Rn=Object.defineProperties,Mn=Object.getOwnPropertyDescriptors,jt=Object.getOwnPropertySymbols,On=Object.prototype.hasOwnProperty,Cn=Object.prototype.propertyIsEnumerable,zt=(V,O,p)=>O in V?Vn(V,O,{enumerable:!0,configurable:!0,writable:!0,value:p}):V[O]=p,Ln=(V,O)=>{for(var p in O||(O={}))On.call(O,p)&&zt(V,p,O[p]);if(jt)for(var p of jt(O))Cn.call(O,p)&&zt(V,p,O[p]);return V},wn=(V,O)=>Rn(V,Mn(O));const Fn=["L","M","Q","H"];var Nn=he({props:{value:{type:String,required:!0},background:String,backgroundAlpha:Number,foreground:String,foregroundAlpha:Number,level:{type:String,validator:V=>Fn.includes(V)},mime:String,padding:Number,size:Number},setup(V,{attrs:O,emit:p}){const f=new kn(V),A=()=>{try{const y=f.toDataURL(V.mime);return p("change",y),y}catch(y){p("error",y)}},b=S(A());return Ve(V,()=>{f.set(V),b.value=A()}),()=>Da("img",wn(Ln({},O),{src:b.value}))}});const Pn=["href","onClick"],$n=he({__name:"OperatorSocket",setup(V){const O=Fe(),p=ut.getInstance(),f=ct(),A=vl(),b=S(!1),y=Ga({mode:"host",wsUri:O.getRunnerSocketURL()}),i=Sa.getInstance(),U=S(!1),u=S(!1),_=S([]),k=Qt(),L=S("Connecting"),$=S([{title:"- Select Duration -",value:-1},{title:"No Expiry",value:0},{title:"5 Minutes",value:5*60*1e3},{title:"30 Minutes",value:30*60*1e3},{title:"1 Hour",value:60*60*1e3},{title:"1.5 Hours",value:90*60*1e3},{title:"2 Hours",value:120*60*1e3},{title:"3 Hours",value:180*60*1e3},{title:"4 Hours",value:240*60*1e3},{title:"5 Hours",value:300*60*1e3},{title:"6 Hours",value:360*60*1e3}]),q=h=>{if(h.editing=!1,h.timer&&clearTimeout(h.timer),!h.selectedDuration){h.expires=void 0,h.timer=void 0;return}const v=new Date;v.setTime(new Date().getTime()+h.selectedDuration),h.expires=v,te(h),ne()},te=h=>{if(h.expires){if(h.timer&&clearTimeout(h.timer),typeof h.expires=="number"){const v=new Date;v.setTime(h.expires),h.expires=v}h.expires&&"getTime"in h.expires&&(h.timer=setTimeout(()=>{h.timer&&clearTimeout(h.timer),F(h)},h.expires.getTime()-Date.now()))}};y.on("authenticated",()=>{U.value=!0;const h={Key:"",Mode:"host",UserUUID:(f==null?void 0:f.UserUUID)||""},v={Command:"SET_MODE",Params:new Map,Data:JSON.stringify(h)};y.JSON(v)}),y.on("auth_failed",()=>{U.value=!1,L.value="Access Denied"}),y.on("badge_serial_update",h=>{p.emit("badge_serial_update",h)}),y.on("close",()=>{L.value="Disconnected"}),y.on("open",()=>{const h=i.getTokenByService("GrazeAPI");L.value="Authenticating",y.send(`AUTH ${h==null?void 0:h.AccessToken}`)}),y.on("runner_connected",h=>{const v=h,R=_.value.find(oe=>oe.key==v.Key);if(!R){me(v.Key,v.UserUUID);return}const H=gl();H.DisplayName=v.DisplayName,H.UserUUID=v.UserUUID,R.users.find(oe=>oe.UserUUID==H.UserUUID)||R.users.push(H)}),y.on("runner_disconnected",h=>{const v=h,R=_.value.find(oe=>oe.key==v.Key);if(!R)return;const H=R.users.findIndex(oe=>oe.UserUUID==v.UserUUID);H<0||R.users.splice(H,1)}),y.on("started",()=>{_.value.forEach(h=>{const v={Key:h.key},R={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify(v)};y.JSON(R)}),L.value="Connected"}),Ea(()=>{D(),ut.getInstance().on("layout_opened",v=>{const R=v;if(!y||!U.value||!R||!R.AdminLayoutUUID||!R.RegistrationUUID)return;const H={Command:"OPEN_LAYOUT",Params:new Map,Data:JSON.stringify(R)};y.JSON(H)})}),ka(()=>{y.destroy()});const me=(h,v)=>{const H={Command:"KICK_RUNNER",Params:new Map,Data:JSON.stringify({DisplayName:"",Key:h,UserUUID:v})};y.JSON(H)},J=()=>{const h=Le(),R={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify({Key:h})};y.JSON(R),_.value.push({key:h,name:"New Session",users:[]}),ne()},F=h=>{const v=_.value.findIndex(oe=>oe==h);if(v<0)return;const R={Key:h.key},H={Command:"REMOVE_KEY",Params:new Map,Data:JSON.stringify(R)};y.JSON(H),_.value.splice(v,1),ne()},D=()=>{const h=sessionStorage.getItem("collaboration.sessions");h&&(_.value=JSON.parse(h),_.value.forEach(v=>{typeof v.expires!="number"&&(v.expires=0),te(v)}))},ne=()=>{const h=[];_.value.forEach(v=>{h.push({name:v.name,expires:typeof v.expires=="number"?v.expires:v.expires?v.expires.getTime():0,key:v.key,users:[]})}),sessionStorage.setItem("collaboration.sessions",JSON.stringify(h))},c=h=>{const v=k.resolve({name:"RunnerView",params:{user:f==null?void 0:f.UserUUID,session:h.key}}),R=new URL(location.href);return R.pathname=v.href,R.toString()},ae=h=>{const v=c(h);return fl(v),u.value=!0,v},ye=h=>{if(typeof h=="number"){const oe=new Date;oe.setTime(h),h=oe}const v=h.getTime()-Date.now(),R=Math.floor(v/(1e3*60*60)),H=Math.floor(v%(1e3*60*60)/(1e3*60));return R==0&&H==0?`${Math.floor(v%6e4/1e3)}s`:`${R}hr${R!=1?"s":""} ${H}min${H!=1?"s":""}`};return(h,v)=>U.value?(d(),N(ee,{key:0},[l(se,{icon:"mdi:mdi-link-variant",onClick:v[0]||(v[0]=R=>b.value=!0)}),l(Et,{modelValue:b.value,"onUpdate:modelValue":v[4]||(v[4]=R=>b.value=R),"hide-extension":!0,"show-save-action":!1,"show-delete-action":!1,"show-reset-action":!1,title:"Collaboration",subtitle:`Connection Status: ${L.value}`},{actions:o(()=>[l(bt),l(se,{color:"primary",variant:"flat","prepend-icon":"mdi:mdi-link-variant-plus",onClick:J},{default:o(()=>v[5]||(v[5]=[Q(" Create Session ")])),_:1})]),default:o(()=>[l(kt,null,{default:o(()=>[(d(!0),N(ee,null,xe(_.value,R=>(d(),N(ee,{key:R.key},[l(Qa,{value:R.key},{activator:o(({props:H})=>[l(tt,Kt({ref_for:!0},H),{default:o(()=>[l(Wt,null,{default:o(()=>[l(ce,null,{default:o(()=>[l(w,{style:{"max-width":"84px"}},{default:o(()=>[Z("a",{href:ae(R),onClick:et(oe=>ae(R),["prevent","stop"]),class:"text-white text-decoration-none"},[l(se,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant",color:"success",class:"mr-2",title:"Copy Link"})],8,Pn),l(se,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant-remove",color:"error",class:"mr-2",title:"Terminate",onClick:et(oe=>F(R),["stop"])},null,8,["onClick"])]),_:2},1024),l(w,null,{default:o(()=>[l(ve,{modelValue:R.name,"onUpdate:modelValue":oe=>R.name=oe,"hide-details":"",variant:"plain",density:"compact",onChange:ne,onClick:v[1]||(v[1]=et(()=>{},["stop"])),onKeydown:v[2]||(v[2]=et(()=>{},["stop"]))},{append:o(()=>[Q(j(R.users.length),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),default:o(()=>[R.editing?(d(),C(ie,{key:0,label:"Duration",items:$.value,density:"compact","hide-details":!0,modelValue:R.selectedDuration,"onUpdate:modelValue":[H=>R.selectedDuration=H,H=>q(R)],modelModifiers:{number:!0}},null,8,["items","modelValue","onUpdate:modelValue"])):R.expires?(d(),N(ee,{key:1},[Z("small",null,[v[6]||(v[6]=Z("strong",null,"Expires:",-1)),Q(" "+j(ye(R.expires)),1)]),l(se,{onClick:H=>{R.selectedDuration=-1,R.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:o(()=>v[7]||(v[7]=[Q(" (Change Expiry) ")])),_:2},1032,["onClick"])],64)):(d(),C(se,{key:2,onClick:H=>{R.selectedDuration=-1,R.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:o(()=>v[8]||(v[8]=[Q(" (Set Expiry) ")])),_:2},1032,["onClick"])),(d(!0),N(ee,null,xe(R.users,H=>(d(),C(tt,{key:`${R.key}.${H.UserUUID}`},{append:o(()=>[l(se,{variant:"flat",size:"small",icon:"mdi:mdi-account-network-off",title:"Disconnect User",onClick:oe=>me(R.key,H.UserUUID)},null,8,["onClick"])]),prepend:o(()=>[l(ea,{src:M(A)(H.UserUUID),class:"rounded-circle mr-2 pt-4 d-inline-block",height:"32",width:"32"},null,8,["src"])]),default:o(()=>[Q(" "+j(H.DisplayName),1)]),_:2},1024))),128))]),_:2},1032,["value"]),l(M(Nn),{value:ae(R),width:"200"},null,8,["value"])],64))),128))]),_:1}),l(al,{modelValue:u.value,"onUpdate:modelValue":v[3]||(v[3]=R=>u.value=R),message:"Invite Link Copied",timeout:2e3},null,8,["modelValue"])]),_:1},8,["modelValue","subtitle"])],64)):z("",!0)}}),Bn={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Yn=he({__name:"Paginator",props:Ue({itemTotal:{}},{currentPage:{required:!0},currentPageModifiers:{},itemsPerPage:{required:!0},itemsPerPageModifiers:{}}),emits:["update:currentPage","update:itemsPerPage"],setup(V){const O=be(V,"currentPage"),p=be(V,"itemsPerPage");return(f,A)=>(d(),C(Ee,{fluid:!0},{default:o(()=>[l(ce,{class:"align-center"},{default:o(()=>[l(w,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:o(()=>[l(Ul,{modelValue:O.value,"onUpdate:modelValue":A[0]||(A[0]=b=>O.value=b),modelModifiers:{number:!0},length:Math.ceil(f.itemTotal/p.value)},null,8,["modelValue","length"])]),_:1}),l(w,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:o(()=>[l(ie,{modelValue:p.value,"onUpdate:modelValue":A[1]||(A[1]=b=>p.value=b),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),l(w,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:o(()=>[l(ve,{modelValue:O.value,"onUpdate:modelValue":A[2]||(A[2]=b=>O.value=b),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(f.itemTotal/p.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),l(w,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:o(()=>[Z("span",Bn,[p.value===-1?(d(),N(ee,{key:0},[Q(" 1-"+j(f.itemTotal)+" of "+j(f.itemTotal),1)],64)):(d(),N(ee,{key:1},[Q(j((O.value-1)*p.value+1)+" - "+j(O.value*p.value>=f.itemTotal?f.itemTotal:O.value*p.value)+" of "+j(f.itemTotal),1)],64))])]),_:1})]),_:1})]),_:1}))}}),Gn=["colspan"],ei=he({__name:"RegistrationsView",emits:["pageTitle"],async setup(V,{emit:O}){var Mt,Ot,Ct;let p,f;const A=Wa();O("pageTitle","Registration Manager");const y=Va(),i=Qt(),U=S(!0);let u=((Mt=y.params.convention)==null?void 0:Mt.toString())||"";const _=S(([p,f]=Ft(()=>pl()),p=await p,f(),p)),k=Fe(),L=ut.getInstance(),{getLinkedFields:$}=ll(),q=S([]),te=S({ID:0,AdminLayoutUUID:Le(),ConventionID:((Ot=_.value)==null?void 0:Ot.ID)||0,ConventionUUID:((Ct=_.value)==null?void 0:Ct.ConventionUUID)||Ae,Name:"Registration Table",RunnerLayoutUUID:Ae,Type:ke.ADMIN_LAYOUT_TABLE,Panels:[]}),me=S([]),J=S([]),F=S([]),D=S([]),ne=S([]),c=S([]),ae=S(1),ye=S(10),h=S([]),v=S(0),R=S(!1),H=S(""),oe=S(""),_e=S(""),Ge=S(""),pe=([p,f]=Ft(()=>{var m;return $(((m=_.value)==null?void 0:m.ConventionUUID)||Ae)}),p=await p,f(),p),Te=S({FieldUUID:pe.badge_name||Ae,Value:""}),qe=S({FieldUUID:pe.forename||Ae,Value:""}),He=S({FieldUUID:pe.surname||Ae,Value:""}),je=S({FieldUUID:pe.dob||Ae,Value:""}),ze=S(new Map([[pe.badge_name||Ae,Te.value],[pe.forename||Ae,qe.value],[pe.surname||Ae,He.value],[pe.dob||Ae,je.value]])),Ne=S(""),Pe=S(""),Ke=S([]),$e=S([]),Qe=S([]),Je=S([]),Xe=S([]),We=S([]),De=S(0),ge=S(),Re=S(!1),t=S(!1),e=S(!1),a=S(),n=S(),s=S(),g=S(!1),T=ct(),E=rl(()=>{oe.value=Date.now().toString()});Ve(H,m=>{const r=c.value.find(I=>I.uuid===m);if(r){const I=r.headers.find(x=>x.defaultSort===!0);I&&(h.value=[{key:I.key,order:"asc"}],Ke.value=[{key:I.key,order:"asc"}])}Ie({page:1,itemsPerPage:ye.value,sortBy:Ke.value})}),Ve(De,m=>{m===8&&we()}),Ve(Ne,()=>{E()}),Ve(Pe,()=>{E()});const K=()=>{if(me.value=[],F.value=[],D.value=[],c.value=[],!!_.value){try{k.getConventionAdminLayoutByName(_.value.ConventionUUID,"Registration Table").then(m=>{if(De.value+=1,m)te.value=m;else{if(!_.value)return;te.value.ConventionID=_.value.ID,te.value.ConventionUUID=_.value.ConventionUUID}})}catch{te.value.ConventionID=_.value.ID,te.value.ConventionUUID=_.value.ConventionUUID}try{k.getConventionAdminLayouts(_.value.ConventionUUID).then(m=>{De.value+=1,m&&(m.forEach(r=>{r.Panels.sort((I,x)=>I.Order>x.Order?1:I.Order===x.Order?0:-1),r.Panels.forEach(I=>{I.Items.sort((x,ue)=>x.Order>ue.Order?1:x.Order===ue.Order?0:-1)})}),F.value=m)})}catch{}try{k.getConventionForms(_.value.ConventionUUID).then(m=>{De.value+=1,m&&(me.value=m)})}catch{}try{k.getConventionAccommodation(_.value.ConventionUUID).then(m=>{De.value+=1,m&&($e.value=m)})}catch{}try{k.getConventionVenues(_.value.ConventionUUID).then(m=>{De.value+=1,m&&(We.value=m)})}catch{}try{k.getConventionExtras(_.value.ConventionUUID).then(m=>{De.value+=1,m&&(Qe.value=m)})}catch{}try{k.getConventionInterests(_.value.ConventionUUID).then(m=>{De.value+=1,m&&(Je.value=m)})}catch{}try{k.getConventionTickets(_.value.ConventionUUID).then(m=>{De.value+=1,m&&(Xe.value=m)})}catch{}try{k.getConventionGroups(_.value.ConventionUUID).then(m=>{m&&(J.value=m.sort((r,I)=>r.Name.localeCompare(I.Name)))})}catch{}try{k.getConventionTags(_.value.ConventionUUID).then(m=>{m&&(ne.value=m.sort((r,I)=>r.Title.localeCompare(I.Title)).map(r=>(r.Title=`${r.Title} [${r.Key}]`,r)))})}catch{}}},Ie=({page:m,itemsPerPage:r,sortBy:I})=>{if(!_.value)return;U.value=!0,ae.value=m,h.value=I;const x=c.value.find(re=>re.uuid==H.value),ue=x==null?void 0:x.layout.Items;let le="",Be="";if(I&&ue&&I.length>=1){const re=ue.find(Ut=>Ut.LayoutItemUUID==I[0].key);switch(Be=I[0].order||"asc",re==null?void 0:re.MetaField){case W.META_DATA_SOURCE_ACCOMMODATION_FORM:le="submission.status";break;case W.META_DATA_SOURCE_ADDITIONAL_FORM:le="submission.status";break;case W.META_DATA_SOURCE_ADMIN_FORM:le="submission.status";break;case W.META_DATA_SOURCE_BADGE_FORM:le="submission.status";break;case W.META_DATA_SOURCE_DEALER_FORM:le="submission.status";break;case W.META_DATA_SOURCE_REGISTRATION_FORM:le="submission.status";break;case W.META_DATA_SOURCE_REGISTRATION_REFERENCE:le="reference";break;case W.META_DATA_SOURCE_SUBMISSION_DATE:le="created";break;case W.META_DATA_SOURCE_SUBMISSION_STATUS:le="submission.status";break}switch(re==null?void 0:re.UserField){case fe.USER_DATA_SOURCE_DISPLAY_NAME:le="user.display_name";break;case fe.USER_DATA_SOURCE_EMAIL:le="user.email";break;case fe.USER_DATA_SOURCE_FIRST_NAME:le="user.firstname";break;case fe.USER_DATA_SOURCE_HANDLE:le="user.handle";break;case fe.USER_DATA_SOURCE_LAST_NAME:le="user.lastname";break}}try{const re={Direction:Be,Limit:r,Offset:(m-1)*r,Order:le};x&&(re.PanelUUID=x==null?void 0:x.layout.LayoutPanelUUID),(x==null?void 0:x.layout.RequiredFormType)===de.FORM_TYPE_ADDITIONAL&&(re.Additional=!0),(x==null?void 0:x.layout.RequiredFormType)===de.FORM_TYPE_ADMIN&&(re.AdminForm=!0),(x==null?void 0:x.layout.RequiredFormType)===de.FORM_TYPE_ACCOMMODATION&&(re.Accommodation=!0),(x==null?void 0:x.layout.RequiredFormType)===de.FORM_TYPE_BADGE&&(re.Badge=!0),(x==null?void 0:x.layout.RequiredFormType)===de.FORM_TYPE_DEALER&&(re.Dealer=!0),(x==null?void 0:x.layout.RequiredFormType)===de.FORM_TYPE_REGISTRATION&&(re.Registration=!0),re.GroupUUID=Ne.value||Ae,re.TagUUID=Pe.value||Ae,re.Email=Ge.value,re.Reference=_e.value,re.FieldValues=Array.from(ze.value.values());const Ut=oe.value;k.searchConventionRegistrations(_.value.ConventionUUID,re).then(pt=>{pt&&Ut===oe.value&&(v.value=pt.Total,D.value=pt.Registrations,c.value.forEach(_t=>{const ya=_t.layout;_t.items=D.value.map(B=>{const st=[];let Me;B.Leader?Me=B:Me=B.Primary,st.push({Name:Me.User.DisplayName,UUID:Me.UserUUID,UserUUID:Me.User.UserUUID,IsLeader:!0,Reference:Me.Reference,Paid:Me.Paid,Total:Me.Total}),st.push(...Me.Members.map(Oe=>({Name:Oe.User.DisplayName,UUID:Oe.UserUUID,UserUUID:Oe.User.UserUUID,IsLeader:!1,Reference:Oe.Reference,Paid:Oe.Paid,Total:Oe.Total})));const X={};return _t.headers.forEach(Oe=>{var Lt;const Y=ya.Items.find(at=>at.LayoutItemUUID===Oe.key);if(Y){if(Y.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&Y.SectionField)B.Submissions.forEach(at=>{const Ze=at.Data.find(P=>P.SectionFieldUUID===Y.SectionFieldUUID);if(Ze){Oe.type===Jt.ACCOMMODATION?X[Y.LayoutItemUUID]={Data:Ze.Data,Registration:B}:X[Y.LayoutItemUUID]=Ze.Data;return}});else if(Y.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&Y.UserField)switch(Y.UserField){case fe.USER_DATA_SOURCE_AVATAR:X[Y.LayoutItemUUID]=A.GetProfileImageURL(B.UserUUID);break;case fe.USER_DATA_SOURCE_CONTACTS:X[Y.LayoutItemUUID]={},B.User.Generated&&B.User.Generated.telegram_handle&&(X[Y.LayoutItemUUID].telegram=`@${B.User.Generated.telegram_handle}`),X[Y.LayoutItemUUID].email=B.User.Additional.Email;break;case fe.USER_DATA_SOURCE_DISPLAY_NAME:X[Y.LayoutItemUUID]=B.User.DisplayName;break;case fe.USER_DATA_SOURCE_EMAIL:X[Y.LayoutItemUUID]=B.User.Additional.Email;break;case fe.USER_DATA_SOURCE_HANDLE:X[Y.LayoutItemUUID]=B.User.Handle;break;case fe.USER_DATA_SOURCE_DATE_OF_BIRTH:X[Y.LayoutItemUUID]=B.User.Additional.DOB;break;case fe.USER_DATA_SOURCE_FIRST_NAME:X[Y.LayoutItemUUID]=B.User.Additional.FirstName;break;case fe.USER_DATA_SOURCE_LAST_NAME:X[Y.LayoutItemUUID]=B.User.Additional.LastName;break;case fe.USER_DATA_SOURCE_TELEGRAM:B.User.Generated&&B.User.Generated.telegram_handle?X[Y.LayoutItemUUID]=`@${B.User.Generated.telegram_handle}`:X[Y.LayoutItemUUID]="";break}else if(Y.SourceType==="LAYOUT_ITEM_SOURCE_META"&&Y.MetaField){const at=(Lt=me.value.find(P=>P.Type===de.FORM_TYPE_REGISTRATION))==null?void 0:Lt.FormUUID,Ze=B.Submissions.find(P=>P.FormUUID===at);switch(Y.MetaField){case W.META_DATA_SOURCE_REGISTRATION_ACTIONS:X[Y.LayoutItemUUID]=B;break;case W.META_DATA_SOURCE_REGISTRATION_GROUP:X[Y.LayoutItemUUID]=st;break;case W.META_DATA_SOURCE_REGISTRATION_REFERENCE:X[Y.LayoutItemUUID]=B.Reference;break;case W.META_DATA_SOURCE_SUBMISSION_DATE:if(Ze){const P=new Date(Ze.CreatedAt||"");X[Y.LayoutItemUUID]=`${P.getFullYear()}-${(P.getMonth()+1).toString().padStart(2,"0")}-${P.getDate().toString().padStart(2,"0")} ${P.getHours().toString().padStart(2,"0")}:${P.getMinutes().toString().padStart(2,"0")}:${P.getSeconds().toString().padStart(2,"0")}`}else{const P=new Date(B.CreatedAt||"");X[Y.LayoutItemUUID]=`${P.getFullYear()}-${(P.getMonth()+1).toString().padStart(2,"0")}-${P.getDate().toString().padStart(2,"0")} ${P.getHours().toString().padStart(2,"0")}:${P.getMinutes().toString().padStart(2,"0")}:${P.getSeconds().toString().padStart(2,"0")}`}break;case W.META_DATA_SOURCE_ACCOMMODATION_FORM:X[Y.LayoutItemUUID]=B.Submissions.map(P=>{const G=me.value.find(Se=>Se.FormUUID===P.FormUUID);return{Heading:G==null?void 0:G.Heading,Form:G,Submission:P,Registration:B}}).filter(P=>{var G;return((G=P.Form)==null?void 0:G.Type)===de.FORM_TYPE_ACCOMMODATION});break;case W.META_DATA_SOURCE_ADMIN_FORM:X[Y.LayoutItemUUID]=B.Submissions.map(P=>{const G=me.value.find(Se=>Se.FormUUID===P.FormUUID);return{Heading:G==null?void 0:G.Heading,Form:G,Submission:P,Registration:B}}).filter(P=>{var G;return((G=P.Form)==null?void 0:G.Type)===de.FORM_TYPE_ADMIN});break;case W.META_DATA_SOURCE_ADDITIONAL_FORM:X[Y.LayoutItemUUID]=B.Submissions.map(P=>{const G=me.value.find(Se=>Se.FormUUID===P.FormUUID);return{Heading:G==null?void 0:G.Heading,Form:G,Submission:P,Registration:B}}).filter(P=>{var G;return((G=P.Form)==null?void 0:G.Type)===de.FORM_TYPE_ADDITIONAL});break;case W.META_DATA_SOURCE_BADGE_FORM:X[Y.LayoutItemUUID]=B.Submissions.map(P=>{const G=me.value.find(Se=>Se.FormUUID===P.FormUUID);return{Heading:G==null?void 0:G.Heading,Form:G,Submission:P,Registration:B}}).filter(P=>{var G;return((G=P.Form)==null?void 0:G.Type)===de.FORM_TYPE_BADGE});break;case W.META_DATA_SOURCE_DEALER_FORM:X[Y.LayoutItemUUID]=B.Submissions.map(P=>{const G=me.value.find(Se=>Se.FormUUID===P.FormUUID);return{Heading:G==null?void 0:G.Heading,Form:G,Submission:P,Registration:B}}).filter(P=>{var G;return((G=P.Form)==null?void 0:G.Type)===de.FORM_TYPE_DEALER});break;case W.META_DATA_SOURCE_PAYMENT_STATUS:if(B.Paid===0&&B.Total)X[Y.LayoutItemUUID]="REQUIRED";else if(B.Total>B.Paid)X[Y.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const P=st.find(G=>G.Paid===0&&(G.Total||0)>0);if(P){B.Total===0&&P.Total===0?X[Y.LayoutItemUUID]="NOT_REQUIRED":B.Total>0&&P.Total===0?X[Y.LayoutItemUUID]="MISSING_REQUIRED":B.Paid>=B.Total?X[Y.LayoutItemUUID]="AWAITING_PARTNER":X[Y.LayoutItemUUID]="ALL_REQUIRED";break}else B.Total===0?X[Y.LayoutItemUUID]="NOT_REQUIRED":X[Y.LayoutItemUUID]="COMPLETE"}break;case W.META_DATA_SOURCE_SUBMISSION_STATUS:Xa(B.Submissions,me.value),X[Y.LayoutItemUUID]=B.Submissions.map(P=>{const G=me.value.find(Se=>Se.FormUUID===P.FormUUID);return{Heading:G==null?void 0:G.Heading,Form:G,Submission:P,Registration:B}});break;case W.META_DATA_SOURCE_DATA_LAYOUT:X[Y.LayoutItemUUID]={Registration:B,Layouts:F.value.filter(P=>{if(Y.Meta&&Y.Meta.LayoutUUID&&Array.isArray(Y.Meta.LayoutUUID))return Y.Meta.LayoutUUID.includes(P.AdminLayoutUUID)})};break}}}}),{key:B.RegistrationUUID,registration:B,...X}})}),U.value=!1)})}catch{}},it=m=>{R.value=!1,m&&(te.value=m,we())},we=()=>{ma(te.value.Panels,me.value),te.value.Panels.length>0&&(c.value=[],te.value.Panels.forEach(m=>{const r={uuid:Le(),order:m.Order,name:m.Name,headers:[],items:[],layout:m};m.Items.sort((I,x)=>I.Order>x.Order?1:I.Order==x.Order?0:-1),r.headers=m.Items.filter(I=>I.SourceType!=Ce.LAYOUT_ITEM_SOURCE_META||I.MetaField!=W.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP).map(I=>{var x,ue;return{key:I.LayoutItemUUID,title:I.Label||((ue=(x=I.SectionField)==null?void 0:x.Field)==null?void 0:ue.Label)||"",align:I.Align==="end"?"end":"start",sortable:va(I),type:ca(I),defaultSort:I.DefaultSort,meta:I.Meta}}),c.value.push(r)}),c.value=c.value.sort((m,r)=>m.order>r.order?1:m.order==r.order?0:-1)),(H.value==null||H.value=="")&&c.value.length>0&&(H.value=c.value[0].uuid)};u?k.getConvention(u).then(m=>{m&&(_.value=m,te.value.ConventionID=_.value.ID,te.value.ConventionUUID=_.value.ConventionUUID,K())}).catch(()=>{i.push("/")}):i.push("/");const ca=m=>{var r,I;if(m.SourceType===Ce.LAYOUT_ITEM_SOURCE_META)return`${m.SourceType}.${m.MetaField}`;if(m.SourceType===Ce.LAYOUT_ITEM_SOURCE_FORM)return(I=(r=m.SectionField)==null?void 0:r.Field)==null?void 0:I.Type;if(m.SourceType===Ce.LAYOUT_ITEM_SOURCE_USER)return`${m.SourceType}.${m.UserField}`},fa=()=>{const m=c.value.find(r=>r.uuid===H.value);return m?!!m.layout.Items.find(r=>r.SourceType==Ce.LAYOUT_ITEM_SOURCE_META&&r.MetaField==W.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP):!1},va=m=>{const r=[W.META_DATA_SOURCE_ACCOMMODATION_FORM,W.META_DATA_SOURCE_BADGE_FORM,W.META_DATA_SOURCE_DEALER_FORM,W.META_DATA_SOURCE_REGISTRATION_FORM,W.META_DATA_SOURCE_REGISTRATION_REFERENCE,W.META_DATA_SOURCE_SUBMISSION_DATE,W.META_DATA_SOURCE_SUBMISSION_STATUS],I=[fe.USER_DATA_SOURCE_DISPLAY_NAME,fe.USER_DATA_SOURCE_EMAIL,fe.USER_DATA_SOURCE_HANDLE,fe.USER_DATA_SOURCE_DATE_OF_BIRTH,fe.USER_DATA_SOURCE_FIRST_NAME,fe.USER_DATA_SOURCE_LAST_NAME];return r.includes(m.MetaField)||I.includes(m.UserField)},Ua=m=>{ge.value=m,Re.value=!0},pa=m=>{ge.value=m,t.value=!0},_a=m=>{ge.value=m,e.value=!0};Ve(Re,m=>{m||(ge.value=void 0)}),Ve(t,m=>{m||(ge.value=void 0)});const vt=async(m="")=>{n.value=await k.getRegistrationGroup(m)},ga=({registration:m,form:r})=>{const I={FormUUID:r.FormUUID,Limit:1,RegistrationUUID:m.RegistrationUUID};switch(r.Type){case de.FORM_TYPE_ACCOMMODATION:I.Accommodation=!0;break;case de.FORM_TYPE_ADDITIONAL:I.Additional=!0;break;case de.FORM_TYPE_ADMIN:I.AdminForm=!0;break;case de.FORM_TYPE_BADGE:I.Badge=!0;break;case de.FORM_TYPE_DEALER:I.Dealer=!0;break;case de.FORM_TYPE_REGISTRATION:I.Registration=!0;break}k.searchConventionRegistrations(m.ConventionUUID,I).then(x=>{if(x&&x.Total>0){if(ge.value=x.Registrations[0],!ge.value)return;vt(m.RegistrationUUID).then(()=>{var ue,le;ge.value&&((ue=ge.value)!=null&&ue.Submissions)&&(s.value=(le=ge.value)==null?void 0:le.Submissions.find(Be=>Be.FormUUID===r.FormUUID)),s.value||(s.value=xa(r,m)),a.value=r,g.value=!0})}})},xa=(m,r)=>({ID:0,SubmissionUUID:Le(),FormID:m.ID,FormUUID:m.FormUUID,Form:m,UserID:r.UserID,UserUUID:r.UserUUID,RegistrationID:r.ID,RegistrationUUID:r.RegistrationUUID,Registration:r,Data:[],Status:za.SUBMISSION_STATUS_NULL}),ha=m=>{k.switchUser(m.UserUUID).then(r=>{r&&il(r.tokens,r.user,i,!1)}).catch(r=>{console.error(r)})};return L.on("registration.group.leave",m=>{k.leaveRegistrationGroup(m).then(r=>{r&&vt(m).then(()=>{L.emit("registration.group.left",r)})})}),L.on("registration.group.remove.member",m=>{k.leaveRegistrationGroup(m).then(r=>{r&&vt(m).then(()=>{L.emit("registration.group.left",r)})})}),L.on("checkin-saved",()=>{_e.value="",Te.value.Value="",Ge.value="",qe.value.Value="",He.value.Value="",je.value.Value=""}),(m,r)=>_.value?(d(),C($t,{key:0},{default:o(()=>[l(Bt,{color:"blue-darken-4"},{default:o(()=>[l(aa,{modelValue:H.value,"onUpdate:modelValue":r[0]||(r[0]=I=>H.value=I),"show-arrows":""},{default:o(()=>[(d(!0),N(ee,null,xe(c.value,I=>(d(),C(la,{key:I.uuid,value:I.uuid},{default:o(()=>[Q(j(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),l(bt),l($n),l(se,{icon:"mdi:mdi-cog-outline",onClick:r[1]||(r[1]=I=>R.value=!0)})]),_:1}),l(na,{modelValue:H.value,"onUpdate:modelValue":r[22]||(r[22]=I=>H.value=I),disabled:!0,touch:!1},{default:o(()=>[(d(!0),N(ee,null,xe(c.value,I=>(d(),C(Ye,{key:I.uuid,value:I.uuid},{default:o(()=>[I.uuid===H.value?(d(),C(ot,{key:0,class:"pa-2"},{default:o(()=>[l(sl,{expanded:q.value,"onUpdate:expanded":r[18]||(r[18]=x=>q.value=x),page:ae.value,"onUpdate:page":r[19]||(r[19]=x=>ae.value=x),"items-per-page":ye.value,"onUpdate:itemsPerPage":r[20]||(r[20]=x=>ye.value=x),"sort-by":Ke.value,"onUpdate:sortBy":r[21]||(r[21]=x=>Ke.value=x),headers:I.headers,"items-length":v.value,items:I.items,"item-value":"key",loading:U.value,search:oe.value,"onUpdate:options":Ie,"show-expand":fa()},mt({top:o(()=>[l(ua,{class:"mb-3"},{default:o(()=>[l(yt,null,{default:o(()=>[l(Tt,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:o(()=>[l(w,{class:"pa-0"},{default:o(()=>[r[30]||(r[30]=Q(" Search Criteria ")),l(Zt,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),l(w,{class:"d-none d-sm-block pa-0",cols:"0"},{default:o(()=>[l(ve,{modelValue:_e.value,"onUpdate:modelValue":r[2]||(r[2]=x=>_e.value=x),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:r[3]||(r[3]=et(()=>{},["stop"])),"onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),l(w,{class:"d-none d-md-block pa-0"},{default:o(()=>[l(ve,{modelValue:Te.value.Value,"onUpdate:modelValue":r[4]||(r[4]=x=>Te.value.Value=x),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:r[5]||(r[5]=et(()=>{},["stop"])),"onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),l(It,{class:"pt-2"},{default:o(()=>[l(ce,null,{default:o(()=>[l(w,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:o(()=>[l(ve,{modelValue:_e.value,"onUpdate:modelValue":r[6]||(r[6]=x=>_e.value=x),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),l(w,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:o(()=>[l(ve,{modelValue:Te.value.Value,"onUpdate:modelValue":r[7]||(r[7]=x=>Te.value.Value=x),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),l(w,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:o(()=>[l(ve,{modelValue:Ge.value,"onUpdate:modelValue":r[8]||(r[8]=x=>Ge.value=x),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),l(w,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:o(()=>[l(ve,{modelValue:qe.value.Value,"onUpdate:modelValue":r[9]||(r[9]=x=>qe.value.Value=x),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),l(w,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:o(()=>[l(ve,{modelValue:He.value.Value,"onUpdate:modelValue":r[10]||(r[10]=x=>He.value.Value=x),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),l(w,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:o(()=>[l(ve,{modelValue:je.value.Value,"onUpdate:modelValue":r[11]||(r[11]=x=>je.value.Value=x),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":M(E),onInput:M(E)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),l(w,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:o(()=>[l(ie,{modelValue:Ne.value,"onUpdate:modelValue":r[12]||(r[12]=x=>Ne.value=x),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:J.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),l(w,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:o(()=>[l(ie,{modelValue:Pe.value,"onUpdate:modelValue":r[13]||(r[13]=x=>Pe.value=x),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:ne.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":o(({columns:x,internalItem:ue})=>[Z("tr",null,[Z("td",{colspan:x.length},[l(qt,{modelValue:Re.value,"onUpdate:modelValue":r[15]||(r[15]=le=>Re.value=le),registration:ue.raw.registration,"onUpdate:registration":le=>ue.raw.registration=le,accommodations:$e.value,convention:_.value,extras:Qe.value,forms:me.value,interests:Je.value,tickets:Xe.value,title:`Registration Controls (#${ue.raw.registration.Reference} ${ue.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:We.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,Gn)])]),"item.data-table-expand":o(({internalItem:x})=>[q.value.findIndex(ue=>ue===x.key)>=0?(d(),C(se,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:ue=>q.value.splice(q.value.findIndex(le=>le===x.key),1)},{default:o(()=>[x.raw.registration.Notes&&x.raw.registration.Notes.length>0?(d(),N(ee,{key:0},[Q(j(x.raw.registration.Notes.length),1)],64)):z("",!0)]),_:2},1032,["onClick"])):(d(),C(se,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:ue=>q.value.push(x.key)},{default:o(()=>[x.raw.registration.Notes&&x.raw.registration.Notes.length>0?(d(),N(ee,{key:0},[Q(j(x.raw.registration.Notes.length),1)],64)):z("",!0)]),_:2},1032,["onClick"]))]),bottom:o(()=>[l(Yn,{"current-page":ae.value,"onUpdate:currentPage":r[16]||(r[16]=x=>ae.value=x),"items-per-page":ye.value,"onUpdate:itemsPerPage":r[17]||(r[17]=x=>ye.value=x),"item-total":v.value},null,8,["current-page","items-per-page","item-total"])]),_:2},[xe(I.headers,x=>({name:`item.${x.key}`,fn:o(({internalItem:ue,index:le})=>[l(Ml,{header:x,item:ue,accommodations:$e.value,convention:_.value,extras:Qe.value,forms:me.value,interests:Je.value,tickets:Xe.value,user:M(T),venues:We.value,modelValue:I.items[le],"onUpdate:modelValue":Be=>I.items[le]=Be,onOpenActions:Ua,onOpenPayments:pa,onOpenTags:_a,onReload:r[14]||(r[14]=Be=>Ie({page:ae.value,itemsPerPage:ye.value,sortBy:h.value})),onSwitchUser:ha,onShowForm:ga},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search","show-expand"])]),_:2},1024)):z("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),R.value?(d(),C(An,{key:0,title:"Edit Layouts",modelValue:R.value,"onUpdate:modelValue":r[23]||(r[23]=I=>R.value=I),convention:_.value,onSave:it},null,8,["modelValue","convention"])):z("",!0),ge.value?(d(),N(ee,{key:1},[Re.value?(d(),C(qt,{key:0,modelValue:Re.value,"onUpdate:modelValue":r[24]||(r[24]=I=>Re.value=I),registration:ge.value,"onUpdate:registration":r[25]||(r[25]=I=>ge.value=I),accommodations:$e.value,convention:_.value,extras:Qe.value,forms:me.value,interests:Je.value,tickets:Xe.value,title:`Registration Controls (#${ge.value.Reference} ${ge.value.User.DisplayName})`,"use-dialog":!0,venues:We.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):z("",!0)],64)):z("",!0),g.value&&s.value&&a.value?(d(),C(da,{key:2,modelValue:g.value,"onUpdate:modelValue":r[29]||(r[29]=I=>g.value=I),scrollable:!0,fullscreen:!0},{default:o(()=>[l(ot,{class:"bg-red-darken-4"},{default:o(()=>[l(Bt,{color:"error"},{default:o(()=>[l(_l,null,{default:o(()=>r[31]||(r[31]=[Q("Submission Editor - Admin Mode")])),_:1}),l(bt),l(Ja,null,{default:o(()=>[l(se,{icon:"mdi:mdi-window-close",onClick:r[26]||(r[26]=I=>g.value=!1)})]),_:1})]),_:1}),l(ft,{class:"pa-0"},{default:o(()=>[l(qa,{modelValue:a.value,"onUpdate:modelValue":r[27]||(r[27]=I=>a.value=I),admin:!0,convention:_.value,data:s.value,editable:!0,"registration-group":n.value,onClose:r[28]||(r[28]=I=>{g.value=!1,Ie({page:ae.value,itemsPerPage:ye.value,sortBy:h.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):z("",!0)]),_:1})):(d(),C($t,{key:1},{default:o(()=>r[32]||(r[32]=[Q(" Convention Not Found ")])),_:1}))}});export{ei as default};
