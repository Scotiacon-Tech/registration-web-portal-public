import{p as R,r as p,s as w,c as f,a as ce,w as E,o as de,b as ve,d as B,u as me,e as Q,t as N,f as l,m as M,h as W,i as G,j as ge,k as Y,l as H,n as V,q as _,v as i,x as K,y as X,z as fe,A as L,E as Z,_ as ee,B as pe,C as A,D as $,F as he,G as ae,H as te,I as ye,J as Ve,T as ke}from"./index-B6R-Aew_.js";import{G as _e,R as O,a as Se}from"./userData-wRJNXzUe.js";import{u as be}from"./useAvatar-Cr7Yt6i2.js";import{C as Ce}from"./canEditOrganisation-CIMEqtuP.js";import{G as D}from"./group-Dg_peWef.js";import{C as x}from"./canDo-DPNcnx_U.js";import{C as Te}from"./canViewOperations-Dv3MKgll.js";import{m as Ie,V as j,a as Pe}from"./VToolbar-Cc0csT3P.js";import{m as le,u as oe,a as se,c as ne,V as we}from"./scopeId-BHr0vU4H.js";import{V as Re}from"./VTextField-CYZGqgEG.js";import{u as U,m as Le,V as re,a as z,b as Be,c as Ue,d as Ee,e as q,f as Ne,g as Ae,h as De,i as xe,j as Oe,k as He,l as Me,n as Ge,o as ze}from"./VContainer-5F-xl_LL.js";import{u as Fe,V as J,a as T,b as Ye}from"./VList-RCeObXF7.js";import{V as ue,a as $e}from"./forwardRefs-CMwBLL0X.js";import{V as je}from"./VDivider-4nGWLzcd.js";import{V as qe,a as ie}from"./VNavigationDrawer-VQ0DVtQ6.js";import{s as Je}from"./index-DFZh32pl.js";import"./useStoreAPI-mak240Gx.js";import"./createSimpleFunctional-COPlfcGM.js";import"./form-D2XRgosz.js";const Qe=(e,n=void 0)=>e===void 0?!1:n===void 0?x(e,D.GROUP_TYPE_CONVENTION).ManageUsers:x(e,D.GROUP_TYPE_CONVENTION,n.ConventionUUID,n).ManageUsers,We=(e,n=void 0)=>{let t;return e===void 0?!1:(n===void 0?t=x(e,D.GROUP_TYPE_CONVENTION):t=x(e,D.GROUP_TYPE_CONVENTION,n.ConventionUUID,n),t.EditConvention||t.ManageViews||t.ViewRegistration||t.EditRegistration)},Ke=R({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function Xe(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:t}=n;let r=0,u=0;const a=p(null),o=w(0),d=w(0),m=w(0),c=w(!1),v=w(!1),h=f(()=>Number(e.scrollThreshold)),S=f(()=>ce((h.value-o.value)/h.value||0)),y=()=>{const g=a.value;if(!g||t&&!t.value)return;r=o.value,o.value="window"in g?g.pageYOffset:g.scrollTop;const k=g instanceof Window?document.documentElement.scrollHeight:g.scrollHeight;if(u!==k){u=k;return}v.value=o.value<r,m.value=Math.abs(o.value-h.value)};return E(v,()=>{d.value=d.value||o.value}),E(c,()=>{d.value=0}),de(()=>{E(()=>e.scrollTarget,g=>{var b;const k=g?document.querySelector(g):window;k&&k!==a.value&&((b=a.value)==null||b.removeEventListener("scroll",y),a.value=k,a.value.addEventListener("scroll",y,{passive:!0}))},{immediate:!0})}),ve(()=>{var g;(g=a.value)==null||g.removeEventListener("scroll",y)}),t&&E(t,y,{immediate:!0}),{scrollThreshold:h,currentScroll:o,currentThreshold:m,isScrollActive:c,scrollRatio:S,isScrollingUp:v,savedScroll:d}}const Ze=R({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...Ie(),...le(),...Ke(),height:{type:[Number,String],default:64}},"VAppBar"),ea=B()({name:"VAppBar",props:Ze(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:t}=n;const r=p(),u=me(e,"modelValue"),a=f(()=>{var P;const s=new Set(((P=e.scrollBehavior)==null?void 0:P.split(" "))??[]);return{hide:s.has("hide"),fullyHide:s.has("fully-hide"),inverted:s.has("inverted"),collapse:s.has("collapse"),elevate:s.has("elevate"),fadeImage:s.has("fade-image")}}),o=f(()=>{const s=a.value;return s.hide||s.fullyHide||s.inverted||s.collapse||s.elevate||s.fadeImage||!u.value}),{currentScroll:d,scrollThreshold:m,isScrollingUp:c,scrollRatio:v}=Xe(e,{canScroll:o}),h=f(()=>a.value.hide||a.value.fullyHide),S=f(()=>e.collapse||a.value.collapse&&(a.value.inverted?v.value>0:v.value===0)),y=f(()=>e.flat||a.value.fullyHide&&!u.value||a.value.elevate&&(a.value.inverted?d.value>0:d.value===0)),g=f(()=>a.value.fadeImage?a.value.inverted?1-v.value:v.value:void 0),k=f(()=>{var C,F;if(a.value.hide&&a.value.inverted)return 0;const s=((C=r.value)==null?void 0:C.contentHeight)??0,P=((F=r.value)==null?void 0:F.extensionHeight)??0;return h.value?d.value<m.value||a.value.fullyHide?s+P:s:s+P});Q(f(()=>!!e.scrollBehavior),()=>{W(()=>{h.value?a.value.inverted?u.value=d.value>m.value:u.value=c.value||d.value<m.value:u.value=!0})});const{ssrBootStyles:b}=Fe(),{layoutItemStyles:I}=oe({id:e.name,order:f(()=>parseInt(e.order,10)),position:N(e,"location"),layoutSize:k,elementSize:w(void 0),active:u,absolute:N(e,"absolute")});return U(()=>{const s=j.filterProps(e);return l(j,M({ref:r,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...I.value,"--v-toolbar-image-opacity":g.value,height:void 0,...b.value},e.style]},s,{collapse:S.value,flat:y.value}),t)}),{}}}),aa=R({...Le({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),ta=B()({name:"VAppBarNavIcon",props:aa(),setup(e,n){let{slots:t}=n;return U(()=>l(re,M(e,{class:["v-app-bar-nav-icon"]}),t)),{}}}),la=R({...z(),...Be(),...se()},"VLayout"),oa=B()({name:"VLayout",props:la(),setup(e,n){let{slots:t}=n;const{layoutClasses:r,layoutStyles:u,getLayoutItem:a,items:o,layoutRef:d}=ne(e),{dimensionStyles:m}=Ue(e);return U(()=>{var c;return l("div",{ref:d,class:[r.value,e.class],style:[m.value,u.value,e.style]},[(c=t.default)==null?void 0:c.call(t)])}),{getLayoutItem:a,items:o}}}),sa=G({__name:"DashboardLayout",props:{user:{}},setup(e){const n=be(),t=ge(),r=p(!1),u=p("Default Title"),a=p(""),o=p(Y(e.user)),d=p(n(o.value.UserUUID));Z.getInstance().on("user.profile.saved",b=>{o.value=Y(b)});const c=p(localStorage.getItem("theme")||"light");t.global.name.value=c.value;const v=()=>{c.value=="light"?c.value="dark":c.value="light",t.global.name.value=c.value,localStorage.setItem("theme",c.value)},h=b=>{u.value=b},S=p(We(e.user)),y=p(Te(e.user)),g=p(Ce(e.user)),k=p(Qe(e.user));return(b,I)=>{const s=H("RouterLink"),P=H("RouterView");return V(),_(oa,{class:"h-100"},{default:i(()=>[l(ea,{color:"blue-darken-3"},{default:i(()=>[l(Pe,null,{default:i(()=>[K(X(u.value),1)]),_:1}),l(we),l(Re,{modelValue:a.value,"onUpdate:modelValue":I[0]||(I[0]=C=>a.value=C),"prepend-inner-icon":"mdi:mdi-magnify",label:"Search",variant:"underlined","hide-details":"",clearable:!0,class:"d-none"},null,8,["modelValue"]),l(ta,{variant:"text",onClick:I[1]||(I[1]=fe(C=>r.value=!r.value,["stop"]))})]),_:1}),l(qe,{modelValue:r.value,"onUpdate:modelValue":I[2]||(I[2]=C=>r.value=C),location:"right",temporary:!0},{default:i(()=>[l(J,null,{default:i(()=>[l(s,{to:{name:"Profile"}},{default:i(()=>[l(T,{title:o.value.DisplayName},{prepend:i(()=>[d.value?(V(),_(ue,{key:0,src:d.value,class:"rounded-circle mr-2",height:"32",width:"32"},null,8,["src"])):(V(),_(Ee,{key:1,icon:"mdi:mdi-account-circle",size:"x-large"}))]),_:1},8,["title"])]),_:1})]),_:1}),l(je),l(P,{name:"navigation"},{default:i(()=>[l(J,null,{default:i(()=>[l(s,{to:"/"},{default:i(()=>[l(T,{"prepend-icon":"mdi:mdi-view-dashboard-outline",title:"Home",value:"home"})]),_:1}),S.value||g.value||k.value?(V(),_(Ye,{key:0,value:"Admin"},{activator:i(({props:C})=>[l(T,M(C,{"prepend-icon":"mdi:mdi-security",title:"Admin"}),null,16)]),default:i(()=>[S.value||y.value?(V(),_(s,{key:0,to:"/admin/conventions"},{default:i(()=>[l(T,{"prepend-icon":"mdi:mdi-domain",title:"Conventions",value:"Conventions"})]),_:1})):L("",!0),g.value?(V(),_(s,{key:1,to:"/admin/organisations"},{default:i(()=>[l(T,{"prepend-icon":"mdi:mdi-store",title:"Organisations",value:"Organisations"})]),_:1})):L("",!0),k.value?(V(),_(s,{key:2,to:"/admin/groups"},{default:i(()=>[l(T,{"prepend-icon":"mdi:mdi-key-chain-variant",title:"Permissions",value:"Permissions"})]),_:1})):L("",!0)]),_:1})):L("",!0),l(s,{to:{name:"Profile"}},{default:i(()=>[l(T,{"prepend-icon":"mdi:mdi-account-circle",title:"Manage Account"})]),_:1}),l(T,{"prepend-icon":"mdi:mdi-theme-light-dark",onClick:v,title:`${c.value=="light"?"Dark":"Light"} Mode`},null,8,["title"]),l(s,{to:"/logout"},{default:i(()=>[l(T,{"prepend-icon":"mdi:mdi-logout",title:"Logout",value:"Logout"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ie,null,{default:i(()=>[l(P,{onPageTitle:h,"logged-in":!0})]),_:1})]),_:1})}}}),na=ee(sa,[["__scopeId","data-v-58209c7d"]]),ra="/assets/scotiacon-logo-DsrTQlsL.svg",ua=G({__name:"LoginLayout",setup(e){return(n,t)=>{const r=H("RouterView");return V(),pe(he,null,[l(q,{class:"logo-container text-center"},{default:i(()=>[l(ue,{src:A(ra),class:"scotiacon-logo ma-auto"},null,8,["src"]),t[0]||(t[0]=$("h1",null,"Scotiacon Registration System",-1))]),_:1}),l(q,{class:"login-container text-center mb-0 rounded rounded-lg mb-md-10"},{default:i(()=>[l($e,null,{default:i(()=>[l(re,{class:"ma-2",color:"indigo",icon:"mdi:mdi-lock-outline"})]),_:1}),$("h2",null,X(A(Je).headingSignIn),1),l(r,{"logged-in":!1})]),_:1})],64)}}}),ia=ee(ua,[["__scopeId","data-v-5e348755"]]),ca=R({...z(),...se({fullHeight:!0}),...ae()},"VApp"),da=B()({name:"VApp",props:ca(),setup(e,n){let{slots:t}=n;const r=te(e),{layoutClasses:u,getLayoutItem:a,items:o,layoutRef:d}=ne(e),{rtlClasses:m}=ye();return U(()=>{var c;return l("div",{ref:d,class:["v-application",r.themeClasses.value,u.value,m.value,e.class],style:[e.style]},[l("div",{class:"v-application__wrap"},[(c=t.default)==null?void 0:c.call(t)])])}),{getLayoutItem:a,items:o,theme:r}}}),va=R({app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...Ne(),...z(),...Ae(),...le(),...De(),...xe({tag:"footer"}),...ae()},"VFooter"),ma=B()({name:"VFooter",props:va(),setup(e,n){let{slots:t}=n;const r=p(),{themeClasses:u}=te(e),{backgroundColorClasses:a,backgroundColorStyles:o}=Oe(N(e,"color")),{borderClasses:d}=He(e),{elevationClasses:m}=Me(e),{roundedClasses:c}=Ge(e),v=w(32),{resizeRef:h}=ze(y=>{y.length&&(v.value=y[0].target.clientHeight)}),S=f(()=>e.height==="auto"?v.value:parseInt(e.height,10));return Q(()=>e.app,()=>{const y=oe({id:e.name,order:f(()=>parseInt(e.order,10)),position:f(()=>"bottom"),layoutSize:S,elementSize:f(()=>e.height==="auto"?void 0:S.value),active:f(()=>e.app),absolute:N(e,"absolute")});W(()=>{r.value=y.layoutItemStyles.value})}),U(()=>l(e.tag,{ref:h,class:["v-footer",u.value,a.value,d.value,m.value,c.value,e.class],style:[o.value,e.app?r.value:{height:Ve(e.height)},e.style]},t)),{}}}),Ea=G({__name:"Default",emits:["pageTitle"],setup(e,{emit:n}){let t=_e();const r=ke.getInstance(),u=r.getTokenByService("GrazeAPI"),a=p(!1),o=p(!1),d=n,m=Z.getInstance();m.on("login",v=>{t=v,a.value=!0}),m.on("logout",()=>{t=void 0,a.value=!1}),m.on("tokenManager.tokenUpdated",()=>{a.value=!0,o.value=!0}),m.on("tokenManager.sessionExpired",()=>{a.value=!1,o.value=!1,O(),location.reload()}),u?t?u.AccessExpires<=Date.now()&&u.RefreshExpires>Date.now()?r.refreshToken(u):u.AccessExpires>Date.now()?(O(),a.value=!1,o.value=!0):(a.value=!0,o.value=!0):Se().then(v=>{t=v,a.value=!0,o.value=!0}).catch(()=>{a.value=!1,o.value=!0}):(O(),a.value=!1,o.value=!0);const c=v=>{d("pageTitle",v)};return(v,h)=>(V(),_(da,{class:"bg-image"},{default:i(()=>[o.value?(V(),_(ie,{key:0},{default:i(()=>[a.value&&A(t)?(V(),_(na,{key:0,user:A(t),onPageTitle:c},null,8,["user"])):(V(),_(ia,{key:1}))]),_:1})):L("",!0),l(ma,null,{default:i(()=>h[0]||(h[0]=[K(" Powered by Graze ")])),_:1})]),_:1}))}});export{Ea as default};
